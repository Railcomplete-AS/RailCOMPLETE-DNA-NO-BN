<!--========================================================================================================

    NO-BN-Earthing.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2021. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>

<!--========================================================================================================
	Line(ca)	Contents:
	  25		EARTHING CONDUCTOR
	 130		EARTHING ELECTRODE
	 200		EARTHING CONNECTOR
	 280		EARTHING BUS-BAR
	 360		End Of File
=========================================================================================================-->



<!--========================================================================================================
	HIGH VOLTAGE
	EARTHING CONDUCTORS
 =========================================================================================================-->
	<!-- Al needs 56% more cross-section than Cu for the same resistivity. -->
	<!-- Source: https://help.leonardo-energy.org/hc/en-us/articles/205394842-Why-use-copper-rather-than-aluminium-as-the-conductor-in-power-cables- -->
	<ObjectType DataType="tEarthWire" Class="RailwayAlignment" Name="JBTEH_JOR Jordleder" 
				Layer="JBTEH_JOR" Color="ByLayer"
				Group="Kontaktledning/Jording"
				>
			
		<RelationSpace>jordleder</RelationSpace>
		
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___TAG_OBJECTINFO_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___JBTKL" />
		<xpp:expand select="NOBN_com_DISCIPLINE_JBTKL" />

		<Variants DefaultValue="Isolert jordleder" >
   <!-- TODO Innføre Description attributt i både Variants og i Variant -->
   <!-- <Variant Name="Isolert jordleder" Description="Jordleder i lavspentløpet i kabelkanal langs sporet." /> -->
   <!-- <Variant Name="Blank jordleder" Description="Jording som føres fra KL-mast til KL-mast, eller opphengt i tunneltak eller ført langs tunnelvegg." /> -->
   <!-- <Variant Name="Tverrforbinder" Description="Forbinder skinnestrenger i samme spor, f.eks. trekke returstrøm over til andre skinnen ifbm dobbelisolert skjøt. Kabelforlegning i sporet (dvs TXXI kappe)." /> -->
   <!-- <Variant Name="Utjevningsforbinder" Description="Forbinder jordskinnen i ett spor med jordskinnen i et annet spor i nærheten. Kabelforlegning er typisk i føringsvei (dvs IX kappe)." /> -->
			<Variant Name="Isolert jordleder" >
			</Variant>
			<Variant Name="Blank jordleder" >
			</Variant>
			<Variant Name="Tverrforbinder" >
			</Variant>
			<Variant Name="Utjevningsforbinder" >
			</Variant>
		</Variants>
		
		<!-- Tverrsnitt og materialer iht oversikt gitt av Norconsult v/ Magnus Brevik, juli 2018 -->
		<CustomAttribute DataType="Enumeration" Name="WireType" DisplayName="Ledertype" DefaultValue="Cu95"
			Description="The earthing wire type (ewt) [6/16/25/35/50/70/95/120/150 mm2 Cu], or aluminum corresponding to the copper conductivities." >
			<Values>
				<Value>Cu150</Value>
				<Value>Cu120</Value>
				<Value>Cu95</Value>
				<Value>Cu70</Value>
				<Value>Cu50</Value>
				<Value>Cu35</Value>
				<Value>Cu25</Value>
				<Value>Cu16</Value>
				<Value>Cu06</Value>
				<Value>Alu240</Value>
				<Value>Alu190</Value>
				<Value>Alu150</Value>
				<Value>Alu120</Value>
				<Value>Alu80</Value>
				<Value>Alu50</Value>
				<Value>Alu35</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="Sheath" DisplayName="Kappe" DefaultValue="IX"
			Description="The earthing wire sheath type [KHF | UX | TXXI | IX], where KFH:naked conductor for air suspension, UX:insulated for object earthing, TXXI:connecting tracks in tunnels (Cl-free, flame retardant), IX:insulated for indoor or outdoor object earthing. Other Nexans abbreviations are:G:'glødet', H:'hardtrukket', F:'flertrådet'." >
			<Values>
				<Value>KHF</Value>
				<Value>UX</Value>
				<Value>TXXI</Value>
				<Value>IX</Value>
			</Values>
		</CustomAttribute>
		
		<LuaExpression Name="name" ><Formula>code.." ("..Variant..")"</Formula></LuaExpression>
		<LuaExpression Name="Linetype" ><Formula>"RC-EARTHING-"..WireType"</Formula></LuaExpression>
	
		<PropertyPrompt Key="code" DefaultValue="JL-" AcceptEmptyValue="false" />
			
		<!-- Jordleder i lavspentløpet i kabelkanal langs sporet. -->
		<InsertAlignment VariantName="Isolert jordleder" DisplayBlockName="NO-BN-2D-JBTEH-THUMBNAIL-JORDLEDER-Schematic" DefaultToTangentContinuity="false" >
			<IncludeSegmentType>Tangent</IncludeSegmentType>
			<IncludeSegmentType>Curve</IncludeSegmentType>
			<SetValue Key="WireType" Value="Cu95" />
			<SetValue Key="Sheath" Value="IX" />
		</InsertAlignment>

		<!-- Jording som føres fra KL-mast til KL-mast, eller opphengt i tunneltak eller ført langs tunnelvegg. -->
		<!-- Hva med blank leder i pukken? Brukes ikke mye, det er frare for overslag til sporfelt-skinne. -->
		<InsertAlignment VariantName="Blank jordleder" DisplayBlockName="NO-BN-2D-JBTEH-THUMBNAIL-JORDLEDER-Schematic" DefaultToTangentContinuity="false" >
			<IncludeSegmentType>Tangent</IncludeSegmentType>
			<IncludeSegmentType>Curve</IncludeSegmentType>
			<SetValue Key="WireType" Value="Cu95" />
			<SetValue Key="Sheath" Value="KHF" />
		</InsertAlignment>

		<!-- Forbinder skinnestrenger i samme spor, f.eks. trekke returstrøm over til andre skinnen ifbm dobbelisolert skjøt. Kabelforlegning i sporet (dvs TXXI kappe). -->
		<InsertAlignment VariantName="Tverrforbinder" DisplayBlockName="NO-BN-2D-JBTEH-THUMBNAIL-JORDLEDER-Schematic" DefaultToTangentContinuity="false" >
			<IncludeSegmentType>Tangent</IncludeSegmentType>
			<IncludeSegmentType>Curve</IncludeSegmentType>
			<SetValue Key="WireType" Value="Cu70" />
			<SetValue Key="Sheath" Value="TXXI" />
		</InsertAlignment>

		<!-- Forbinder jordskinnen i ett spor med jordskinnen i et annet spor i nærheten. Kabelforlegning er typisk i føringsvei (dvs IX kappe). -->
		<InsertAlignment VariantName="Utjevningsforbinder" DisplayBlockName="NO-BN-2D-JBTEH-THUMBNAIL-JORDLEDER-Schematic" DefaultToTangentContinuity="false" >
			<IncludeSegmentType>Tangent</IncludeSegmentType>
			<IncludeSegmentType>Curve</IncludeSegmentType>
			<SetValue Key="WireType" Value="Cu95" />
			<SetValue Key="Sheath" Value="IX" />
		</InsertAlignment>
	</ObjectType>
	
	
	
<!--========================================================================================================
	HIGH VOLTAGE
	EARTHING ELECTRODE
 =========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" Name="JBTEH_JEL Jordelektrode"
				Layer="JBTEH_JEL" Color="ByLayer"
				Group="Kontaktledning/Jording"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>jordelektrode</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_TAG_OBJECTINFO_METADATA_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___JBTKL" />
		<xpp:expand select="NOBN_com_DISCIPLINE_JBTKL" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />

		<Variants DefaultValue="Kråkefot" >
			<Variant Name="Kråkefot" >
			</Variant>
		</Variants>

		<LuaExpression Name="name" >
			<Formula>
				if Variant == "Kråkefot" then return "Kråkefot"
				else return "Unknown ground spike earthing device variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<!-- TODO Lage 3D-modeller for kråkefot osv -->
		<LuaExpression Name="Model3DName" >
			<Formula>
				if Variant == "Kråkefot" then return "NO-BN-3D-EH-JORDING-KRÅKEFOT"
				else return "Unknown ground spike earthing device variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<InsertPointObject VariantName="Kråkefot" DisplayBlockName="NO-BN-2D-JBTEH_JEL-JORDING-JORDPOTENSIAL-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_JEL-JORDING-JORDPOTENSIAL-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_JEL
				JORDING
				{% if Variant == 'Kråkefot' %}JORDPOTENSIAL
				{% else %}BAD_Variant
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-##RC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	EARTHING CONNECTOR
	TODO Avklare med Bane NOR / Banedata om vi kan opprette ny kategori "EH-JOF"
	TODO Lage model checks som kontrollerer spenningsnivåer - ikke kortslutte høyspent til jord 
 =========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" Name="JBTEH_JOF Jordforbinder" 
				Layer="JBTEH_JOF" Color="ByLayer"
				Group="Kontaktledning/Jording"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
			
		<RelationSpace>jordforbinder</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_TAG_OBJECTINFO_METADATA_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___JBTKL" />
		<xpp:expand select="NOBN_com_DISCIPLINE_JBTKL" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />

		<Variants DefaultValue="Skinnejord" >
			<Variant Name="Jordtilkobling for objekt" ></Variant>
			<Variant Name="Skinnejord" ></Variant>
		</Variants>

		<LuaExpression Name="name" >
			<Formula>
				if Variant == "Jordtilkobling for objekt" then return "Jordtilkobling"
				elseif Variant == "Skinnejord" then return "Skinnejord"
				else return "Unknown earthing connection device variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<!-- TODO Lage 3D-modeller for kråkefot osv -->
		<LuaExpression Name="Model3DName" >
			<Formula>
				--if Variant == "Jordtilkobling for objekt" then return "XYZZY - ikke definert ennå"
				--elseif Variant == "Skinnejord" then return "NO-BN-3D-EH-JORDING-SKINNEJORD"
				--else 
					return "Unknown earthing connection device variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<LuaExpression Name="dir" ><Formula>"both"</Formula></LuaExpression>	

		<!-- TODO Lage relasjoner for automatisk ruting av kabel for jording av objekt til "sin" skinnejord -->
		<InsertPointObject VariantName="Jordtilkobling for objekt" DisplayBlockName="NO-BN-2D-JBTEH_JEL-JORDING-JORDPOTENSIAL-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.75" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" RotateIfRightSideOfAlignment="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Skinnejord" DisplayBlockName="NO-BN-2D-JBTEH_JOF-JORDING-SKINNEJORD-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.75" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" RotateIfRightSideOfAlignment="true" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_JOF-JORDING-SKINNEJORD-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D
				{% if Variant == 'Jordtilkobling for objekt' %}JBTEH_JEL-JORDING-JORDPOTENSIAL
				{% elsif Variant == 'Skinnejord' %}JBTEH_JOF-JORDING-SKINNEJORD
				{% else %}BAD_Variant
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-##RC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	EARTHING BUS-BAR
=========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" Name="JBTEH_JSK Jordingsskinne"
				Layer="JBTEH_JSK" Color="ByLayer"
				Group="Kontaktledning/Jording"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>jordingsskinne</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_TAG_OBJECTINFO_METADATA_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___JBTKL" />
		<xpp:expand select="NOBN_com_DISCIPLINE_JBTKL" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />

		<Variants DefaultValue="Jordingsskinne 10x50x290 (9xØ13)" >
			<Variant Name="Jordingsskinne 10x50x290 (9xØ13)" >
			</Variant>
			<Variant Name="Jordingsskinne 10x50x530 (17xØ13)" >
			</Variant>
		</Variants>

		<LuaExpression Name="name" >
			<Formula>
				if string.match(Variant, "Jordingsskinne") == "Jordingsskinne" then return "Jordingsskinne"
				else return "Unknown earthing bus bar variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<!-- TODO Lage 3D-modeller for kråkefot osv -->
		<LuaExpression Name="Model3DName" >
			<Formula>
				if Variant == "Jordingsskinne 10x50x290 (9xØ13)" then return "NO-BN-3D-EH-JORDING-JORDINGSSKINNE-10x50x290"
				elseif Variant == "Jordingsskinne 10x50x530 (17xØ13)" then return "NO-BN-3D-EH-JORDING-JORDINGSSKINNE-10x50x530"
				else return "Unknown earthing connection device variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<!-- TODO Lage relasjoner som assist-funksjoner for automatisk jording kan benytte. Jordingsskinner plasseres f.eks. i kummer -->
		<InsertPointObject VariantName="Jordingsskinne 10x50x290 (9xØ13)" DisplayBlockName="NO-BN-2D-JBTEH_JSK-JORDING-JORDINGSSKINNE-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="0.75" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
		</InsertPointObject>
		
		<InsertPointObject VariantName="Jordingsskinne 10x50x530 (17xØ13)" DisplayBlockName="NO-BN-2D-JBTEH_JSK-JORDING-JORDINGSSKINNE-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="0.75" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_JSK-JORDING-JORDINGSSKINNE-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_JSK
				JORDING-JORDINGSSKINNE
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-##RC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

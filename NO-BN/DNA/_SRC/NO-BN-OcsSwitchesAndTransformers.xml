<!--========================================================================================================

    NO-BN-OcsSwitchesAndTransformers.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml"/>.

	Copyright (c) 2015-2024 Railcomplete AS, Norway, NO916118503
	
=========================================================================================================-->
<xpp:bloc>

<!--========================================================================================================
	Line(ca)	Contents:
	  25		HIGH VOLTAGE SWITCH
	 235		HIGH VOLTAGE SWITCH ACTUATOR
	 390		BOOSTER TRANSFORMER
	 465		AUTOTRANSFORMER - BALANCED TRANSFORMER
	 540		End Of File
=========================================================================================================-->


<!--========================================================================================================
	HIGH VOLTAGE
	HIGH VOLTAGE SWITCH
=========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" LuaName="rctype_HvSwitch" Name="JBTEH_BRY KL-bryter"
				Layer="JBTEH_BRY" Color="ByLayer"
				Group="Kontaktledning/Brytere"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>kl-bryter</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED"/> -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_TEXATTRIBUTES___VERTICAL_AND_FAR___OCS"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<!-- <xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" /> --> <!-- Only contains 3d properties, but this object doesn't have 3d yet knhel 2023-05-09 -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_OBJECT"/>
		<xpp:expand select="NOBN_com_PSET_BANE_NOR"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA"/>
		<xpp:expand select="NOBN_com_PSET_ISY_STK"/>
		<xpp:expand select="NOBN_com_PSET_TITTELFELT"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_EH_BRY"/>

		<Variants DefaultValue="Skillebryter">
			<Variant Name="Skillebryter">
				<SetValue Key="name" Value="Skillebryter"/>
			</Variant>
			<Variant Name="Lastskillebryter">
				<SetValue Key="name" Value="Lastskillebryter"/>
			</Variant>
			<Variant Name="Jordingsbryter">
				<SetValue Key="name" Value="Jordingsbryter"/>
			</Variant>
			<Variant Name="Effektbryter">
				<SetValue Key="name" Value="Effektbryter"/>
			</Variant>
		</Variants>
		
		<CustomProperty DataType="Enumeration" Name="NormalPosition" DisplayName="Grunnstilling" DefaultValue="Open"
			Description="Switch circuit normal position [Open | Closed].">
			<Values>
				<Value DisplayName="Åpen">Open</Value>
				<Value DisplayName="Lukket">Closed</Value>
			</Values>
		</CustomProperty>
		
		<CustomProperty DataType="Enumeration" Name="Motorized" DisplayName="Motorisert" DefaultValue="No"
			Description="OCS power switch motorization [Yes | No].">
			<Values>
				<Value DisplayName="Ja">Yes</Value>
				<Value DisplayName="Nei">No</Value>
			</Values>
		</CustomProperty>
		<LuaExpression Name="Motorized"><Formula>_JBTEH_BRY_getMotorizationFromRelatedActuator()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_BRY_getMotorizationFromRelatedActuator()" ReturnType="String"
		Description="Checks if the OCS power switch has a related actuator (motor). If there is, returns 'Yes', else returns 'No'.">
		<Constructor>String _JBTEH_BRY_getMotorizationFromRelatedActuator()</Constructor>
			<Formula>
				function _JBTEH_BRY_getMotorizationFromRelatedActuator()
					local _r,n = getRelatedObjects(rel_HvSwitch_Has_HvSwitchActuator)
					if n &gt; 0 then
						return "Yes"
					else
						return "No"
					end
				end
			</Formula>
		</LuaFunction>
		
		<CustomProperty DataType="Enumeration" Name="Poles" DisplayName="Poler" DefaultValue="One"
			Description="The number of conductors which are opened or closed when using the switch [One | Two | Three].">
			<Values>
				<Value DisplayName="En">One</Value>
				<Value DisplayName="To">Two</Value>
				<Value DisplayName="Tre">Three</Value>
			</Values>
		</CustomProperty>
		
		<LuaExpression Name="dir"><Formula>"none"</Formula></LuaExpression>

		<!-- Snap distance 0.6 is because the text shall be placed at a suitable distance from centre track. -->
		<!-- TODO: Implement 3D objects, place 2D symbol as point snap to an OCS pole. -->
		<InsertPointObject Name="Skillebryter" DisplayName="Skillebryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-SKILLEBRYTER-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="One"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Skillebryter" DisplayName="Topols Skillebryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-SKILLEBRYTER-TOPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Two"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Skillebryter" DisplayName="Trepols Skillebryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-SKILLEBRYTER-TREPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Three"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Lastskillebryter" DisplayName="Lastskillebryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-LASTSKILLEBRYTER-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="One"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Lastskillebryter" DisplayName="Topols Lastskillebryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-LASTSKILLEBRYTER-TOPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Two"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Lastskillebryter" DisplayName="Trepols Lastskillebryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-LASTSKILLEBRYTER-TREPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Three"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Jordingsbryter" DisplayName="Jordingsbryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-JORDINGSBRYTER-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="One"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Jordingsbryter" DisplayName="Topols Jordingsbryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-JORDINGSBRYTER-TOPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Two"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Jordingsbryter" DisplayName="Trepols Jordingsbryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-JORDINGSBRYTER-TREPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Three"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Effektbryter" DisplayName="Effektbryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-EFFEKTBRYTER-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="One"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Effektbryter" DisplayName="Topols Effektbryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-EFFEKTBRYTER-TOPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Two"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Effektbryter" DisplayName="Trepols Effektbryter" DisplayBlockName="NO-BN-2D-JBTEH_BRY-EFFEKTBRYTER-TREPOLET-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="0.6">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance EnableDirectionSetting="true"/>
			<SetValue Key="Poles" Value="Three"/>
		</InsertPointObject>

		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_BRY-SKILLEBRYTER-ÅPEN-{{SymbolMode}}">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTEH_BRY
				{% if Variant == 'Skillebryter' %}SKILLEBRYTER
				{% elsif Variant == 'Lastskillebryter' %}LASTSKILLEBRYTER
				{% elsif Variant == 'Jordingsbryter' %}JORDINGSBRYTER
				{% elsif Variant == 'Effektbryter' %}EFFEKTBRYTER
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{% if Poles == 'Two' %}TOPOLET
				{% elsif Poles == 'Three' %}TREPOLET
				{% endif %}
				{% if NormalPosition == 'Open' %}ÅPEN
				{% elsif NormalPosition == 'Closed' %}LUKKET
				{% else %}BAD_NormalPosition_{{NormalPosition}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0.0" Y="0.0" TargetSpace="manøvermaskin"/>
			</SnapPoints>
		</DockPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	HIGH VOLTAGE SWITCH ACTUATOR
=========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" LuaName="rctype_HvSwitchActuator" Name="JBTEH_MAN Manøvermaskin"
				Layer="JBTEH_MAN" Color="ByLayer"
				Group="Kontaktledning/Brytere"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>manøvermaskin</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED"/> -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___OCS"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<!-- <xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" /> --> <!-- Only contains 3d properties, but this object doesn't have 3d yet knhel 2023-05-09 -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_OBJECT"/>
		<xpp:expand select="NOBN_com_PSET_BANE_NOR"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA"/>
		<xpp:expand select="NOBN_com_PSET_ISY_STK"/>
		<xpp:expand select="NOBN_com_PSET_TITTELFELT"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_EH_MAN"/>
		
		<Variants DefaultValue="Manøvermaskin">
			<Variant Name="Manøvermaskin"/>
		</Variants>

		<LuaExpression Name="code"><Formula>_JBTEH_MAN_code()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_MAN_code()" ReturnType="String"
		Description="Obtains its code from its related OCS power switch.">
		<Constructor>String _JBTEH_MAN_code()</Constructor>
			<Formula>
				function _JBTEH_MAN_code()
					local s = rel_HvSwitchActuator_Actuates_HvSwitch
					local r,n = getRelatedObjects(s)
					if n &gt; 0 then
						return r[0].code
					else
						return getPropertyValue("code"),_unfinished, _info("UNFINISHED - No related power switch, relate with '"..s.."'.")
					end
				end
			</Formula>
		</LuaFunction>
		
		<LuaExpression Name="name"><Formula>code</Formula></LuaExpression>

		<LuaExpression Name="LateralOffset"><Formula>_JBTEH_MAN_getLateralOffsetFromRelatedSwitch()</Formula></LuaExpression>		
		<LuaFunction Name="_JBTEH_MAN_getLateralOffsetFromRelatedSwitch()" ReturnType="String"
		Description="Obtains the DistanceToAlignmentfrom its related OCS power switch.">
		<Constructor>String _JBTEH_MAN_getLateralOffsetFromRelatedSwitch()</Constructor>
			<Formula>
				function _JBTEH_MAN_getLateralOffsetFromRelatedSwitch()
					local s = rel_HvSwitchActuator_Actuates_HvSwitch
					local r,n = getRelatedObjects(s)
					if n &gt; 0 then
						return r[0].LateralOffset
					else
						return getPropertyValue("LateralOffset"),_unfinished, _info("UNFINISHED - No related power switch, relate with '"..s.."'.")
					end
				end
			</Formula>
		</LuaFunction>
		
		<LuaExpression Name="Mileage"><Formula>_JBTEH_MAN_getMileageFromRelatedSwitch()</Formula></LuaExpression>		
		<LuaFunction Name="_JBTEH_MAN_getMileageFromRelatedSwitch()" ReturnType="String"
		Description="Obtains the mileagefrom its related OCS power switch.">
		<Constructor>String _JBTEH_MAN_getMileageFromRelatedSwitch()</Constructor>
			<Formula>
				function _JBTEH_MAN_getMileageFromRelatedSwitch()
					local s = rel_HvSwitchActuator_Actuates_HvSwitch
					local r,n = getRelatedObjects(s)
					if n &gt; 0 then
						return r[0].Mileage
					else
						return getPropertyValue("Mileage"),_unfinished, _info("UNFINISHED - No related power switch, relate with '"..s.."'.")
					end
				end
			</Formula>
		</LuaFunction>
		
		<LuaExpression Name="dir"><Formula>_JBTEH_MAN_getDirFromRelatedSwitch()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_MAN_getDirFromRelatedSwitch()" ReturnType="String"
		Description="Obtains the dirfrom its related OCS power switch.">
		<Constructor>String _JBTEH_MAN_getDirFromRelatedSwitch()</Constructor>
			<Formula>
				function _JBTEH_MAN_getDirFromRelatedSwitch()
					local s = rel_HvSwitchActuator_Actuates_HvSwitch
					local r,n = getRelatedObjects(s)
					if n &gt; 0 then
						return r[0].dir
					else
						return getPropertyValue("dir"),_unfinished, _info("UNFINISHED - No related power switch, relate with '"..s.."'.")
					end
				end
			</Formula>
		</LuaFunction>
		
		<CustomProperty DataType="Enumeration" Name="NormalPosition" DisplayName="Grunnstilling" DefaultValue="OPEN"
			Description="Switch circuit normal position [Open | Closed].">
			<Values>
				<Value DisplayName="Åpen">OPEN</Value>
				<Value DisplayName="Lukket">CLOSED</Value>
			</Values>
		</CustomProperty>
		<LuaExpression Name="NormalPosition"><Formula>_JBTEH_MAN_getNormalPositionFromRelatedSwitch()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_MAN_getNormalPositionFromRelatedSwitch()" ReturnType="String"
		Description="Obtains the normal position of the related switch.">
		<Constructor>String _JBTEH_MAN_getNormalPositionFromRelatedSwitch()</Constructor>
			<Formula>
				function _JBTEH_MAN_getNormalPositionFromRelatedSwitch()
					local s = rel_HvSwitchActuator_Actuates_HvSwitch
					local r,n = getRelatedObjects(s)
					if n &gt; 0 then
						return r[0].NormalPosition
					else
						return getPropertyValue("NormalPosition"),_unfinished, _info("UNFINISHED - No related power switch, relate with '"..s.."'.")
					end
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject Name="Manøvermaskin" DisplayName="Manøvermaskin" DisplayBlockName="NO-BN-2D-JBTEH_MAN-MANØVERMASKIN-ÅPEN-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="1e-3">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
		</InsertPointObject>	
	
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTEH_MAN-MANØVERMASKIN
				{% if NormalPosition == 'OPEN' %}ÅPEN
				{% elsif NormalPosition == 'CLOSED' %}LUKKET
				{% else %}BAD_NormalPosition_ {{NormalPosition}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>
		
	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	BOOSTER TRANSFORMER
=========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" LuaName="rctype_BoosterTransformer" Name="JBTEH_SUG Sugetransformator"
				Layer="JBTEH_SUG" Color="ByLayer"
				Group="Kontaktledning/Sugetransformatorer"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>sugetransformator</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED"/> -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___OCS"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<!-- <xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" /> --> <!-- Only contains 3d properties, but this object doesn't have 3d yet knhel 2023-05-09 -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_OBJECT"/>
		<xpp:expand select="NOBN_com_PSET_BANE_NOR"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA"/>
		<xpp:expand select="NOBN_com_PSET_ISY_STK"/>
		<xpp:expand select="NOBN_com_PSET_TITTELFELT"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_EH_SUG"/>

		<Variants DefaultValue="Sugetransformator">
			<Variant Name="Sugetransformator"/>
			<Variant Name="Sugetransformator i kiosk"/>
		</Variants>

		<LuaExpression Name="dir"><Formula>"both"</Formula></LuaExpression>
				   
		<InsertPointObject Name="Sugetransformator" DisplayBlockName="NO-BN-2D-JBTEH_SUG-SUGETRANSFORMATOR-I-MAST-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="1e-3">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false"/>
			<SetValue Key="name" Value="SUGETRANSFORMATOR"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Sugetransformator i kiosk" DisplayBlockName="NO-BN-2D-JBTEH_SUG-SUGETRANSFORMATOR-I-KIOSK-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="1e-3">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false"/>
			<SetValue Key="name" Value="SUGETRANSFORMATOR i kiosk"/>
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTEH_SUG
				{% if Variant == 'Sugetransformator' %}SUGETRANSFORMATOR-I-MAST
				{% elsif Variant == 'Sugetransformator i kiosk' %}SUGETRANSFORMATOR-I-KIOSK
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	AUTOTRANSFORMER - BALANCED TRANSFORMER
	Carrying two times the applicable line voltage, feeding between midpoint and alternating poles.
=========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" LuaName="rctype_AutoTransformer" Name="JBTEH_AUT Autotransformator"
				Layer="JBTEH_AUT" Color="ByLayer"
				Group="Kontaktledning/Autotransformatorer"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>autotransformator</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED"/> -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___OCS"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_OBJECT"/>
		<xpp:expand select="NOBN_com_PSET_BANE_NOR"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA"/>
		<xpp:expand select="NOBN_com_PSET_ISY_STK"/>
		<xpp:expand select="NOBN_com_PSET_TITTELFELT"/>
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_EH_AUT"/>

		<Variants DefaultValue="Autotransformator">
			<Variant Name="Autotransformator"/>
		</Variants>

		<LuaExpression Name="Geometry3D_0.Name"><Formula>_JBTEH_AUT_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_AUT_Geometry3DName()" ReturnType="String"
			Description="Returns the 3D model name for an autotransformer housing.">
			<Constructor>String _JBTEH_AUT_Geometry3DName()</Constructor>
			<Formula>
				function _JBTEH_AUT_Geometry3DName()
					return "NO-BN-3D-EH-AUT-AT-KIOSK-3230x2930x3035-MED-FUNDAMENT-1515-0300"
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject Name="Autotransformator" DisplayBlockName="NO-BN-2D-JBTEH_AUT-AUTOTRANSFORMATOR-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="1e-3">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false"/>
			<SetValue Key="name" Value="Autotrafo"/>
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTEH_AUT
				{% if Variant == 'Autotransformator' %}AUTOTRANSFORMATOR
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

	</ObjectType>



<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

<!--========================================================================================================

    NO-BN-PsetBaneNOR.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2021. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>

<!--========================================================================================================
	Extended data property sets (will be picked up by AutoCAD as Extended Data, and exports to IFC using Civil 3D)
=========================================================================================================-->

<!-- «Bane NOR» skal inneholde data om område- og faginndeling, info om riving/bygging og MMI nivå -->
<!-- Datasettet og finnes under …\BIM\Config\ISY\Properties. -->

<PropertySets>
	<ExtendedDataPropertySet Name="Bane NOR" IsVisible="true" IsWritable="true" IsLocked="false" >
		<Properties>
			<ExtendedDataProperty Name="Modelltype" DataType="Text" Description="«Fagmodell» eller «Grunnlagsmodell»" DefaultValue="---" IsVisible="true" DisplayOrder="1" />
			<ExtendedDataProperty Name="BaneData ID" DataType="Text" Description="BaneData ID nummer" DefaultValue="---" IsVisible="true" DisplayOrder="2" />
			<ExtendedDataProperty Name="Rives" DataType="Text" Description="«Ja» eller «Nei»" DefaultValue="---" IsVisible="true" DisplayOrder="3" />
			<ExtendedDataProperty Name="Rives fase" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="4" />
			<ExtendedDataProperty Name="Bygges fase" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="5" />
			<ExtendedDataProperty Name="Beskrivelse" DataType="Text" Description="Beskrivelse tekst fra BaneData" DefaultValue="---" IsVisible="true" DisplayOrder="6" />
			<ExtendedDataProperty Name="Rives av" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="7" />
			<ExtendedDataProperty Name="Bygges av" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="8" />
			<ExtendedDataProperty Name="Fag" DataType="Text" Description="Se «Fagkoder Bane NOR»" DefaultValue="---" IsVisible="true" DisplayOrder="9" />
			<ExtendedDataProperty Name="Prosjekterende" DataType="Text" Description="" DefaultValue="" IsVisible="true" DisplayOrder="10" />
			<ExtendedDataProperty Name="Type og dimensjon" DataType="Text" Description="Kort faglig forklaring" DefaultValue="---" IsVisible="true" DisplayOrder="11" />
			<ExtendedDataProperty Name="MMI" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="12" />
		</Properties>
	</ExtendedDataPropertySet>
</PropertySets>



<!--========================================================================================================
    ObjectType element 'CustomAttribute' macros for Bane NOR koder
=========================================================================================================-->


 
 <!-- RailCOMPLETE benytter en extended data definisjon (element PropertySets / ExtendedDataPropertySet) for å definere et  -->
 <!-- property set som kan legges inn i objekters AutoCAD Extended Data. De dukker da opp i alle Autodesk produkter som  -->
 <!-- objektdata / Extended Data. -->
 
 <!-- Data som ligger som Extended Data i et AutoCAD-objekt vil "bli med på lasset" over til IFC dersom du har Civil 3D installert -->
 <!-- og benytter kommandoen for eksport til IFC, EXPORTIFC. -->

	

	<!-- <xpp:expand select="NOBN_com_PSET_BANE_NOR" /> -->
<xpp:define name="NOBN_com_PSET_BANE_NOR" >
	<xpp:bloc>
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Modelltype" Name="BaneNORModelltype" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Modelltype" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="BaneData ID" Name="BaneNORBaneDataID" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="BaneData ID" />				
	    <CustomAttribute Category="Pset Bane NOR" DataType="Enumeration" DisplayName="Rives" Name="BaneNORRives" DefaultValue="Ukjent"
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Rives" >
			<Values>
				<Value>Ukjent</Value>
				<Value>Ja</Value>
				<Value>Nei</Value>
			</Values>
		</CustomAttribute>
		
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Rives fase" Name="BaneNORRivesfase" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Rives fase" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Bygges fase" Name="BaneNORByggesfase" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Bygges fase" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Beskrivelse" Name="BaneNORBeskrivelse" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Beskrivelse" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Rives av" Name="BaneNORRivesAv" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Rives av" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Bygges av" Name="BaneNORByggesAv" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Bygges av" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Fag" Name="BaneNORFag" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Fag" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Prosjekterende" Name="BaneNORProsjekterende" DefaultValue=""
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Prosjekterende" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="Type og dimensjon" Name="BaneNORTypeOgDimensjon" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="Type og dimensjon" />
	    <CustomAttribute Category="Pset Bane NOR" DataType="String" DisplayName="MMI" Name="BaneNORMMI" DefaultValue="" 
				ExtendedDataPropertySet="Bane NOR" ExtendedDataPropertyDefinition="MMI" />

		<!-- Pset automation formulas -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___STAGE" />
		<LuaExpression Name="BaneNORRives" ><Formula>NOBN_com_Pset_BaneNORRives()</Formula></LuaExpression>						
		<LuaExpression Name="BaneNORRivesFase" ><Formula>NOBN_com_Pset_BaneNORRivesFase()</Formula></LuaExpression>						
		<LuaExpression Name="BaneNORByggesFase" ><Formula>NOBN_com_Pset_BaneNORByggesFase()</Formula></LuaExpression>						
		<LuaExpression Name="BaneNORFag" ><Formula>discipline</Formula></LuaExpression>						

	</xpp:bloc>
</xpp:define>



	<!-- Pset global automation functions (kept in DNA, called from object instances) -->
    <LuaFunction Name="NOBN_com_Pset_BaneNORRives()" ReturnType="String"
		Description="Returnerer 'Ukjent' dersom egenskap 'layer' inneholder et gyldig fasemønster på  formen 'XXxx-YYyy' (inn-i-fase XX.xx, ut-i-fase YY-yy). 
			\nReturnerer 'Ja' dersom fasemønsteret har ut-fase '9999'.
			\nReturnerer 'Nei' dersom fasemønsteret har en ut-fase lavere enn '9999'." >
        <Constructor>Enum[Ukjent|Ja|Nei] NOBN_com_Pset_BaneNORRives()</Constructor>
        <Formula>
			function NOBN_com_Pset_BaneNORRives()
				exitStage = layer:match(".*%d%d%d%d%-(%d%d%d%d).*")
				if exitStage == nil then 
					return 'Ukjent'
				else
					return exitStage == '9999' and 'Nei' or 'Ja'
				end
			end
        </Formula>
    </LuaFunction> 




    <LuaFunction Name="NOBN_com_Pset_BaneNORRivesFase()" ReturnType="String"
		Description="Returnerer fasemønster 'YYyy' fra egenskap 'layer', der YYyy er fasen som objektet første gang er utgått i, eller blank dersom objektet ikke rives eller dersom faseinformasjon 'XXxx-YYyy' ikke er angitt i 'layer'." >
        <Constructor>String NOBN_com_Pset_BaneNORRivesFase()</Constructor>
        <Formula>
			function NOBN_com_Pset_BaneNORRivesFase()
				exitStage = layer:match(".*%d%d%d%d%-(%d%d%d%d).*")
				if exitStage == nil or exitStage == '9999' then 
					return ''
				else
					return exitStage
				end
			end
        </Formula>
    </LuaFunction> 



    <LuaFunction Name="NOBN_com_Pset_BaneNORByggesFase()" ReturnType="String"
		Description="Returnerer fasemønster 'XXxx' fra egenskap 'layer', der XXxx er fasen som objektet første gang eksisterer i, eller blank dersom faseinformasjon 'XXxx-YYyy' ikke er angitt i 'layer'." >
        <Constructor>String NOBN_com_Pset_BaneNORByggesFase()</Constructor>
        <Formula>
			function NOBN_com_Pset_BaneNORByggesFase()
				entryStage = layer:match(".*(%d%d%d%d)%-%d%d%d%d.*")
				if entryStage == nil then 
					return ''
				else
					return entryStage
				end
			end
        </Formula>
    </LuaFunction> 



<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>
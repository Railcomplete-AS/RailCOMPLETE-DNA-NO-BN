<!--========================================================================================================

    NO-BN-PsetIsyBeskrivelse.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2023. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>



<!--========================================================================================================
	Extended data property sets (will be picked up by AutoCAD as Extended Data, and exports to IFC using Civil 3D)
=========================================================================================================-->
<PropertySets>
	<ExtendedDataPropertySet Name="ISY Beskrivelse" IsVisible="true" IsWritable="true" IsLocked="false" >
		<Properties>
			<ExtendedDataProperty Name="ISY Prosesskode" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="1" />
			<ExtendedDataProperty Name="ISY Prosessnavn" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="2" />
			<ExtendedDataProperty Name="ISY Mengde" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="3" />
			<ExtendedDataProperty Name="ISY Enhet" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="4" />
			<ExtendedDataProperty Name="ISY Sted" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="5" />
			<ExtendedDataProperty Name="ISY Postnotat" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="6" />
		</Properties>
	</ExtendedDataPropertySet>
</PropertySets>



<!--========================================================================================================
    ObjectType element 'CustomAttribute' macros for ISY beskrivelse koder
=========================================================================================================-->

<!-- "ISY Beskrivelse" (ISYB) og ISY 360 (isy360) er produkter fra NOIS, Norconsult "Informasjonssystemer.  -->
<!-- ISYB benyttes for å koble beskrivelsestekster til objekttyper, samt angi hvor de skal bygges og angi enhet og mengder. -->
<!-- ISYB leser IFC-modeller med IFC property sets, visualiserer modellen og lar kontraktstilbydere aggregere mengder -->
<!-- for å beregne priser. Noen applikasjoner - såsom Focus 2017 CAT (som kjører AutoCAD 2017+) kan sammen med NOIS sin app  -->
<!-- legge inn property values på IsyProsesskode, IsyProsessnavn etc, som angitt nedenfor. RailCOMPLETE benytter en  -->
<!-- extended data definisjon (element PropertySets / ExtendedDataPropertySet) for å definere et property set som  -->
<!-- kan legges inn i objekters AutoCAD Extended Data. De dukker da opp i alle Autodesk produkter som objektdata / Extended Data. -->

<!-- Data som ligger som Extended Data i et AutoCAD-objekt vil "bli med på lasset" over til IFC dersom du har Civil 3D installert -->
<!-- og benytter kommandoen for eksport til IFC, EXPORTIFC. -->

<!-- TODO Thomas: Skriv forklaringer her på hvordan man kobler til f.eks. DocumentData.ExtFileObjects["IsySteder for  -->
<!-- Drammen-prosjektet. Eller DocumentData.ExtFileObjects["Isy Steder"] om det er whitespace i filnavnet. -->
<!-- Forklar hvordan man kobler seg til Bane NORs beskrivelsestekster - XML-fila. -->
<!-- <xpp:expand select="NOBN_com_PSET_ISY_STK" /> -->
<xpp:define name="NOBN_com_PSET_ISY_STK" >
	<xpp:bloc>
		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Prosesskode" Name="IsyProsesskode" DefaultValue="" 
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Prosesskode" />

	    <CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Prosessnavn " Name="IsyProsessnavn" DefaultValue="" 
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Prosessnavn" />

	    <CustomAttribute Category="Pset ISY Beskrivelse" DataType="UInt32" DisplayName="Pset ISY Mengde" Name="IsyMengde" DefaultValue="1" 	
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Mengde" />   

		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Enhet" Name="IsyEnhet" DefaultValue="stk" 	
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Enhet" />

		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Sted" Name="IsySted" 
				DefaultValue="" 
				ExtendedDataPropertySet="ISY Beskrivelse" 
				Description="The IsySted [Enum] is a string from an from external file, referenced as a path+filename and parsed with suitable Lua code, declared in global property 'ExternalFileObjectReferences'." 
				ExtendedDataPropertyDefinition="ISY Sted" 
				StandardValuesFromLuaFormula="true"
				StandardValuesExclusive="true"
			>
			<StandardValuesLuaFormula>DocumentData.ExternalFileObjects.ISY_Steder</StandardValuesLuaFormula>
		</CustomAttribute>

		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Postnotat" Name="IsyPostnotat" DefaultValue="" 
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Postnotat" />

	</xpp:bloc>
</xpp:define>



	<!-- <xpp:expand select="NOBN_com_PSET_ISY_METER" /> -->
<xpp:define name="NOBN_com_PSET_ISY_METER" >
	<xpp:bloc>
		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Prosesskode" Name="IsyProsesskode" DefaultValue="" 
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Prosesskode" />

	    <CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Prosessnavn " Name="IsyProsessnavn" DefaultValue="" 
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Prosessnavn" />

	    <CustomAttribute Category="Pset ISY Beskrivelse" DataType="UInt32" DisplayName="Pset ISY Mengde" Name="IsyMengde" DefaultValue="1"
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Mengde" />   

		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Enhet" Name="IsyEnhet" DefaultValue="meter"
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Enhet" />

		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Sted" Name="IsySted" DefaultValue="" 
				ExtendedDataPropertySet="ISY Beskrivelse" 
				ExtendedDataPropertyDefinition="ISY Sted" 
				Description="The IsySted [Enum] is a string from an from external file, referenced as a path+filename and  parsed with suitable Lua code, declared in global property 'ExternalFileObjectReferences'." 
				StandardValuesFromLuaFormula="true" StandardValuesExclusive="true" >
			<StandardValuesLuaFormula>DocumentData.ExternalFileObjects.ISY_Steder</StandardValuesLuaFormula>
		</CustomAttribute>

		<CustomAttribute Category="Pset ISY Beskrivelse" DataType="String" DisplayName="Pset ISY Postnotat" Name="IsyPostnotat" DefaultValue=""
				ExtendedDataPropertySet="ISY Beskrivelse" ExtendedDataPropertyDefinition="ISY Postnotat" />
	</xpp:bloc>
</xpp:define>
 


<!--========================================================================================================
    TODO: Automatisering av valg av riktig prosesskode og prosessbeskrivelse ut i fra objekttype.
	Skisse til kode:
-->
		<!-- <LuaExpression Name="IsyProsesskode" > -->
			<!-- <Formula> -->
				<!-- if MainSignal == "Hs3" then -->
					<!-- if Function == "home" then return "3.52.131" -->
					<!-- elseif Function == "exit" then return "3.52.132" -->
					<!-- else return "3.52.13" -->
					<!-- end -->
				<!-- elseif MainSignal == "Hs2" then -->
					<!-- if Function == "home" then return "3.52.141" -->
					<!-- elseif Function == "exit" then return "3.52.142" -->
					<!-- else return "3.52.14" -->
					<!-- end -->
				<!-- else -->
					<!-- return "Prosesskode ikke definert" -->
				<!-- end -->
			<!-- </Formula> -->
		<!-- </LuaExpression>  -->
		
		<!-- <LuaExpression Name="IsyProsessnavn" > -->
			<!-- <Formula> -->
				<!-- if MainSignal == "Hs3" then -->
					<!-- if Function == "home" then return "Lyssignal, 3-lys; Innkjørhovedsignal" -->
					<!-- elseif Function == "exit" then return "Lyssignal, 3-lys; Utkjørhovedsignal" -->
					<!-- else return "Lyssignal, 3-lys" -->
					<!-- end -->
				<!-- elseif MainSignal == "Hs2" then -->
					<!-- if Function == "home" then return "Lyssignal, 2-lys; Innkjørhovedsignal" -->
					<!-- elseif Function == "exit" then return "Lyssignal, 2-lys; Utkjørhovedsignal" -->
					<!-- else return "Lyssignal, 2-lys" -->
					<!-- end -->
				<!-- else -->
					<!-- return "Prosessnavn ikke definert" -->
				<!-- end -->
			<!-- </Formula> -->
		<!-- </LuaExpression>  -->
		
		<!-- <LuaExpression Name="IsySted" > -->
			<!-- <Formula> -->
				<!-- if OcpStationReference == nil then return "OCP mangler",_warning end -->
				<!-- return OcpStationReference.code -->
			<!-- </Formula> -->
		<!-- </LuaExpression>  -->
		
		
<!--=========================================================================================================-->



<!--========================================================================================================
    3D Annotation for objekter med ISY Beskrivelser.
	
	Disse var konstruert før vi forstod at vi måtte lage 'ekte' AutoCAD Extended Data. De oppretter data som 
	blir synlig i AutoCAD og i NavisWorks Properties, men som ikke blir med ut til IFC eksport med Civil 3D.
	
	De benyttes for å sette våre InherentAttributes / CustomAttributes inn som AutoCAD ATTRIBUTE
	elementer i de 3D-eksporterte blokkene. 
	
	Setter man Invisible="false" så blir attributten også synlig i eksportert 3D-grafikk.
=========================================================================================================-->
<xpp:define name="NOBN_com_ISY_3D_ANNOTATIONS" >
	<xpp:bloc>
		<SetValue Key="Annotations3D" Value = '
			&lt;?xml version="1.0" encoding="utf-8"?&gt;
			&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; 

			&lt;ArrayOfPlacedElementCadAnnotation 
					xmlns:xsd="http://www.w3.org/2001/XMLSchema" 
					xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
			
				&lt;PlacedElementCadAnnotation Tag="ISY Prosesskode" Invisible="true" Height="2"&gt;
					&lt;Formula&gt;IsyProsesskode&lt;/Formula&gt;
					&lt;Offset X="0" Y="30" Z="0" /&gt;
					&lt;Rotation X="0" Y="0" Z="0" /&gt;
				&lt;/PlacedElementCadAnnotation&gt;
			
				&lt;PlacedElementCadAnnotation Tag="ISY Prosessnavn" Invisible="true" Height="2"&gt;
				&lt;Formula&gt;IsyProsessnavn&lt;/Formula&gt;
				&lt;Offset X="0" Y="25" Z="0" /&gt;
				&lt;Rotation X="0" Y="0" Z="0" /&gt;
				&lt;/PlacedElementCadAnnotation&gt;
			
				&lt;PlacedElementCadAnnotation Tag="ISY Mengde" Invisible="true" Height="2"&gt;
				&lt;Formula&gt;IsyMengde&lt;/Formula&gt;
				&lt;Offset X="0" Y="20" Z="0" /&gt;
				&lt;Rotation X="0" Y="0" Z="0" /&gt;
				&lt;/PlacedElementCadAnnotation&gt;
			
				&lt;PlacedElementCadAnnotation Tag="ISY Enhet" Invisible="true" Height="2"&gt;
				&lt;Formula&gt;IsyEnhet&lt;/Formula&gt;
				&lt;Offset X="0" Y="15" Z="0" /&gt;
				&lt;Rotation X="0" Y="0" Z="0" /&gt;
				&lt;/PlacedElementCadAnnotation&gt;
			
				&lt;PlacedElementCadAnnotation Tag="ISY Sted" Invisible="true" Height="2"&gt;
				&lt;Formula&gt;IsySted&lt;/Formula&gt;
				&lt;Offset X="0" Y="10" Z="0" /&gt;
				&lt;Rotation X="0" Y="0" Z="0" /&gt;
				&lt;/PlacedElementCadAnnotation&gt;
			
				&lt;PlacedElementCadAnnotation Tag="ISY Postnotat" Invisible="true" Height="2"&gt;
				&lt;Formula&gt;IsyPostnotat&lt;/Formula&gt;
				&lt;Offset X="0" Y="5" Z="0" /&gt;
				&lt;Rotation X="0" Y="0" Z="0" /&gt;
				&lt;/PlacedElementCadAnnotation&gt;
			
			&lt;/ArrayOfPlacedElementCadAnnotation&gt;'
		/>
	</xpp:bloc>
</xpp:define>


	
<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

<!--========================================================================================================

    NO-BN-Signals.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2021. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>



<!--========================================================================================================
	sig - Signaling Lua formulas for signals (for other signaling objects: see other DNA file).
	Domain-specific Lua functions, stored in Global Extension Dictionary (not in each object).
=========================================================================================================-->
    <LuaFunction Name="NOBN_sig_getSignalNumber()" ReturnType="String"
		Description="Returns the number extracted from the signal's Code, e.g. '4313UL' or 'UL4313' or '4313' => '4313'." >
        <Constructor>String NOBN_sig_getSignalNumber(tSignal s)</Constructor>
		<Formula>
function NOBN_sig_getSignalNumber(s)
	if s == nil then s = getObjectFromId(id) end -- Assume object really IS a signal...
	local c = tostring(s.Code)
	if c == nil then return "" end
	if c:match("%d+%D+") then
		-- digits + nondigits:
		return c:match("%d+%D+"):match("%d+")
	elseif c:match("%D+%d+") then
		-- nondigits + digits:
		return c:match("%D+%d+"):match("%d+")
	elseif c:match("%d+") then
		-- just digits:
		return c:match("%d+")
	else
		-- just nondigits, or empty:
		return ""
	end
end
		</Formula>
    </LuaFunction>
    


    <LuaFunction Name="NOBN_sig_getSignalLitra()" ReturnType="String"
		Description="Returns the litra extracted from the signal's Code, e.g. '4313UL' or 'UL4313' or 'UL' => 'UL'." >
        <Constructor>String NOBN_sig_getSignalLitra(tSignal s)</Constructor>
        <Formula>
function NOBN_sig_getSignalLitra(s)
	if s == nil then s = getObjectFromId(id) end -- Assume object really IS a signal...
	local c = tostring(s.Code)
	if c == nil then return "" end
	if c:match("%d+%D+") then
		-- digits + nondigits:
		return c:match("%d+%D+"):match("%D+")
	elseif c:match("%D+%d+") then
		-- nondigits + digits:
		return c:match("%D+%d+"):match("%D+")
	elseif c:match("%D+") then
		-- just nondigits:
		return c:match("%D+")
	else
		-- just digits, or empty:
		return ""
	end
end
		</Formula>
    </LuaFunction>
	

	
	<LuaFunction Name="NOBN_sig_getSignalShortName()" ReturnType="String"
		Description="Returns the formated short name extracted from a main/distant signal's Code, e.g. '4313UL' or 'UL4313' => '4313(UL)'." >
        <Constructor>NOBN_sig_getSignalShortName()</Constructor>
        <Formula>
function NOBN_sig_getSignalShortName()
	if NOBN_sig_getSignalLitra() == "" then 
		return NOBN_sig_getSignalNumber()
	else
		return NOBN_sig_getSignalNumber().."("..NOBN_sig_getSignalLitra()..")"
	end
end
		</Formula>
    </LuaFunction>


	 
    <LuaFunction Name="NOBN_sig_getSignalFullName()" ReturnType="String"
		Description="Returns the elaborate name of the signal, formated according to Bane NOR standard practice." >
        <Constructor>String NOBN_sig_getSignalFullName()</Constructor>
        <Formula>
function NOBN_sig_getSignalFullName()
	local t
	if RcType == "JBTSA_ERT ERTMS-signal" then
		if Variant == "ERTMS dverg" then 
			return "EDs.R"..NOBN_sig_getSignalNumber() 
		elseif Variant:match("E35") then
			t = "Mb."
		end
	
	elseif RcType == "JBTSA_SIG Signal" then
		if (MainSignal == "Hs1") then
			t = "Stopplykt"
		elseif (MainSignal == "RepHs1" or MainSignal == "RepHs2") then 
			t = "Rep.Hs."
		elseif (MainSignal ~= "-") then 
			t = "Hs."
		elseif (DistantSignal ~= "-") then
			t = "Fs."
		elseif (EndOfTrainRouteSignal ~= "-") then
			t = "S66."
		elseif (DwarfSignal ~= "-") then
			return "Ds.R"..NOBN_sig_getSignalNumber()
		elseif (HighShuntingSignal ~= "-") then
			return "Z."..code
		else
			t = "Sig." --Covers all the remaining - MKs, FKs, Ls, LHs, AVs, BPs
		end
	
	elseif RcType == "JBTSA_FIK Fiktivt punkt" then
		t = "Fik."
		if Variant == "Viapunkt for betjeningsanlegg" then return t..code
		elseif Variant == "Fiktivt sluttpunkt for togvei" then return t..NOBN_sig_getSignalShortName().." (HTv)"
		elseif Variant == "Fiktivt sluttpunkt for skiftevei" then return t..NOBN_sig_getSignalShortName().." (DTv)"
		elseif Variant == "Fiktivt sluttpunkt for togvei og skiftevei" then return t..NOBN_sig_getSignalShortName().." (HTv/DTv)"
		else 
			return t..NOBN_sig_getSignalShortName().." (Unrecognized variant ["..Variant.."])",_warning  
		end

	elseif RcType == "JBTSA_SIG Togsporsignal" then
		t = "Togsporsignal "..code
		
	elseif RcType == "JBTSA_SIG Brusignal/Frostportsignal" then
		t = "Brusignal/Frostportsignal"..code
		
	elseif RcType == "JBTSA_SIG Rasvarslingssignal" then
		t = "Rasvarslingssignal "..code
		
	elseif RcType == "JBTSA_SIG Veisignal" then
		t = "Veisignal "..code
		
	elseif RcType == "JBTSA_SIG Planovergangssignal" then
		t = (Variant:match("forsignal") and "PLO-Fs" or "PLO")..code

	else
		t = "Bad signal type ["..RcType.."] (code='"..code.."').",_warning
	end
	return t..NOBN_sig_getSignalShortName()
end
		</Formula>
     </LuaFunction>


	 
    <LuaFunction Name="NOBN_sig_getSignalPartNames()" ReturnType="String"
		Description="Returns the signal component names, formated according to Bane NOR standard practice." >
        <Constructor>String NOBN_sig_getSignalPartNames()</Constructor>
        <Formula>
function NOBN_sig_getSignalPartNames()
	local s = ""
	local errMsg = "*** Unrecognized signal configuration ***"
	if RcType == "JBTSA_ERT ERTMS-signal" then
		if Variant:match("E35") then s = "E35" end
		if Variant:lower():match("dverg") then s = s.."-EDS" end
	elseif RcType == "JBTSA_SIG Signal" then
		if (MainSignal ~= "-") then s = s..MainSignal:upper() end
		if (DistantSignal ~= "-") then s = s.."-FS" end
		if (EndOfTrainRouteSignal ~= "-") then s = s.."-TVS" end
		if (DwarfSignal ~= "-") then s = s.."-DS" end
		if (HighShuntingSignal ~= "-") then s = s.."-ZS" end
		if (PositionLamp ~= "-") then s = s.."-MKS" end
		if (CautiousDrivingSignal ~= "-") then s = s.."-FKS" end
		if (LineSignal ~= "-") then s = s.."-LS" end
		if (OpticalSpeedSignal ~= "-") then s = s.."-LHS" end
		if (DepartureSignal ~= "-") then s = s.."-AVS" end
		if (BrakeTestSignal ~= "-") then s = s.."-BPS" end
		--TODO: More complete check of unrecognized combination
	elseif RcType == "JBTSA_SIG Togsporsignal" then
		s = "Togsporsignal"
	elseif RcType == "JBTSA_SIG Brusignal/Frostportsignal" then
		s = "Brusignal/Frostportsignal"
	elseif RcType == "JBTSA_SIG Rasvarslingssignal" then
		s = "Rasvarslingssignal"
	elseif RcType == "JBTSA_SIG Veisignal" then
		s = "Veisignal"   
	elseif RcType == "JBTSA_SIG Planovergangssignal" then
		s = "Planovergangssignal"
	elseif RcType == "JBTSA_FIK Fiktivt punkt" then
		s = "Fiktivt punkt"
	else
		s = "Bad signal type ["..RcType.."].",_warning
	end
	if s:match("^-.+") then s = s:sub(2) end --Strip off leading dash character '-', if any
	return s
end	 
		</Formula>
     </LuaFunction>



<!--========================================================================================================
	SIGNAL
	FIKTIVE PUNKTER
	JBTSA_FIK Fiktivt punkt
	Begynnelsespunkt / sluttpunkt for tog og skift, viapunkt for togvei og skifteveistilling.
	Benyttes bÃ¥de i sikringsanlegg, ATC og betjeningsanlegg.
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_FIK Fiktivt punkt"
				Layer="JBTSA_FIK" Color="ByLayer"
				Group="Signal/Fiktive punkter"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_FIK" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<Variants>
			<Variant Name="Viapunkt for betjeningsanlegg" >
			</Variant>
			<Variant Name="Fiktivt sluttpunkt for togvei" >
			</Variant>
			<Variant Name="Fiktivt sluttpunkt for skiftevei" >
			</Variant>
			<Variant Name="Fiktivt sluttpunkt for togvei og skiftevei" >
			</Variant>
		</Variants>

		<InsertPointObject VariantName="Viapunkt for betjeningsanlegg" DisplayBlockName="NO-BN-2D-JBTSA_FIK-VIAPUNKT-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Fiktivt sluttpunkt for togvei" DisplayBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Fiktivt sluttpunkt for skiftevei" DisplayBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Fiktivt sluttpunkt for togvei og skiftevei" DisplayBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}" AllowSymbolMove="true" >
				<Rotation Add180DegreesIfDirIsDown="true" /> <!--Kan ha both (toveis viapunkt), up eller down som retning-->
			<BlockNameFormat JoinBy="-" >
			NO-BN-2D-JBTSA_FIK
			{% if Variant == 'Viapunkt for betjeningsanlegg' %}VIAPUNKT
			{% else %}FIKTIVT-SLUTTPUNKT
			{% endif %}
			{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />
	</ObjectType>



<!--========================================================================================================
	SIGNALING
	CLASS A SIGNALS (ERTMS)
=========================================================================================================-->
	<!-- ERTMS markerboards boards with pole. 2D symbols feature the "mast foot". -->
	<!-- Note: The other ERTMS boards have been classified as 'JBTSA_MSS ERTMS skilt' boards. -->
	<!-- 2021-01-11 CLFEY TODO Check if Bane NOR decides to use E34 "Location signal" (stedssignal, black arrow on white): -->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_ERT ERTMS-signal"
				Layer="JBTSA_ERT" Color="ByLayer"
				Group="Signal/Klasse-A signaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
		<AttachmentCategory Name="markerboard" PassAttachmentToTarget="true" />				
		<RelationSpace>markerboard</RelationSpace>
		<!-- Attach to 'signalfundament' for Ã76 shunting signal or to 'skiltfeste' for Ã60 poles. -->
		<AttachTo Category="signalfundament" /> 
		<AttachTo Category="skiltfeste" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___YOKEMOUNTED" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />
		
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />
		
		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalPartNames().." - "..code</Formula></LuaExpression> 

		<Variants>
			<Variant Name="ERTMS E35 Stoppskilt, sidestilt" >
				<SetValue Key="type" Value="main" />
				<SetValue Key="function" Value="blocking" /> <!--most marker boards will be blocking for long lines-->
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="false" />
				<SetValue Key="ruleCode" Value="" />
				<SetValue Key="Yokemounted" Value="False" />
			</Variant>
			<Variant Name="ERTMS E35 Stoppskilt, sidestilt med dverg" >
				<SetValue Key="type" Value="main" />
				<SetValue Key="function" Value="intermediate" /> <!--most marker boards with shunting signal will be intermediate signals -->
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="false" />
				<SetValue Key="ruleCode" Value="" />
				<SetValue Key="Yokemounted" Value="False" />
			</Variant>
			<Variant Name="ERTMS E35 Stoppskilt, sidestilt med lav dverg" >
				<SetValue Key="type" Value="main" />
				<SetValue Key="function" Value="intermediate" /> <!--most marker boards with shunting signal will be intermediate signals -->
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="false" />
				<SetValue Key="ruleCode" Value="" />
				<SetValue Key="Yokemounted" Value="False" />
			</Variant>
			<Variant Name="ERTMS E35 Stoppskilt, over sporet" >
				<SetValue Key="type" Value="main" />
				<SetValue Key="function" Value="intermediate" /> <!--most marker boards above track will be intermediate signals -->
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="false" />
				<SetValue Key="ruleCode" Value="" />
				<SetValue Key="Yokemounted" Value="True" />
			</Variant>
			<Variant Name="ERTMS E35 Stoppskilt, over sporet med dverg" >
				<SetValue Key="type" Value="main" />
				<SetValue Key="function" Value="intermediate" /> <!--most marker boards with shunting signal / above track will be intermediate signals -->
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="false" />
				<SetValue Key="ruleCode" Value="" />
				<SetValue Key="Yokemounted" Value="True" />
			</Variant>
			<Variant Name="ERTMS dverg" >
				<SetValue Key="type" Value="shunting" />
				<SetValue Key="function" Value="intermediate" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="false" />
				<SetValue Key="ruleCode" Value="" />
				<SetValue Key="Yokemounted" Value="False" />
			</Variant>
		</Variants>

		<SetValue Key="code" Value="Kode?" />
		
		<!-- Add Lua expressions from 'bnp' since these signals are physically just boards: -->
		<LuaExpression Name="PoleRouting3D" ><Formula>NOBN_bnp_getPoleRoutingDefaultValue()</Formula></LuaExpression>

		<LuaExpression Name="Offset3D.Z" ><Formula>_JBTSA_SIG_ertms_Offset3dZ(_position)</Formula></LuaExpression>
		<!-- '_position' is an intrinsic variable available to sampled Lua functions. -->
		<LuaFunction Name="_JBTSA_SIG_ertms_Offset3dZ" 
				ReturnType="Double"
				HideFromUser="false"
				Description="Returns the standard height of the board's pole." >
			<Constructor>Double _JBTSA_SIG_ertms_Offset3dZ(_position)</Constructor>
			<Formula>
				function _JBTSA_SIG_ertms_Offset3dZ(_position)
					
					if Variant == "ERTMS E35 Stoppskilt, sidestilt med dverg" then
						return Yokemounted and -3.2 or 1.9
					
					elseif Variant == "ERTMS E35 Stoppskilt, sidestilt med lav dverg" then
						return Yokemounted and -3.0 or 0.2
						
					elseif Variant == "ERTMS dverg" then
						return Yokemounted and -2.6 or 1.3

					else
						return Yokemounted and -3.0 or 3.3
					end
				end
			</Formula>
		</LuaFunction>

		<!-- 2020-11-05 CLFEY Deprecated - all ERTMS boards are now small, see BN document "NS-EN 16494_2015 ERTMS skilt" -->
		<!-- <CustomAttribute DataType="Enumeration" Name="Size" DisplayName="StÃ¸rrelse" DefaultValue="Large" -->
				<!-- Description="The 'Size' custom attribute [Large | Small] decides the board's size (Large:700x700, Small:400x400)." > -->
			<!-- <Value DisplayName="Lite" >Small</Value> -->
			<!-- <Value DisplayName="Stort" >Large</Value> -->
		<!-- </CustomAttribute> -->

		<LuaExpression Name="Model3DName" ><Formula>_JBTSA_SIG_ertms_model3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_ertms_model3DName()" ReturnType="String"
				HideFromUser="false"
				Description="Returns the 3D model name [String] for the current ERTMS board. Covers position/stop markerboards. See also JBTSA_ERP ERTMS boards." >
			<Constructor>String _JBTSA_SIG_ertms_model3DName()</Constructor>
			<Formula>
				function _JBTSA_SIG_ertms_model3DName()
					local t = "NO-BN-3D-SA-SIG-ERTMS"
					if Variant:match("E35")then
						t = t.."-E35"
					end
					if Variant:match("sidestilt") then
						t = t..(((RightSided and dir == "up") or (LeftSided and dir == "down")) and "-HSIDE" or "-VSIDE")
					end
					if Variant:match("over sporet") then
						t = t.."-OVER"
					elseif Variant:match("dverg") then 
						t = t.."-DS" 
					end
					if Variant:match("lav") then t = t.."-LAV" end
					return t
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject VariantName="ERTMS E35 Stoppskilt, sidestilt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ERTMS-E35-HSIDE-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="ERTMS E35 Stoppskilt, sidestilt med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ERTMS-E35-HSIDE-DS-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="ERTMS E35 Stoppskilt, sidestilt med lav dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ERTMS-E35-HSIDE-DS-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="ERTMS E35 Stoppskilt, over sporet" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ERTMS-E35-OVER-AAK-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="0.01" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="ERTMS E35 Stoppskilt, over sporet med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ERTMS-E35-OVER-DS-AAK-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="0.01" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="ERTMS dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-DS-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant contains 'sidestilt' %}
					{% if RightSided and dir == 'up' %}ERTMS-E35-HSIDE
					{% elsif LeftSided and dir == 'down' %}ERTMS-E35-HSIDE
					{% else %}ERTMS-E35-VSIDE
					{% endif %}
				{% elsif Variant contains 'over' %}ERTMS-E35-OVER
				{% endif %}
				{% if Variant contains 'dverg' %}DS{% endif %}
				{% if Yokemounted %}AAK{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />
		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<!-- Ingen displaypoints - 2D-symbolet settes der InsertionPoint er -->
	</ObjectType>



<!--========================================================================================================
	SIGNALING
	CLASS B SIGNALS (CONVENTIONAL)

	Lyssignaler pÃ¥ egen mast, mange varianter er mulig.
	Fungerer typisk som start & sluttpunkt for togveier og skifteveier.
	Inkluderer signal 66 Togvei Slutt og HÃ¸yt Skiftesignal.

	RailCOMPLETE modellering fÃ¸lger til en viss grad railML, pga eksport til railML.
	Denne teksten kan SLETTES nÃ¥r vi har gÃ¥tt helt bort fra railML 2.2 klasser og definert vÃ¥re
	egne klasser istedet, iht UIC sin RailTopoModel.
	2017-01-04 CLFEY TODO 'switchable' i tSignal er deprecated med railML 2.3, skal settes i sub-elements, som p.t. ikke er implementert i RC ennÃ¥.
  
	NB! En lengre tekst, med info om sammenheng RC - railML, ble fjernet herfra ved bygg ca 2018.21.180.
	Se ogsÃ¥: http://www.stellwerke.de/signal/deutsch/ne.html#ne5
================================================================================--> 

	<!-- Lua Model Check functions for 'JBTSA_SIG Signal' specific to NSI optical signals, with Lua code declared outside user's reach -->
	<LuaFunction Name="NOBN_sig_chkSafetyDistanceFromSignalToOcsMast()" ReturnType="String"
		Description="Checks whether Returns the formated short name extracted from a main/distant signal's Code, e.g. '4313UL' or 'UL4313' => '4313(UL)'." >
        <Constructor>String NOBN_sig_chkSafetyDistanceFromSignalToOcsMast()</Constructor>
        <Formula>
function NOBN_sig_chkSafetyDistanceFromSignalToOcsMast()
	local tolerance = 6 --Tolerance in meters

	--Preamble - called from a relevant object type?
	if      RcType ~= "JBTSA_ERT ERTMS-signal"
		and RcType ~= "JBTSA_SIG Signal"
		and RcType ~= "JBTSA_SIG Brusignal/Frostportsignal"
		and RcType ~= "SA-SIG Planovergang"
		and RcType ~= "JBTSA_SIG Veisignal"
	then 
		return "Bad signal type ["..RcType.."] (code='"..code.."'.",_warning
	end

	--Check if this test can be omitted (a low signal):
	local omit = true
	if Yokemounted then 
		omit = false

	elseif RcType == "JBTSA_ERT ERTMS-signal" then
		if Yokemounted then
			return "WARNING - Check manually that no OCS yoke is within safety distance from markerboard in yoke.",_warning
		else
			return "OK - Markerboard on the ground - Safety distance to OCS mast not relevant.",_ok
		end

	elseif RcType == "JBTSA_SIG Signal" then
		if HighShuntingSignal == "-" and MainSignal == "-" then 
			return "OK - Free-standing low signal - Safety distance to OCS mast not relevant.",_ok 
		end

	elseif RcType == "JBTSA_SIG Togsporsignal" then
		return "OK - Track signal (togsporsignal) - Safety distance to OCS mast not relevant.",_ok 
	end

	if not omit then
		local c1 = getNearbyPointObjects2D("JBTEH_MAS KL-mast", tolerance)
		local c2 = getNearbyPointObjects2D("JBTEH_MAS Hengemast for bru og tunnel", tolerance)
		local c3 = getNearbyPointObjects2D("JBTEH_MAS Hengemast i Ã¥k", tolerance)
		local closeObjects = getUnionOfCollections( getCollectionFromTable({c1,c2,c3}) )
		local count = getCollectionLength(closeObjects)
		local UpdateObjects = {}
		if count == 0 then 
			return "OK - No catenary mast within tolerance "..tolerance.." meters.",_ok
		else
			local i = 0
			local shortestDistance = math.huge
			local s = ": WARNING - Catenary mast"
			if (count &gt; 1) then s = s.."s" end
			s = s.." ["
			while i ~= count do
				d = RC__getDistance2D(closeObjects[i]) 
				if d &lt; shortestDistance then shortestDistance = d end
				s = s..closeObjects[i].code
				table.insert(UpdateObjects, closeObjects[i])
				i = i+1
				if i ~= count then s = s..", " end
			end
			s = s.."]"
			return string.format("%.03f: %s located inside horizontal tolerance %.3f meters.",shortestDistance,s,tolerance),UpdateObjects,_warning
		end
	end
end
		</Formula>
     </LuaFunction>
		
	
		
	<LuaFunction Name="NOBN_sig_chkDistanceFromSignalToTrack()" ReturnType="String"
		Description="Checks lateral distance from signal insertion point to closest track on left side (in the direction of increasing mileages). Call with argument 'Right' or 'Left'." >
        <Constructor>String NOBN_sig_chkDistanceFromSignalToTrack("Right" | "Left")</Constructor>
        <Formula>
			function NOBN_sig_chkDistanceFromSignalToTrack(side)
				side = side and side:lower() or "(no arg)"				
				if side ~= "left" and side ~= "right" then return "*** ERROR Function should be called with argument 'right' or 'left' ["..side.."]." end
				if Alignment == nil then return "UNFINISHED - Signal must first be assigned to an alignment to deduce its own direction." end
				if (DwarfSignal == "Ja" and MainSignal == "-" and Yokemounted) then return "WARNING - Shunting signal mounted in yoke. Please do manual check.",_warning end
--2021-01-12 CLFEY: No warning just if high above but outside lateral problem distance.
--if (RelativeElevation &gt; 0.3) then return "WARNING - Signal mounted outside normal elevations. Please do manual check.",_warning end
				tracks = getClosestAlignments("JBTKO_SPO Spor"):filter(function (x) return (side:upper() == "RIGHT" and 1 or -1) * getAlignmentInfo(x.id).DistanceToAlignment &lt; 0 end)
				if getCollectionLength(tracks) == 0 then return "OK - No tracks to the "..side..".",_ok end
				ai = getAlignmentInfo(tracks[0].id)
				curveRadius = ai.CurveRadius
				Ki = 0.0
				Ky = 0.0
				tolerance = 2.12
				--Many signals are covered with these formulas, but not all - use your insight wiesely:
				if (DwarfSignal ~= "-" and MainSignal == "-") then
					--Freestanding dwarf signal
					tolerance = tolerance + 0.25
				elseif MainSignal ~= "-" or DistantSignal ~= "-" then
					tolerance = tolerance + 0.4
				end
				distToAlignment = math.abs(ai.DistanceToAlignment)
				if (curveRadius ~= math.huge) then
					--Std Bane NOR approximation formulae:
					Ki = 81000.0/(2*curveRadius)
					Ky = 63000.0/(2*curveRadius)
				end
				if (ai.CurveRotation == "CCW") then 
					tolerance = tolerance + (Ky/1000.0)
				else
					tolerance = tolerance + (Ki/1000.0)
				end
				if (distToAlignment &lt;= tolerance) then
					return string.format("%.3f: ERROR - Signal too close to track '%s' w.r.t. tolerance %.3f.",
						distToAlignment,ai.AlignmentName,tolerance),_error
				elseif (distToAlignment &gt; tolerance and distToAlignment &lt;= (tolerance + 0.4)) then
					return string.format("%.3f: WARNING - Signal close to track '%s', less than 0.4 m from tolerance %.3f.",
						distToAlignment,ai.AlignmentName,tolerance),_warning
				else
					return string.format("%.3f: OK - Signal is far from track '%s' w.r.t. tolerance %.3f.",
						distToAlignment,ai.AlignmentName,tolerance),_ok
				end
			end
		</Formula>
     </LuaFunction>
		

	<!-- Included for backwards compatibility: -->
	<LuaFunction Name="NOBN_sig_chkLeftSideDistanceFromSignalToTrack()" ReturnType="String" Description="Checks lateral distance from signal insertion point to closest track on left side (in the direction of increasing mileages)." HideFromUser="false" >
		<Constructor>String NOBN_sig_chkLeftSideDistanceFromSignalToTrack()</Constructor>
		<Formula>
			function NOBN_sig_chkLeftSideDistanceFromSignalToTrack()
				return NOBN_sig_chkDistanceFromSignalToTrack("Left")
			end
		</Formula>
	</LuaFunction>
	
	<!-- Included for backwards compatibility: -->
	<LuaFunction Name="NOBN_sig_chkRightSideDistanceFromSignalToTrack()" ReturnType="String" Description="Checks lateral distance from signal insertion point to closest track on right side (in the direction of increasing mileages)." HideFromUser="false" >
		<Constructor>String NOBN_sig_chkRightSideDistanceFromSignalToTrack()</Constructor>
		<Formula>
			function NOBN_sig_chkRightSideDistanceFromSignalToTrack()
				return NOBN_sig_chkDistanceFromSignalToTrack("Right")
			end
		</Formula>
	</LuaFunction>


	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_SIG Signal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Klasse-B signaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		<AttachmentCategory Name="signal" />
			
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___YOKEMOUNTED" />
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />

		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalPartNames.." - "..code</Formula></LuaExpression> 


		<!-- Variant has been added solely to show the user something - it is not needed, since all signal items have this same Variant. -->
		<Variants DefaultValue="Sammensatt signal" >
			<Variant Name="Sammensatt signal" />
		</Variants>

		<CustomAttribute DataType="Enumeration" Name="Sunscreen" DisplayName="Bakgrunnsskjerm" DefaultValue="Ja" 
			Description="The 'Sunscreen' custom property [- | Ja] decides whether the signal has background screen ('Ja') or not ('-')." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="MainSignal" DisplayName="Hovedsignal" DefaultValue="-"
			Description="Bane NOR 1/2/3-lantern optical main signal.\n20a=*Red:Stop(entry/block)\n20b=Red:Stop(intermediate/exit)\n21(3-light main)=UpperGreen:Proceed with caution\n21(2-light main)=LowerGreen:Proceed with caution\n21(repeater)=UpperGreen:Proceed with caution\n22=UpperGreen+LowerGreen:Proceed." >
			<Values>
				<Value>-</Value>
				<Value>Hs1</Value>
				<Value>Hs2</Value>
				<Value>Hs3</Value>
				<Value>RepHs1</Value>
				<Value>RepHs2</Value>
			</Values>
		</CustomAttribute>
		
		<CustomAttribute DataType="Enumeration" Name="EndOfTrainRouteSignal" DisplayName="Togvei slutt" DefaultValue="-" 
			Description="Bane NOR S66 black/yellow board:End of train route movement authority (with or without an ensuing main signal)." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="DistantSignal" DisplayName="Forsignal" DefaultValue="-"  
			Description="Bane NOR 2-lantern optical distant signal.\n23=*Yellow:Stop ahead\n24=*Yellow/*Green:Reduced speed ahead\n25=*Green:Line speed ahead." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="DwarfSignal" DisplayName="Dvergsignal" DefaultValue="-" 
			Description="Bane NOR optical shunting signal.\n43=TwoHorizontalWhite:Shunting forbidden\n44=TwoSlantedWhite:Cautious shunting\n45=TwoVerticalWhite:Shunting allowed\n46a=OneWhite:local release\n46b=TwoBackslantedWhite:Local release." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="HighShuntingSignal" DisplayName="HÃ¸yt skiftesignal" DefaultValue="-"
			Description="Bane NOR High Shunting optical signal.\n41=SlantedWhiteLine:Cautious shunting with local release\n42=HorizontalWhiteLine:Shunting forbidden." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="PositionLamp" DisplayName="Middelkontrollampe" DefaultValue="-"
			Description="Bane NOR Position Lamp optical signal.\n.4C=*White:Last axle still occupying turnout section. Off:Trigger section not yet entered, or last axle not occupying turnout section anymore." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="CautiousDrivingSignal" DisplayName="Forsiktig kjÃ¸ring" DefaultValue="-"
			Description="Bane NOR Cautious Driving optical signal.\n32=White luminescent cross:Proceed with extra caution in train route (main signal shows Hs21, distant signal is shut off (Fs00)." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="LineSignal" DisplayName="Linjesignal" DefaultValue="-"
			Description="Bane NOR Line optical signal.\n35B=White luminescent letter:The signal shows a distinct letter representing one of several  destination lines." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="OpticalSpeedSignal" DisplayName="Lysende hastighetssignal" DefaultValue="-"
			Description="Bane NOR Deviating Speed optical signal.\n.68C=WhiteDigit(s):Allowed speed over deviating turnout or group of turnouts ahead." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="DepartureSignal" DisplayName="Avgangssignal" DefaultValue="-"
			Description="Bane NOR Departure signal.\nLuminous White letter 'A' on black background (permission to depart is granted)'." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="Enumeration" Name="BrakeTestSignal" DisplayName="BremseprÃ¸vesignal" DefaultValue="-"
			Description="Bane NOR Brake Test Signal.\n.Luminous letter 'T' (activate brake), 'L' (loosen brake) or dark (no action)." >
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomAttribute>

		<CustomAttribute DataType="String" ReadOnly="true" Category="Model check" Name="mc_SafetyDistanceFromSignalToOcsMast" DisplayName="Sikkerhetsavstand til KL" 
			Description="Below 6 meter: Warning â Signal is too close to OCS mast, a potential HVAC hazard for maintenance personnel.\nAbove 6 meter: OK â No known HVAC danger to personnel." />
		<CustomAttribute DataType="String" ReadOnly="true" Category="Model check" Name="mc_LeftSideDistanceFromSignalToTrack" DisplayName="Avstand til spor venstre"
			Description="Dwarf signal:\Below 2.37m: Error â Signal too close to track.\nFrom 2.37m to 2.77m: Warning â Within tolerance, potentially too close to track.\nAbove 2.77m: OK â Far enough from track.\n\nOther signals:\nBelow 2.52m: Error - Signal too close to track.\nFrom 2.52m to 2.92m: Warning - Within tolerance, potentially too close to track.\nAbove 2.92m: OK - Far enough from track.\n\nThe calculations take into account the nose/coach midpoint curvature extension." />
		<CustomAttribute DataType="String" ReadOnly="true" Category="Model check" Name="mc_RightSideDistanceFromSignalToTrack" DisplayName="Avstand til spor hÃ¸yre"
			Description="Dwarf signal:\Below 2.37m: Error â Signal too close to track.\nFrom 2.37m to 2.77m: Warning â Within tolerance, potentially too close to track.\nAbove 2.77m: OK â Far enough from track.\n\nOther signals:\nBelow 2.52m: Error - Signal too close to track.\nFrom 2.52m to 2.92m: Warning - Within tolerance, potentially too close to track.\nAbove 2.92m: OK - Far enough from track.\n\nThe calculations take into account the nose/coach midpoint curvature extension." />
		<CustomAttribute DataType="String" Name="LineSignalValue" DisplayName="Linjesignal signaltekst" DefaultValue="" />
		<CustomAttribute DataType="String" Name="OpticalSpeedSignalValue" DisplayName="Lysende hastighetssignal verdi" DefaultValue="" />
		
		<LuaExpression Name="mc_SafetyDistanceFromSignalToOcsMast" IsModelCheck ="true" ><Formula>NOBN_sig_chkSafetyDistanceFromSignalToOcsMast()</Formula></LuaExpression>
		<LuaExpression Name="mc_LeftSideDistanceFromSignalToTrack" IsModelCheck ="true" ><Formula>NOBN_sig_chkLeftSideDistanceFromSignalToTrack()</Formula></LuaExpression>
		<LuaExpression Name="mc_RightSideDistanceFromSignalToTrack" IsModelCheck ="true" ><Formula>NOBN_sig_chkRightSideDistanceFromSignalToTrack()</Formula></LuaExpression>

		<LuaExpression Name="Model3DName" ><Formula>_JBTSA_SIG_signal_model3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_signal_model3DName()" ReturnType="String"
				Description="Returns 3D Model Name for a Bane NOR NSI-63 type signal, based on CustomProperties such as Hovedsignal, Forsignal, Dvergsignal etc." >
			<Constructor>String _JBTSA_SIG_signal_model3DName()</Constructor>
			<Formula>
				function _JBTSA_SIG_signal_model3DName()
					--Ref. https://orv.banenor.no/orv/doku.php?id=tjn:Kapittel_8 fra "Bane NOR â Trafikkregler for jernbanenettet (TJN) â gyldig fra 16.6.2019. Endret 24.4.2019."
					--Ref LISP-code for NO-BN's 2D library, file "Signal combinations.lsp" ca line number 350 where the symbol's CAD block name is constructed.
					local t				
					t = "NO-BN-3D-SA-SIG-NSI63"
					if     (MainSignal == "RepHs1") then t = t.."-HSREP1" --RepHs 1-lys (Ã¸vre grÃ¸nn i 2-lysramme, blendet nedre lanterne) - uten kne, oppover-montering, f.eks. pÃ¥ vegg
					elseif (MainSignal == "RepHs2") then t = t.."-HSREP2" --RepHs 1-lys (to grÃ¸nne i 2-lysramme) - uten kne, oppover-montering, f.eks. pÃ¥ vegg
					elseif (MainSignal == "Hs1") then t = t.."-HS1" --Stopplykt, Hs20=Stopp=nedre rÃ¸d
					elseif (MainSignal == "Hs2") then t = t.."-HS2" --2-lys Hs, Hs20=Stopp=nedre rÃ¸d / Hs21=KjÃ¸r med redusert hast.=Ã¸vre grÃ¸nn
					elseif (MainSignal == "Hs3") then t = t.."-HS3" --3-lys Hs, Hs20=Stopp=nedre rÃ¸d / Hs21=KjÃ¸r med redusert hast.=Ã¸vre grÃ¸nn / Hs22=KjÃ¸r=Ãvre+nedre grÃ¸nn
					end
					if (DistantSignal ~= "-") then t = t.."-FS" end
					if (EndOfTrainRouteSignal ~= "-") then t = t.."-TVS" end --Togvei slutt signal 66, 'S'
					if (DwarfSignal ~= "-") then t = t.."-DS" end
					if (HighShuntingSignal ~= "-") then t = t.."-ZS" end --HÃ¸yt skiftesignal
					if (PositionLamp ~= "-") then t = t.."-MKS" end --Middelkontrollampe signal, hvit blinkende
					if (CautiousDrivingSignal ~= "-") then t = t.."-FKS" end
					if (LineSignal ~= "-") then t = t.."-LS" end --Linjesignal (het 'hovedlinjesignal' tidligere)
					if (OpticalSpeedSignal ~= "-") then t = t.."-LHS" end --Lysende HastighetsSignal, lysende 10-ere for en eller flere aspekter
					if (DepartureSignal ~= "-") then t = t.."-AVS" end --Avgangssignal
					if (BrakeTestSignal ~= "-") then t = t.."-BPS" end --BremseprÃ¸vesignal
					if Sunscreen == "-" then t = t.."-UTEN-SKJERM" end
					if Yokemounted then t = t.."-ÃK" end
					if KneeTowardsTrack then if KneeTowardsTrack ~= "-" then t = t..(RightSided and "-VKNE" or "-HKNE") end end
					if t:match("%-NSI63%-DS") and not t:match("ÃK") then t = t.."-2000" end --Add '-2000' pole total length to shunting signal if free-standing shunting signal
					return t
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject VariantName="FrittstÃ¥ende forsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-FS-{{SymbolMode}}"
				SubGroup="FrittstÃ¥ende Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="name" Value="Fs." />
			<SetValue Key="type" Value="distant" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="FrittstÃ¥ende Dvergsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-DS-{{SymbolMode}}"
				SubGroup="FrittstÃ¥ende Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="type" Value="shunting" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="FrittstÃ¥ende Dvergsignal med togvei slutt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TVS-DS-{{SymbolMode}}"
				SubGroup="FrittstÃ¥ende Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="EndOfTrainRouteSignal" Value="Ja" />
			<SetValue Key="type" Value="shunting" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="FrittstÃ¥ende Dvergsignal med middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-DS-MKS-{{SymbolMode}}"
				SubGroup="FrittstÃ¥ende Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="type" Value="shunting" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="FrittstÃ¥ende Dvergsignal med middelkontroll og togvei slutt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TVS-DS-MKS-{{SymbolMode}}"
				SubGroup="FrittstÃ¥ende Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="EndOfTrainRouteSignal" Value="Ja" />
			<SetValue Key="type" Value="shunting" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="1-lys stopplykt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS1-{{SymbolMode}}"
				SubGroup="FrittstÃ¥ende Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs1" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="1-lys Rep. hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS1-{{SymbolMode}}"
				SubGroup="FrittstÃ¥ende Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="RepHs1" />
			<SetValue Key="type" Value="repeater" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="2-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys Rep. hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" 
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="RepHs2" />
			<SetValue Key="type" Value="repeater" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
			<SetValue Key="Model3DName" Value="NO-BN-3D-SA-SIG-NSI63-HS-2-LYS-REP" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg og forsiktig kjÃ¸ring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-FKS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg, forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-FKS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg, middelkontroll og forsiktig kjÃ¸ring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-FKS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg, middelkontroll, forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-FKS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal dverg og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-LS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal dverg, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-LS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg, middelkontroll og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-LS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="2-lys hovedsignal med dverg, middelkontroll, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-LS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="3-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="3-lys hovedsignal med linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-LS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="3-lys hovedsignal med linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-LS-LHS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="3-lys hovedsignal med lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-LHS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="3-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-{{SymbolMode}}" 
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="3-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-LHS-{{SymbolMode}}" 
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="3-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-MKS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="3-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="main" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="4-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="4-lys hovedsignal med middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-MKS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-MKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>	
		
		<InsertPointObject VariantName="4-lys hovedsignal med forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-FKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-LS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>	

		<InsertPointObject VariantName="4-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="4-lys hovedsignal med dverg, middelkontroll og forsiktig kjÃ¸ring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-FKS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg, middelkontroll, forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-FKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg, forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-FKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg, middelkontroll og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-LS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="4-lys hovedsignal med dverg, middelkontroll, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-LS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs2" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="5-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-MKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-MKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="5-lys hovedsignal med forsiktig kjÃ¸ring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-FKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-FKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="5-lys hovedsignal med linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="LineSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="5-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="5-lys hovedsignal med dverg og forsiktig kjÃ¸ring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="5-lys hovedsignal med dverg, middelkontroll og forsiktig kjÃ¸ring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-FKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, middelkontroll og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="Linjesignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, middelkontroll, forsiktig kjÃ¸ring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-FKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, middelkontroll, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="PositionLamp" Value="Ja" />
			<SetValue Key="Linjesignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, forsiktig kjÃ¸ring og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="Linjesignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, forsiktig kjÃ¸ring, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="CautiousDrivingSignal" Value="Ja" />
			<SetValue Key="Linjesignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="Linjesignal" Value="Ja" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="5-lys hovedsignal med dverg, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="MainSignal" Value="Hs3" />
			<SetValue Key="DistantSignal" Value="Ja" />
			<SetValue Key="DwarfSignal" Value="Ja" />
			<SetValue Key="Linjesignal" Value="Ja" />
			<SetValue Key="OpticalSpeedSignal" Value="Ja" />
			<SetValue Key="type" Value="combined" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<!-- Note: EnableDirectionSetting=="true" in element InsertPointObject (enable keybd shortcut for direction flipping up/down), so RC adds 180 DD to the 'down' direction: -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
			NO-BN-2D-JBTSA_SIG-SIGNAL
			{% if MainSignal == 'Hs1' or MainSignal == 'RepHs1' %}HS1
			{% elsif MainSignal == 'Hs2' or MainSignal == 'RepHs2' %}HS2
			{% elsif MainSignal == 'Hs3' %}HS3
			{% endif %}
			{% if DistantSignal == 'Ja' %}FS{% endif %}
			{% if EndOfTrainRouteSignal == 'Ja' %}TVS{% endif %}
			{% if DwarfSignal == 'Ja' %}DS{% endif %}
			{% if HighShuntingSignal == 'Ja' %}ZS{% endif %}
			{% if PositionLamp == 'Ja' %}MKS{% endif %}
			{% if CautiousDrivingSignal == 'Ja' %}FKS{% endif %}
			{% if LineSignal == 'Ja' %}LS{% endif %}
			{% if OpticalSpeedSignal == 'Ja' %}LHS{% endif %}
			{% if BrakeTestSignal == 'Ja' %}BPS{% endif %}
			{% if DepartureSignal == 'Ja' %}AVS{% endif %}
			{% if Yokemounted %}AAK{% endif %}
			{{SymbolMode}}
			</BlockNameFormat>
			
			<SymbolAttribute Tag="LS" >
				<Value>{{LineSignalValue}}</Value>
			</SymbolAttribute>
			
			<SymbolAttribute Tag="LHS" >
				<Value>{{OpticalSpeedSignalValue}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament" />
			</SnapPoints>
		</DockPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Togsporsignal
	Togsporsignal pÃ¥ egen mast eller pÃ¥ vegg eller i Ã¥k
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_SIG Togsporsignal"
				Layer="JBTSA_SIG" Color="ByLayer" 
				Group="Signal/Hjelpesignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>signal</RelationSpace>
		<AttachmentCategory Name="signal" />
		<AttachTo Category="stolpe_med_fot" />
		<AttachTo Category="signal" />

		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___YOKEMOUNTED" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />

		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalFullName()</Formula></LuaExpression> 


		<Variants DefaultValue="Togsporsignal" >
			<Variant Name="Togsporsignal 1-begrep" >
			</Variant>
			<Variant Name="Togsporsignal 1-begrep, sidestilt" >
			</Variant>
			<Variant Name="Togsporsignal 2-begrep" >
			</Variant>
			<Variant Name="Togsporsignal 2-begrep, sidestilt" >
			</Variant>
		</Variants>

		<LuaExpression Name="name" ><Formula>"Tsp."..code</Formula></LuaExpression>

		<LuaExpression Name="Model3DName" ><Formula>_JBTSA_SIG_Togsporsignal_Model3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_Togsporsignal_Model3DName()" ReturnType="String" HideFromUser="false"
			Description="" >
			<Constructor>String _JBTSA_SIG_Togsporsignal_Model3DName()</Constructor>
			<Formula>
				function _JBTSA_SIG_Togsporsignal_Model3DName()
					local t = "NO-BN-3D-SA-SIG-NSI63-TSS"
					if Variant == "Togsporsignal 1-begrep" then
						return t.."-TOGSPORSIGNAL-HODE" 
					elseif Variant == "Togsporsignal 1-begrep, sidestilt" then
						if RightSided then
							return (dir == 'up') and t.."-H" or t.."-V"
						else
							return (dir == 'up') and t.."-V" or t.."-H"
						end
					elseif Variant == "Togsporsignal 2-begrep" then
						return t.."-HV" 
					elseif Variant == "Togsporsignal 2-begrep, sidestilt" then
						return t.."-HV"  --User must adjust sideways 3D offset towards track and add Pole Routing himself
					else 
						return "Unrecognized variant ["..Variant.."], cannot determine 3D Model Name.",_warning
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="Offset3D.Z" >
			<Formula>
				local d = (Variant:find("sidestilt") or Variant:find("2%-begrep")) and 0.15 or 0 --juster litt ned hvis signalet har arm(er)
				local a = Attachment
				if a then
					if a.Variant:find(" 1.6m") then return 0.690 - d
					elseif a.Variant:find(" 2m") then return 1.090 - d 
					elseif a.Variant:find(" 3m") then return 2.090 - d
					elseif a.Variant:find(" 3.2m") then return 2.290 - d
					else return 1.090 - d
					end
				else 
					return 1.090 - d --Standard Ã76 stolpe er 2m hÃ¸y
				end
			</Formula>
		</LuaExpression>

		<InsertPointObject VariantName="Togsporsignal 1-begrep" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-1-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:togsporSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="Togsporsignal 2-begrep" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:togsporSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="Togsporsignal 1-begrep, sidestilt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-3-VSIDE-{{SymbolMode}}" 
				AskForAttachment="true"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="type" Value="other:togsporSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="Togsporsignal 2-begrep, sidestilt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-4-VSIDE-{{SymbolMode}}"
				AskForAttachment="true"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="type" Value="other:togsporSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
     													    
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL
				{%    if Variant == 'Togsporsignal 1-begrep' %}1
				{% elsif Variant == 'Togsporsignal 2-begrep' %}2
				{% elsif Variant == 'Togsporsignal 1-begrep, sidestilt' %}
					{% if RightSided  %}
						{% if dir == 'up' %}3-HSIDE
						{% else %}3-VSIDE
						{% endif %}
					{% else  %}
						{% if dir == 'up' %}3-VSIDE
						{% else %}3-HSIDE
						{% endif %}
					{% endif %}
				{% elsif Variant == 'Togsporsignal 2-begrep, sidestilt' %}
					{% if RightSided  %}
						{% if dir == 'up' %}4-HSIDE
						{% else %}4-VSIDE
						{% endif %}
					{% else  %}
						{% if dir == 'up' %}4-VSIDE
						{% else %}4-HSIDE
						{% endif %}
					{% endif %}
				{% else %}BAD_Variant
				{% endif %}
				{% if Yokemounted %}AAK{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="stolpe_med_fot" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	SA-SIG HÃ¸yt skiftesignal pÃ¥ egen mast
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_SIG HÃ¸yt skiftesignal, frittstÃ¥ende" 
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Hjelpesignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		<AttachmentCategory Name="signal" />

		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___YOKEMOUNTED" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />
		
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalFullName()</Formula></LuaExpression> 


		<Variants DefaultValue="FrittstÃ¥ende HÃ¸yt Skiftesignal" >
			<Variant Name="FrittstÃ¥ende HÃ¸yt Skiftesignal" >
			</Variant>
			<Variant Name="FrittstÃ¥ende HÃ¸yt Skiftesignal med Middelkontroll" >
			</Variant>
			<!--pÃ¥ egen kabelplan se https://trv.jbv.no/wiki/Felles_bestemmelser/Definisjoner,_forkortelser_og_symboler#Symboler_for_Bruer-->
		</Variants>

		<LuaExpression Name="Model3DName" ><Formula>_JBTSA_SIG_HoeytSkiftesignal_Model3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_HoeytSkiftesignal_Model3DName()" ReturnType="String" HideFromUser="false"
			Description="Returns the 3D model name for a High Shunting signal." >
			<Constructor>String _JBTSA_SIG_HoeytSkiftesignal_Model3DName()</Constructor>
			<Formula>
				function _JBTSA_SIG_HoeytSkiftesignal_Model3DName()
					if Variant == "FrittstÃ¥ende HÃ¸yt Skiftesignal" then
						return "NO-BN-3D-SA-SIG-NSI63-ZS" --Use ZS2 to show also signals Ss41 (horizontal line)
					elseif Variant == "FrittstÃ¥ende HÃ¸yt Skiftesignal med Middelkontroll" then
						return "NO-BN-3D-SA-SIG-NSI63-ZS-MKS" --Use ZS2 to show also signals Ss41 (horizontal line)
					else 
						return "Unrecognized variant ["..Variant.."], cannot determine 3D Model Name.",_warning
					end
				end
			</Formula>
		</LuaFunction>
				   
		<InsertPointObject VariantName="FrittstÃ¥ende HÃ¸yt Skiftesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-41-HÃYT-SKIFTESIGNAL-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:hoeytSkifteSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="FrittstÃ¥ende HÃ¸yt Skiftesignal med Middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-41-HÃYT-SKIFTESIGNAL-MKS-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:hoeytSkifteSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
			<SetValue Key="Yokemounted" Value="False" />
		</InsertPointObject>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'FrittstÃ¥ende HÃ¸yt Skiftesignal' %}41-HÃYT-SKIFTESIGNAL
				{% elsif Variant == 'FrittstÃ¥ende HÃ¸yt Skiftesignal med Middelkontroll' %}41-HÃYT-SKIFTESIGNAL-MKS
				{% else %}BAD_Variant
				{% endif %}
				{% if Yokemounted %}AAK{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament" />
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Rasvarslingssignal (med dobbel 's'...)
	Bygges som vanlig 3-lys Hs. 
	Merk: Det er i RC ikke et eget "Rasvarslingssignal" med "R" i ring i firkant. Det forutsettes at et R-skilt attaches til R-signalet.
	Signalbilder:
		Signal 59 To blinkende gule oppe/nede = "Rasfare" - Tog skal stoppe ved rasvarslingsstolpen.
		Signal 56C Blinkende hvit midtre = "Tog kan passere rasfarestrekningen".
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_SIG Rasvarslingssignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Hjelpesignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		<AttachmentCategory Name="signal" />

		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___YOKEMOUNTED" />
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />
		
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalFullName()</Formula></LuaExpression> 


		<Variants DefaultValue="Rasvarslingssignal" >
			<Variant Name="Rasvarslingssignal" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-SA-SIG-NSI63-RASVARSLING" />
			</Variant>
		</Variants>
	
		<InsertPointObject VariantName="Rasvarslingssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:rasvarslingsSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'Rasvarslingssignal' %}HS3
				{% else %}BAD_Variant
				{% endif %}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament" />
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Brusignal/Frostportsignal
	Bygges som vanlig 3-lys Hs. 
	Signalbilder:
		Signal 20C To blinkende rÃ¸de Ã¸ver/nedre = "Stopp" - Tog og skift skal stoppe foran signalet.
		Signal 56D Blinkende hvit midtre = "Klar linje" - Tog og skift kan passere signalet og kjÃ¸rer over bevegelig bru eller forbi Ã¥pen frostport.
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_SIG Brusignal/Frostportsignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Hjelpesignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		<AttachmentCategory Name="signal" />

		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___YOKEMOUNTED" />
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />
		
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalFullName()</Formula></LuaExpression> 


		<Variants DefaultValue="Brusignal/Frostportsignal" >
			<Variant Name="Brusignal/Frostportsignal" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-SA-SIG-NSI63-BRU-OG-FROSTPORTSIGNAL" />
			</Variant>
			<!--pÃ¥ egen kabelplan se https://trv.jbv.no/wiki/Felles_bestemmelser/Definisjoner,_forkortelser_og_symboler#Symboler_for_Bruer-->
		</Variants>
	
		<InsertPointObject VariantName="Brusignal/Frostportsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:broSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'Brusignal/Frostportsignal' %}20-HS3
				{% else %}BAD_Variant
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament" />
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Planovergangssignal (med dobbel 's'...)
	Bygges som 2-lys signal med vanlig 2-lys ramme men med avrundet bakgrunnsskjerm.
	Signalbilder:
		PLO: Signal 55 RÃ¸dt blinkende lys Ã¸vre = "Stopp foran planovergangen" - Tog og skift skal stoppe foran planovergangen.
		PLO: Signal 56A Hvitt blinkende lys nedre = "Planovergangen kan passeres" - Tog og skift kan passere planovergangen.
		PLO-Fs: Signal 57 Fiolett blinkende lys Ã¸vre = "Planovergangssignalet viser stopp foran planovergangen"
			- Toget skal redusere hastigheten slik at toget kan stoppe foran planovergangssignalet. TilhÃ¸rende
			planovergangssignal viser signal 55 Â«Stopp foran planovergangen".
		PLO-Fs: Signal 56B Hvitt blinkende lys nedre = "Â«Planovergangssignalet viser at planovergangen kan passeresÂ»"
			- Toget kan fortsette med stÃ¸rste tillatte hastighet. TilhÃ¸rende planovergangssignal viser signal 56 Â«Planovergangen kan passeresÂ».
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_SIG Planovergangssignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Veibomanlegg"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		<AttachmentCategory Name="signal" />

		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___YOKEMOUNTED" />
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />
		
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalFullName()</Formula></LuaExpression> 


		<Variants DefaultValue="Planovergang, signal" >
			<Variant Name="Planovergang, signal" />
			<Variant Name="Planovergang, forsignal" />
		</Variants>

		<LuaExpression Name="Model3DName" ><Formula>_JBTSA_SIG_Planovergangssignal_Model3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_Planovergangssignal_Model3DName()" ReturnType="String" HideFromUser="false"
			Description="Returns the 3D model name for a Level Crossing signal (towards track)." >
			<Constructor>String _JBTSA_SIG_Planovergangssignal_Model3DName()</Constructor>
			<Formula>
				function _JBTSA_SIG_Planovergangssignal_Model3DName()
					local t = "NO-BN-3D-SA-SIG-NSI63-W-PLANOVERGANG"
					if Variant == "Planovergang, signal" then
						return t.."-SIGNAL"
					elseif Variant == "Planovergang, forsignal" then
						return t.."-FORSIGNAL"
					else 
						return "Unrecognized variant ["..Variant.."], cannot determine 3D Model Name.",_warning
					end
				end
			</Formula>
		</LuaFunction>
		
		<InsertPointObject VariantName="Planovergang, signal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:planovergangsSignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<InsertPointObject VariantName="Planovergang, forsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="type" Value="other:planovergangForsignal" />
			<SetValue Key="switchable" Value="true" />
			<SetValue Key="virtual" Value="false" />
			<SetValue Key="ruleCode" Value="" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'Planovergang, signal' %}20-HS2
				{% elsif Variant == 'Planovergang, forsignal' %}20-HS2
				{% else %}BAD_Variant
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament" />
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	VEIBOMANLEGG
	JBTSA_SIG Veisignal
	FrittstÃ¥ende, mot biltrafikk
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" Name="JBTSA_SIG Veisignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Veibomanlegg"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal_mot_vei</RelationSpace>
		<AttachmentCategory Name="signal_mot_vei" PassAttachmentToTarget="true" />
		
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />

		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_SIG" />
		<xpp:expand select="NOBN_com_PSET_HOV_ID" />

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalFullName()</Formula></LuaExpression> 


		<Variants DefaultValue="Veisignal" >
			<Variant Name="Veisignal/Enkelt signal mot vei" >
				<SetValue Key="name" Value="V.(enkeltspor)" />
				<!-- TODO 3D modell for Veisignal for planovergang -->
				<SetValue Key="Model3DName" Value="NO-BN-3D-FE-DIV-UKJENT" />
			</Variant>
			<Variant Name="Veisignal/Dobbelt signal mot vei" >
				<!-- TODO 3D modell for Veisignal for planovergang -->
				<SetValue Key="Model3DName" Value="NO-BN-3D-FE-DIV-UKJENT" />
				<SetValue Key="name" Value="V.(flerspor)" />
			</Variant>
		</Variants>

		<InsertPointObject VariantName="Veisignal/Enkelt signal mot vei" DisplayName="Planovergang/Enkelt signal mot vei" 
				DisplayBlockName="NO-BN-2D-JBTSA_SIG-VEISIGNAL-1-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="6.0" >
			<OwnAlignmentTargetSpace>vei</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Veisignal/Dobbelt signal mot vei" DisplayName="Planovergang/Dobbelt signal mot vei"
				DisplayBlockName="NO-BN-2D-JBTSA_SIG-VEISIGNAL-2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="6.0" >
			<OwnAlignmentTargetSpace>vei</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_SIG-VEISIGNAL
				{% if Variant == 'Veisignal/Enkelt signal mot vei' %}1
				{% elsif Variant == 'Veisignal/Dobbelt signal mot vei' %}2
				{% else %}BAD_Variant
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament" />
			</SnapPoints>
		</DockPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SIGNAL
	AUXILIARY SIGNALS
=========================================================================================================-->
	<!-- TODO Definere frittstÃ¥ende bremseprÃ¸vesignal, frittstÃ¥ende lysende sporvekselsignal / kryssvekselsignal, frittstÃ¥ende avgangssignal (finnes de??) -->



<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

<!--========================================================================================================

    NO-BN-Signals.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml"/>.

	Copyright (c) 2015-2024 Railcomplete AS, Norway, NO916118503
	
=========================================================================================================-->
<xpp:bloc>



<!--========================================================================================================
	sig - Signalling Lua formulas for signals (for other signalling objects: see other DNA file).
	Domain-specific Lua functions, stored in Global Extension Dictionary (not in each object).
=========================================================================================================-->
    <LuaFunction Name="NOBN_sig_getSignalNumber()" ReturnType="String"
		Description="Returns the number extracted from the signal's Code, e.g. '4313UL' or 'UL4313' or '4313' => '4313'.">
        <Signature>String NOBN_sig_getSignalNumber(tSignal s)</Signature>
		<Formula>
			function NOBN_sig_getSignalNumber(s)
				if s == nil then s = getObjectFromId(id) end -- Assume object really IS a signal...
				local c = tostring(s.code)
				if c == nil then return "" end
				if c:match("%d+%D+") then
					-- digits + nondigits:
					return c:match("%d+%D+"):match("%d+")
				elseif c:match("%D+%d+") then
					-- nondigits + digits:
					return c:match("%D+%d+"):match("%d+")
				elseif c:match("%d+") then
					-- just digits:
					return c:match("%d+")
				else
					-- just nondigits, or empty:
					return ""
				end
			end
		</Formula>
    </LuaFunction>
    


    <LuaFunction Name="NOBN_sig_getSignalLitra()" ReturnType="String"
		Description="Returns the litra extracted from the signal's Code, e.g. '4313UL' or 'UL4313' or 'UL' => 'UL'.">
        <Signature>String NOBN_sig_getSignalLitra(tSignal s)</Signature>
        <Formula>
			function NOBN_sig_getSignalLitra(s)
				if s == nil then s = getObjectFromId(id) end -- Assume object really IS a signal...
				local c = tostring(s.code)
				if c == nil then return "" end
				if c:match("%d+%D+") then
					-- digits + nondigits:
					return c:match("%d+%D+"):match("%D+")
				elseif c:match("%D+%d+") then
					-- nondigits + digits:
					return c:match("%D+%d+"):match("%D+")
				elseif c:match("%D+") then
					-- just nondigits:
					return c:match("%D+")
				else
					-- just digits, or empty:
					return ""
				end
			end
		</Formula>
    </LuaFunction>
	

	
	<LuaFunction Name="NOBN_sig_getSignalShortName()" ReturnType="String"
		Description="Returns the formated short name extracted from a main/distant signal's Code, e.g. '4313UL' or 'UL4313' => '4313(UL)'.">
        <Signature>NOBN_sig_getSignalShortName()</Signature>
        <Formula>
			function NOBN_sig_getSignalShortName()
				if NOBN_sig_getSignalLitra() == "" then 
					return NOBN_sig_getSignalNumber()
				else
					return NOBN_sig_getSignalLitra().."("..NOBN_sig_getSignalNumber()..")"
				end
			end
		</Formula>
    </LuaFunction>


	 
    <LuaFunction Name="NOBN_sig_getSignalFullName()" ReturnType="String"
		Description="Returns the elaborate name of the signal, formated according to Bane NOR standard practice.">
        <Signature>String NOBN_sig_getSignalFullName()</Signature>
        <Formula>
function NOBN_sig_getSignalFullName()
	local t
	if RcType == rctype_SignErtmsMarkerBoard then t = "Mb."
		
	elseif RcType == rctype_SignErtmsShuntingSignal then return "EDs.R"..NOBN_sig_getSignalNumber()
	
	elseif RcType == rctype_SignErtmsElectrificationBoard then
		if Variant == "E65H Lowering of pantograph, announcement" then t = "E65H"
		elseif Variant == "E65J Lowering of pantograph, location" then t = "E65J"
		elseif Variant == "E65K Raising of pantograph, location" then t = "E65K"
		elseif Variant == "E65L Dead section, announcement" then t = "E65L"
		elseif Variant == "E65M Disconnection in dead section" then t = "E65M"
		elseif Variant == "E65N Connection after dead section" then t = "E65N"
		end
		
	elseif RcType == rctype_SignErtmsTemporarySpeedRestrictionBoard then
		if Variant == "E200 Speed restriction lifted" then t = "E200"
		elseif Variant == "E201 Speed restriction 10" then t = "E201"
		elseif Variant == "E202 Speed restriction 20" then t = "E202"
		elseif Variant == "E203 Speed restriction 30" then t = "E203"
		end
	
	elseif RcType == rctype_SignErtmsMiscBoard then
		if Variant == "E36A Level crossing, location" then t = "E36"
		elseif Variant == "E36B Level crossing, announcement" then t = "E36"
		elseif Variant == "E37A Level transition" then t = "E37A"
		elseif Variant == "E37B Level zero" then t = "E37B"
		elseif Variant == "E38 Avalanche area" then t = "E38"
		elseif Variant == "E39 Frost gate" then t = "E39"
		elseif Variant == "E106 Stop for shunting" then t = "E106"
		elseif Variant == "E107 Unsecured area with handoperated points" then t = "E107"
		elseif Variant == "E204 GSM-R network Norway" then t = "E204"
		end
	
	elseif RcType == rctype_Signal then
		if (MainSignal == "Hs1") then
			t = "Stopplykt"
		elseif (MainSignal == "RepHs1" or MainSignal == "RepHs2") then 
			t = "Rep.Hs."
		elseif (MainSignal ~= "-") then 
			t = "Hs."
		elseif (DistantSignal ~= "-") then
			t = "Fs."
		elseif (EndOfTrainRouteSignal ~= "-") then
			t = "S66."
		elseif (DwarfSignal ~= "-") then
			return "Ds.R"..NOBN_sig_getSignalNumber()
		elseif (HighShuntingSignal ~= "-") then
			return "Z."..code
		else
			t = "Sig." --Covers all the remaining - MKs, FKs, Ls, LHs, AVs, BPs
		end
	
	elseif RcType == rctype_FictitiousSignal then
		t = "Fik."
		if Variant == "Viapunkt for betjeningsanlegg" then return t..code
		elseif Variant == "Fiktivt sluttpunkt for togvei" then return t..NOBN_sig_getSignalShortName().." (HTv)"
		elseif Variant == "Fiktivt sluttpunkt for skiftevei" then return t..NOBN_sig_getSignalShortName().." (DTv)"
		elseif Variant == "Fiktivt sluttpunkt for togvei og skiftevei" then return t..NOBN_sig_getSignalShortName().." (HTv/DTv)"
		else 
			return t..NOBN_sig_getSignalShortName().." (Unrecognized variant ["..Variant.."])",_warning  
		end

	elseif RcType == rctype_TrackSignal then
		t = "Tsp."..code
		
	elseif RcType == rctype_BridgeAndFrostDoorSignal then
		t = "Brusignal/Frostportsignal"..code
		
	elseif RcType == rctype_AvalancheSignal then
		t = "Rasvarslingssignal "..code
		
	elseif RcType == rctype_LevelCrossingSignalTowardsRoad then
		t = "Veisignal "..code
		
	elseif RcType == rctype_LevelCrossingSignalTowardsRail then
		t = (Variant:match("forsignal") and "PLO-Fs." or "PLO.")..code

	else
		t = "Bad signal type ["..RcType.."] (code='"..code.."').",_warning
	end
	return t..NOBN_sig_getSignalShortName()
end
		</Formula>
     </LuaFunction>


	 
    <LuaFunction Name="NOBN_sig_getSignalPartNames()" ReturnType="String"
		Description="Returns the signal component names, formated according to Bane NOR standard practice.">
        <Signature>String NOBN_sig_getSignalPartNames()</Signature>
        <Formula>
function NOBN_sig_getSignalPartNames()
	local s = ""
	local errMsg = "*** Unrecognized signal configuration ***"
	if RcType == rctype_SignErtmsMarkerBoard then 
		s = "E35"
		
	elseif RcType == rctype_SignErtmsShuntingSignal then 
		s = "EDS"
		
	elseif RcType == rctype_SignErtmsElectrificationBoard then
		if Variant == "E65H Lowering of pantograph, announcement" then t = "E65H"
		elseif Variant == "E65J Lowering of pantograph, location" then t = "E65J"
		elseif Variant == "E65K Raising of pantograph, location" then t = "E65K"
		elseif Variant == "E65L Dead section, announcement" then t = "E65L"
		elseif Variant == "E65M Disconnection in dead section" then t = "E65M"
		elseif Variant == "E65N Connection after dead section" then t = "E65N"
		end
		
	elseif RcType == rctype_SignErtmsTemporarySpeedRestrictionBoard then
		if Variant == "E200 Speed restriction lifted" then t = "E200"
		elseif Variant == "E201 Speed restriction 10" then t = "E201"
		elseif Variant == "E202 Speed restriction 20" then t = "E202"
		elseif Variant == "E203 Speed restriction 30" then t = "E203"
		end
		
	elseif RcType == rctype_SignErtmsMiscBoard then
		if Variant == "E36A Level crossing, location" then t = "E36"
		elseif Variant == "E36B Level crossing, announcement" then t = "E36"
		elseif Variant == "E37A Level transition" then t = "E37A"
		elseif Variant == "E37B Level zero" then t = "E37B"
		elseif Variant == "E38 Avalanche area" then t = "E38"
		elseif Variant == "E39 Frost gate" then t = "E39"
		elseif Variant == "E106 Stop for shunting" then t = "E106"
		elseif Variant == "E107 Unsecured area with handoperated points" then t = "E107"
		elseif Variant == "E204 GSM-R network Norway" then t = "E204"
		end
		
	elseif RcType == rctype_Signal then
		if (MainSignal ~= "-") then s = s..MainSignal:upper() end
		if (DistantSignal ~= "-") then s = s.."-FS" end
		if (EndOfTrainRouteSignal ~= "-") then s = s.."-TVS" end
		if (DwarfSignal ~= "-") then s = s.."-DS" end
		if (HighShuntingSignal ~= "-") then s = s.."-ZS" end
		if (PositionLamp ~= "-") then s = s.."-MKS" end
		if (CautiousDrivingSignal ~= "-") then s = s.."-FKS" end
		if (LineSignal ~= "-") then s = s.."-LS" end
		if (OpticalSpeedSignal ~= "-") then s = s.."-LHS" end
		if (DepartureSignal ~= "-") then s = s.."-AVS" end
		if (BrakeTestSignal ~= "-") then s = s.."-BPS" end
		--TODO: More complete check of unrecognized combination
	elseif RcType == rctype_TrackSignal then
		s = "Togsporsignal"
	elseif RcType == rctype_BridgeAndFrostDoorSignal then
		s = "Brusignal/Frostportsignal"
	elseif RcType == rctype_AvalancheSignal then
		s = "Rasvarslingssignal"
	elseif RcType == rctype_LevelCrossingSignalTowardsRoad then
		s = "Veisignal"   
	elseif RcType == rctype_LevelCrossingSignalTowardsRail then
		s = "Planovergangssignal"
	elseif RcType == rctype_FictitiousSignal then
		s = "Fiktivt punkt"
	else
		s = "Bad signal type ["..RcType.."].",_warning
	end
	if s:match("^-.+") then s = s:sub(2) end --Strip off leading dash character '-', if any
	return s
end	 

return NOBN_sig_getSignalPartNames()
		</Formula>
     </LuaFunction>


<!--========================================================================================================
	SIGNALLING
	FICTITIOUS SIGNALS
	Start / end point for train movelements and shunting movements, or via point when setting train routes.
	For use with interlockings, ATP and dispatching.
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_FictitiousSignal" Name="JBTSA_FIK Fiktivt punkt"
				Layer="JBTSA_FIK" Color="ByLayer"
				Group="Signal/Fiktive punkter"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>signal</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED"/> -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<!-- <xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" /> --> <!-- Only contains 3d properties, but this object doesn't have 3d knhel 2023-05-09 -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE"/>

		<Variants>
			<Variant Name="Viapunkt for betjeningsanlegg">
			</Variant>
			<Variant Name="Fiktivt sluttpunkt for togvei">
			</Variant>
			<Variant Name="Fiktivt sluttpunkt for skiftevei">
			</Variant>
			<Variant Name="Fiktivt sluttpunkt for togvei og skiftevei">
			</Variant>
		</Variants>

		<InsertPointObject Name="Viapunkt for betjeningsanlegg" DisplayBlockName="NO-BN-2D-JBTSA_FIK-VIAPUNKT-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Fiktivt sluttpunkt for togvei" DisplayBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Fiktivt sluttpunkt for skiftevei" DisplayBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Fiktivt sluttpunkt for togvei og skiftevei" DisplayBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true"/>
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_FIK-FIKTIVT-SLUTTPUNKT-{{SymbolMode}}" AllowSymbolMove="true">
			<Rotation Add180DegreesIfDirIsDown="true"/>
			<BlockNameFormat JoinBy="-">
			NO-BN-2D-JBTSA_FIK
			{% if Variant == 'Viapunkt for betjeningsanlegg' %}VIAPUNKT
			{% else %}FIKTIVT-SLUTTPUNKT
			{% endif %}
			{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>
	</ObjectType>



<!--========================================================================================================
	SIGNALLING
	ERTMS MARKER BOARD
=========================================================================================================-->
	<!-- ERTMS marker boards boards with pole. 2D symbols feature the "pole foot". -->
	<!-- Note: The other ERTMS boards have been classified as 'JBTSA_MSS ERTMS skilt' boards. -->
	<!-- 2021-01-11 CLFEY TODO Check if Bane NOR decides to use E34 "Location signal" (stedssignal, black arrow on white): -->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_SignErtmsMarkerBoard" Name="JBTSA_ERT ERTMS Marker board"
				Layer="JBTSA_ERT" Color="ByLayer"
				Group="Signal/Klasse-A signaler (ERTMS)"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
		<AttachmentCategory Name="ertms_marker_board" PassAttachmentToTarget="true"/>				
		<RelationSpace>ertms_marker_board</RelationSpace>
		<!-- Attach to 'signalfundament' for Ø76 shunting signal or to 'skiltfeste' for Ø60 poles. -->
		<AttachTo Category="signalfundament"/> 
		<AttachTo Category="skiltfeste"/>
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED"/> -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>
		
		<Variants>
			<Variant Name="E35 Stop sign, side of track">
				<SetValue Key="type" Value="main"/>
				<SetValue Key="function" Value="blocking"/> <!--most marker boards will be blocking for long lines-->
				<SetValue Key="switchable" Value="false"/>
				<SetValue Key="virtual" Value="false"/>
				<SetValue Key="ruleCode" Value=""/>
				<SetValue Key="PortalMounted" Value="false"/>
			</Variant>
			<Variant Name="E35 Stop sign, above track">
				<SetValue Key="type" Value="main"/>
				<SetValue Key="function" Value="intermediate"/> <!--most marker boards above track will be intermediate signals -->
				<SetValue Key="switchable" Value="false"/>
				<SetValue Key="virtual" Value="false"/>
				<SetValue Key="ruleCode" Value=""/>
				<SetValue Key="PortalMounted" Value="true"/>
			</Variant>
		</Variants>

		<SetValue Key="code" Value="Kode?"/>
		
		<!-- Add Lua expressions from 'bnp' since these signals are physically just boards: -->
		<LuaExpression Name="Geometry3D_0.PoleRouting"><Formula>NOBN_bnp_getPoleRoutingDefaultValue()</Formula></LuaExpression>

		<LuaExpression Name="Geometry3D_0.Offset.Z"><Formula>_JBTSA_ERT_Offset3DZ()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_ERT_Offset3DZ()" 
				ReturnType="Double"
				HideFromUser="false"
				Description="Returns the height of the stop sign, placing it right under the corresponding ID sign (if it exists).">
			<Signature>Double _JBTSA_ERT_Offset3DZ()</Signature>
			<Formula>
function _JBTSA_ERT_Offset3DZ()
	function getAttachedIdSign()
		if AttachedElements == nil or AttachedElements.Count == 0 then return nil end
	
		for i = 0, AttachedElements.Count - 1 do
			if AttachedElements[i].RcType == rctype_SignErtmsIdBoard then
				if (AttachedElements[i].Variant == "E101-A ID board, intermediate stop sign, 400x325, white" 
				or AttachedElements[i].Variant == "E101-B ID board, entry stop sign, 400x325, yellow" 
				or AttachedElements[i].Variant == "E101-C ID board, exit stop sign, Ø400, yellow" 
				or AttachedElements[i].Variant == "E101-D ID board, blocking stop sign, Ø400, white") then
					return AttachedElements[i]
				end
			end
		end
		
		return nil
	end

	local idSign = getAttachedIdSign()
	if idSign == nil then return 2.88 end -- Corresponds to idSignZOffset = 2.5 and idSignHeight = 0.325.

	local idSignZOffset = idSign.Geometry3D_0.Offset.Z

	local idSignHeight = 0.325 -- Default height
	if idSign.Variant == "E101-A ID board, intermediate stop sign, 400x325, white" then idSignHeight = 0.325
	elseif idSign.Variant == "E101-B ID board, entry stop sign, 400x325, yellow" then idSignHeight = 0.325
	elseif idSign.Variant == "E101-C ID board, exit stop sign, Ø400, yellow" then idSignHeight = 0.400
	elseif idSign.Variant == "E101-D ID board, blocking stop sign, Ø400, white" then idSignHeight = 0.400 end

	local stopSignHeight = 0.400
	local minimumGap = 0.010

	local nominalZOffset = idSignZOffset + idSignHeight / 2+ stopSignHeight / 2 + minimumGap 
	local roundedZOffset = tonumber(string.format("%.2f", nominalZOffset + 0.005)) -- Round up to nearest cm.

	return roundedZOffset
end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="Geometry3D_0.Name"><Formula>_JBTSA_ERT_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_ERT_Geometry3DName()" ReturnType="String"
				HideFromUser="false"
				Description="Returns the 3D model name [String] for the current ERTMS board. Covers position/stop marker boards. See also JBTSA_ERP ERTMS boards.">
			<Signature>String _JBTSA_ERT_Geometry3DName()</Signature>
			<Formula>
				function _JBTSA_ERT_Geometry3DName()
					local t = "NO-BN-3D-SA-SIG-ERTMS-E35"

					if Variant == "E35 Stop sign, side of track" then
						t = t..(((RightSided and dir == "up") or (LeftSided and dir == "down")) and "-HSIDE" or "-VSIDE")
					end
					
					if Variant == "E35 Stop sign, above track" then
						t = t.."-OVER"
					end
					
					return t
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject Name="E35 Stop sign, side of track" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ERTMS-E35-HSIDE-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true"/>
		</InsertPointObject>
		
		<InsertPointObject Name="E35 Stop sign, above track" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ERTMS-E35-OVER-AAK-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="0.01">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
		</InsertPointObject>	
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'E35 Stop sign, side of track' %}
					{% if RightSided and dir == 'up' %}ERTMS-E35-HSIDE
					{% elsif LeftSided and dir == 'down' %}ERTMS-E35-HSIDE
					{% else %}ERTMS-E35-VSIDE
					{% endif %}
				{% elsif Variant == 'E35 Stop sign, above track' %}ERTMS-E35-OVER
				{% endif %}
				{% if PortalMounted %}AAK{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>
		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste"/>
			</SnapPoints>
		</DockPointDefinitions>

		<!-- Ingen displaypoints - 2D-symbolet settes der InsertionPoint er -->
	</ObjectType>



<!--========================================================================================================
	SIGNALLING
	ERTMS SHUNTING SIGNAL
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_SignErtmsShuntingSignal" Name="JBTSA_SIG ERTMS Shunting signal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Klasse-A signaler (ERTMS)"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
		<AttachmentCategory Name="ertms_shunting_signal" PassAttachmentToTarget="true"/>				
		<RelationSpace>ertms_shunting_signal</RelationSpace>
		<!-- Attach to 'signalfundament' for Ø76 shunting signal or to 'skiltfeste' for Ø60 poles. -->
		<AttachTo Category="signalfundament"/> 
		<AttachTo Category="skiltfeste"/>
		
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>
		
		<Variants>
			<Variant Name="Side of track">
				<SetValue Key="type" Value="shunting"/>
				<SetValue Key="function" Value="intermediate"/>
				<SetValue Key="switchable" Value="false"/>
				<SetValue Key="virtual" Value="false"/>
				<SetValue Key="ruleCode" Value=""/>
				<SetValue Key="PortalMounted" Value="false"/>
			</Variant>
			<Variant Name="Above track">
				<SetValue Key="type" Value="shunting"/>
				<SetValue Key="function" Value="intermediate"/>
				<SetValue Key="switchable" Value="false"/>
				<SetValue Key="virtual" Value="false"/>
				<SetValue Key="ruleCode" Value=""/>
				<SetValue Key="PortalMounted" Value="true"/>
			</Variant>
		</Variants>

		<SetValue Key="code" Value="Kode?"/>
		
		<LuaExpression Name="Geometry3D_0.PoleRouting"><Formula>NOBN_bnp_getPoleRoutingDefaultValue()</Formula></LuaExpression>

		<LuaExpression Name="Geometry3D_0.Offset.Z"><Formula>_JBTSA_SIG_ShuntingOffset3DZ()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_ShuntingOffset3DZ()" 
				ReturnType="Double"
				HideFromUser="false"
				Description="Returns the height of the current shunting signal.">
			<Signature>Double _JBTSA_SIG_ShuntingOffset3DZ()</Signature>
			<Formula>
function _JBTSA_SIG_ShuntingOffset3DZ()
	local standardHeight = 1.500 -- Standard height is 1500mm to the middle of the first light source. See 1000001649 - Design requirements - Signs and boards, 10 SIGNAL POST ARRANGEMENT.
	local internalOffsetZ = 0.247 -- The distance between the insertion point and the middle of the first light source.
	local totalHeight = standardHeight + internalOffsetZ
	
	if Variant == "Side of track" 
		then return totalHeight
	elseif Variant == "Above track" 
		then return -totalHeight
	else 
		return 0.0 
	end
end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="Geometry3D_0.Name"><Formula>_JBTSA_SIG_ShuntingGeometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_ShuntingGeometry3DName()" ReturnType="String"
				HideFromUser="false"
				Description="Returns the 3D model name [String] for the current shunting signal.">
			<Signature>String _JBTSA_SIG_ShuntingGeometry3DName()</Signature>
			<Formula>
function _JBTSA_SIG_ShuntingGeometry3DName()
	return "NO-BN-3D-SA-SIG-ERTMS-DS"
end
			</Formula>
		</LuaFunction>
		
		<InsertPointObject Name="Side of track" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-DS-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true"/>
		</InsertPointObject>
		
		<InsertPointObject Name="Above track" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-DS-AAK-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="0.01">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTSA_SIG-SIGNAL-DS
				{% if PortalMounted %}AAK{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>
		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste"/>
			</SnapPoints>
		</DockPointDefinitions>

		<!-- Ingen displaypoints - 2D-symbolet settes der InsertionPoint er -->
	</ObjectType>

<!--========================================================================================================
	SIGNALLING
	CLASS B SIGNALS (CONVENTIONAL)

	Lyssignaler på egen mast, mange varianter er mulig.
	Fungerer typisk som start & sluttpunkt for togveier og skifteveier.
	Inkluderer signal 66 Togvei Slutt og Høyt Skiftesignal.

	RailCOMPLETE modellering følger til en viss grad railML, pga eksport til railML.
	Denne teksten kan SLETTES når vi har gått helt bort fra railML 2.2 klasser og definert våre
	egne klasser istedet, iht UIC sin RailTopoModel.
	2017-01-04 CLFEY TODO 'switchable' i tSignal er deprecated med railML 2.3, skal settes i sub-elements, som p.t. ikke er implementert i RC ennå.
  
	NB! En lengre tekst, med info om sammenheng RC - railML, ble fjernet herfra ved bygg ca 2018.21.180.
	Se også: http://www.stellwerke.de/signal/deutsch/ne.html#ne5
================================================================================--> 

	<!-- Lua Model Check functions for 'JBTSA_SIG Signal' specific to NO-BN NSI optical signals, with Lua code declared outside user's reach -->
	<LuaFunction Name="NOBN_sig_chkSafetyDistanceFromSignalToOcsPole()" ReturnType="String"
		Description="Checks whether this signal object is inside a radius of 6 meter from an OCS pole.">
        <Signature>String NOBN_sig_chkSafetyDistanceFromSignalToOcsPole()</Signature>
        <Formula>
			function NOBN_sig_chkSafetyDistanceFromSignalToOcsPole()
				local tolerance = 6 --Tolerance in meters
			
				--Preamble - called from a relevant object type?
				if      RcType ~= rctype_SignErtmsMarkerBoard
					and RcType ~= rctype_SignErtmsShuntingSignal
					and RcType ~= rctype_Signal
					and RcType ~= rctype_TrackSignal
					and RcType ~= rctype_BridgeAndFrostDoorSignal
					and RcType ~= rctype_LevelCrossingSignalTowardsRoad
					and RcType ~= rctype_LevelCrossingSignalTowardsRoad
				then 
					return "Bad signal type ["..RcType.."] (code='"..code.."'.",_warning
						
				elseif PortalMounted then
					return "WARNING - Check manually that no high voltage installation is within safety distance from object in portal.",_warning

				elseif RcType == rctype_SignErtmsMarkerBoard then
					return "OK - Markerboard on the ground - Safety distance to OCS pole is not relevant.",_ok
					
				elseif RcType == rctype_SignErtmsShuntingSignal then
					return "OK - Shunting signal on the ground - Safety distance to OCS pole is not relevant.",_ok
			
				elseif RcType == rctype_TrackSignal then
					return "OK - Track signal (togsporsignal) - Safety distance to OCS pole is not relevant.",_ok 

				else
					if RcType == rctype_Signal then
						if HighShuntingSignal == "-" and MainSignal == "-" then 
							return "OK - Free-standing low signal - Safety distance to OCS pole is not relevant.",_ok 
						end
					end

					local c1 = getNearbyPointObjects2D(rctype_OcsPole, tolerance)
					local c2 = getNearbyPointObjects2D(rctype_OcsDropArmForBridgeOrTunnel, tolerance)
					local c3 = getNearbyPointObjects2D(rctype_OcsDropArmUnderPortal, tolerance)
					local nearbyObjects = getUnionOfCollections({c1,c2,c3})
					local count = getCollectionLength(nearbyObjects)
					local UpdateObjects = {}
					if count == 0 then 
						return "OK - No OCS pole within tolerance "..tolerance.." meters.",_ok
					else
						local i = 0
						local shortestDistance = math.huge
						local s = "WARNING - OCS pole"..(count &gt; 1 and "s " or " ") --Singular of plural form
						while i ~= count do
							local d = RC__getDistance2D(nearbyObjects[i]) 
							if d &lt; shortestDistance then shortestDistance = d end
							s = s..nearbyObjects[i].code
							table.insert(UpdateObjects, nearbyObjects[i])
							i = i+1
							if i ~= count then s = s..", " end
						end
						return string.format("%.03f: %s located inside a circle of radius %.3f meters.",shortestDistance,s,tolerance),UpdateObjects,_warning
					end
				end
			end
		</Formula>
     </LuaFunction>
		
	
		
	<LuaFunction Name="NOBN_sig_chkDistanceFromSignalToTrack()" ReturnType="String"
		Description="Checks lateral distance from signal insertion point to closest track on left side (in the direction of increasing mileages). Call with argument 'Right' or 'Left'.">
        <Signature>String NOBN_sig_chkDistanceFromSignalToTrack("Right" | "Left")</Signature>
        <Formula>
			function NOBN_sig_chkDistanceFromSignalToTrack(side)
				side = side and side:lower() or "(no arg)"				
				if side ~= "left" and side ~= "right" then
					return "ERROR Function should be called with argument 'right' or 'left' ["..side.."]."
				end
				if Alignment == nil then
					return "UNFINISHED - Signal must first be assigned to an alignment to deduce its own direction."
				end
				if (DwarfSignal == "Ja" and MainSignal == "-" and PortalMounted) then
					return "WARNING - Shunting signal mounted in portal. Please do manual check.",_warning
				end
				if (VerticalOffset &gt; 0.3) then
					return "WARNING - Signal mounted outside normal elevations. Please do manual check.",_warning 
				end
				local tracks = getNearbyAlignments(rctype_Track):
					filter(function (x) return (side == "right" and 1 or -1) * getAlignmentInfo(x.id).DistanceToAlignment &lt; 0 end)
				if getCollectionLength(tracks) == 0 then
					return "OK - No tracks to the "..side..".",_ok
				end
				local ai = getAlignmentInfo(tracks[0].id)
				local curveRadius = ai.CurveRadius
				local Ki = 0.0
				local Ky = 0.0
				local tolerance = 2.12
				--Many signals are covered with these formulas, but not all - use your insight wisely:
				if (DwarfSignal ~= "-" and MainSignal == "-") then
					--Freestanding dwarf signal
					tolerance = tolerance + 0.25
				elseif MainSignal ~= "-" or DistantSignal ~= "-" then
					tolerance = tolerance + 0.4
				end
				local distToAlignment = math.abs(ai.DistanceToAlignment)
				if (curveRadius ~= math.huge) then
					--Std Bane NOR approximation formulae:
					--See ...\Onedrive - RailCOMPLETE AS\V\I - Issues\Attachments\2020-03-17 Taylor series expansion for RC-DisplayEnvelope (issue #6338)
					Ki = 81000.0/(2*curveRadius)
					Ky = 63000.0/(2*curveRadius)
				end
				if (ai.CurveRotation == "CCW") then 
					tolerance = tolerance + (Ky/1000.0)
				else
					tolerance = tolerance + (Ki/1000.0)
				end
				if (distToAlignment &lt;= tolerance) then
					return string.format("%.3f: ERROR - Signal too close to track '%s' wrt. tolerance %.3f.",
						distToAlignment,ai.AlignmentName,tolerance),_error
				elseif (distToAlignment &gt; tolerance and distToAlignment &lt;= (tolerance + 0.4)) then
					return string.format("%.3f: WARNING - Signal close to track '%s', less than 0.4 m from tolerance %.3f.",
						distToAlignment,ai.AlignmentName,tolerance),_warning
				else
					return string.format("%.3f: OK - Signal is far from track '%s' wrt. tolerance %.3f.",
						distToAlignment,ai.AlignmentName,tolerance),_ok
				end
			end
		</Formula>
     </LuaFunction>
		

	<!-- Included for backwards compatibility: -->
	<LuaFunction Name="NOBN_sig_chkLeftSideDistanceFromSignalToTrack()" ReturnType="String"
			Description="Checks lateral distance from signal insertion point to closest track on left side (in the direction of increasing mileages)." HideFromUser="false">
		<Signature>String NOBN_sig_chkLeftSideDistanceFromSignalToTrack()</Signature>
		<Formula>
			function NOBN_sig_chkLeftSideDistanceFromSignalToTrack()
				return NOBN_sig_chkDistanceFromSignalToTrack("Left")
			end
		</Formula>
	</LuaFunction>
	
	<!-- Included for backwards compatibility: -->
	<LuaFunction Name="NOBN_sig_chkRightSideDistanceFromSignalToTrack()" ReturnType="String"
			Description="Checks lateral distance from signal insertion point to closest track on right side (in the direction of increasing mileages)." HideFromUser="false">
		<Signature>String NOBN_sig_chkRightSideDistanceFromSignalToTrack()</Signature>
		<Formula>
			function NOBN_sig_chkRightSideDistanceFromSignalToTrack()
				return NOBN_sig_chkDistanceFromSignalToTrack("Right")
			end
		</Formula>
	</LuaFunction>


	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_Signal" Name="JBTSA_SIG Signal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Klasse-B signaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>signal</RelationSpace>
		 <!-- Note: When  PassAttachmentToTarget is true, then objects attached to it, even if through an intermediate object, will have their "Attachment" property set to the signal. -->
		<AttachmentCategory Name="signal" PassAttachmentToTarget="true"/>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED"/> -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED"/>
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>

		<!-- Variant has been added solely to show the user something - it is not needed, since all signal items have this same Variant. -->
		<Variants DefaultValue="Sammensatt signal">
			<Variant Name="Sammensatt signal"/>
		</Variants>

		<CustomProperty DataType="Enumeration" Name="Sunscreen" DisplayName="Bakgrunnsskjerm" DefaultValue="Ja" 
			Description="The 'Sunscreen' custom property [- | Ja] decides whether the signal has background screen ('Ja') or not ('-').">
			<Values>
				<Value>Ja</Value>
				<Value>-</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="MainSignal" DisplayName="Hovedsignal" DefaultValue="-"
			Description="Bane NOR 1/2/3-lantern optical main signal.\n20a=*Red:Stop(entry/block)\n20b=Red:Stop(intermediate/exit)\n21(3-light main)=UpperGreen:Proceed with caution\n21(2-light main)=LowerGreen:Proceed with caution\n21(repeater)=UpperGreen:Proceed with caution\n22=UpperGreen+LowerGreen:Proceed.">
			<Values>
				<Value>-</Value>
				<Value>Hs1</Value>
				<Value>Hs2</Value>
				<Value>Hs3</Value>
				<Value>RepHs1</Value>
				<Value>RepHs2</Value>
			</Values>
		</CustomProperty>
		
		<CustomProperty DataType="Enumeration" Name="EndOfTrainRouteSignal" DisplayName="Togvei slutt" DefaultValue="-" 
			Description="Bane NOR S66 black/yellow board:End of train route movement authority (with or without an ensuing main signal).">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="DistantSignal" DisplayName="Forsignal" DefaultValue="-"  
			Description="Bane NOR 2-lantern optical distant signal.\n23=*Yellow:Stop ahead\n24=*Yellow/*Green:Reduced speed ahead\n25=*Green:Line speed ahead.">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="DwarfSignal" DisplayName="Dvergsignal" DefaultValue="-" 
			Description="Bane NOR optical shunting signal.\n43=TwoHorizontalWhite:Shunting forbidden\n44=TwoSlantedWhite:Cautious shunting\n45=TwoVerticalWhite:Shunting allowed\n46a=OneWhite:local release\n46b=TwoBackslantedWhite:Local release.">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="HighShuntingSignal" DisplayName="Høyt skiftesignal" DefaultValue="-"
			Description="Bane NOR High Shunting optical signal.\n41=SlantedWhiteLine:Cautious shunting with local release\n42=HorizontalWhiteLine:Shunting forbidden.">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="PositionLamp" DisplayName="Middelkontrollampe" DefaultValue="-"
			Description="Bane NOR Position Lamp optical signal.\n.4C=*White:Last axle still occupying turnout section. Off:Trigger section not yet entered, or last axle not occupying turnout section anymore.">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="CautiousDrivingSignal" DisplayName="Forsiktig kjøring" DefaultValue="-"
			Description="Bane NOR Cautious Driving optical signal.\n32=White luminescent cross:Proceed with extra caution in train route (main signal shows Hs21, distant signal is shut off (Fs00).">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="LineSignal" DisplayName="Linjesignal" DefaultValue="-"
			Description="Bane NOR Line optical signal.\n35B=White luminescent letter:The signal shows a distinct letter representing one of several  destination lines.">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="OpticalSpeedSignal" DisplayName="Lysende hastighetssignal" DefaultValue="-"
			Description="Bane NOR Deviating Speed optical signal.\n.68C=WhiteDigit(s):Allowed speed over deviating turnout or group of turnouts ahead.">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="DepartureSignal" DisplayName="Avgangssignal" DefaultValue="-"
			Description="Bane NOR Departure signal.\nLuminous White letter 'A' on black background (permission to depart is granted)'.">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="Enumeration" Name="BrakeTestSignal" DisplayName="Bremseprøvesignal" DefaultValue="-"
			Description="Bane NOR Brake Test Signal.\n.Luminous letter 'T' (activate brake), 'L' (loosen brake) or dark (no action).">
			<Values>
				<Value>-</Value>
				<Value>Ja</Value>
			</Values>
		</CustomProperty>

		<CustomProperty DataType="String" ReadOnly="true" Category="Model check" Name="mc_SafetyDistanceFromSignalToOcsPole" DisplayName="Sikkerhetsavstand til KL" 
			Description="Below 6 meter: Warning – Signal is too close to OCS pole, a potential HVAC hazard for maintenance personnel.\nAbove 6 meter: OK – No known HVAC danger to personnel."/>
		<CustomProperty DataType="String" ReadOnly="true" Category="Model check" Name="mc_LeftSideDistanceFromSignalToTrack" DisplayName="Avstand til spor venstre"
			Description="Dwarf signal:\Below 2.37m: Error – Signal too close to track.\nFrom 2.37m to 2.77m: Warning – Within tolerance, potentially too close to track.\nAbove 2.77m: OK – Far enough from track.\n\nOther signals:\nBelow 2.52m: Error - Signal too close to track.\nFrom 2.52m to 2.92m: Warning - Within tolerance, potentially too close to track.\nAbove 2.92m: OK - Far enough from track.\n\nThe calculations take into account the nose/coach midpoint curvature extension."/>
		<CustomProperty DataType="String" ReadOnly="true" Category="Model check" Name="mc_RightSideDistanceFromSignalToTrack" DisplayName="Avstand til spor høyre"
			Description="Dwarf signal:\Below 2.37m: Error – Signal too close to track.\nFrom 2.37m to 2.77m: Warning – Within tolerance, potentially too close to track.\nAbove 2.77m: OK – Far enough from track.\n\nOther signals:\nBelow 2.52m: Error - Signal too close to track.\nFrom 2.52m to 2.92m: Warning - Within tolerance, potentially too close to track.\nAbove 2.92m: OK - Far enough from track.\n\nThe calculations take into account the nose/coach midpoint curvature extension."/>
		<CustomProperty DataType="String" Name="LineSignalValue" DisplayName="Linjesignal signaltekst" DefaultValue=""/>
		<CustomProperty DataType="String" Name="OpticalSpeedSignalValue" DisplayName="Lysende hastighetssignal verdi" DefaultValue=""/>
		
		<LuaExpression Name="mc_SafetyDistanceFromSignalToOcsPole" IsModelCheck="true"><Formula>NOBN_sig_chkSafetyDistanceFromSignalToOcsPole()</Formula></LuaExpression>
		<LuaExpression Name="mc_LeftSideDistanceFromSignalToTrack" IsModelCheck="true"><Formula>NOBN_sig_chkLeftSideDistanceFromSignalToTrack()</Formula></LuaExpression>
		<LuaExpression Name="mc_RightSideDistanceFromSignalToTrack" IsModelCheck="true"><Formula>NOBN_sig_chkRightSideDistanceFromSignalToTrack()</Formula></LuaExpression>

		<LuaExpression Name="Geometry3D_0.Name"><Formula>_JBTSA_SIG_signal_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_signal_Geometry3DName()" ReturnType="String"
				Description="Returns 3D Model Name for a Bane NOR NSI-63 type signal, based on CustomProperties such as Hovedsignal, Forsignal, Dvergsignal etc.">
			<Signature>String _JBTSA_SIG_signal_Geometry3DName()</Signature>
			<Formula>
				function _JBTSA_SIG_signal_Geometry3DName()
					--Ref. https://orv.banenor.no/orv/doku.php?id=tjn:Kapittel_8 fra "Bane NOR – Trafikkregler for jernbanenettet (TJN) – gyldig fra 16.6.2019. Endret 24.4.2019."
					--Ref LISP-code for NO-BN's 2D library, file "Signal combinations.lsp" ca line number 350 where the symbol's CAD block name is constructed.
					local t				
					t = "NO-BN-3D-SA-SIG-NSI63"
					if     (MainSignal == "RepHs1") then t = t.."-HSREP1" --RepHs 1-lys (øvre grønn i 2-lysramme, blendet nedre lanterne) - uten kne, oppover-montering, f.eks. på vegg
					elseif (MainSignal == "RepHs2") then t = t.."-HSREP2" --RepHs 1-lys (to grønne i 2-lysramme) - uten kne, oppover-montering, f.eks. på vegg
					elseif (MainSignal == "Hs1") then t = t.."-HS1" --Stopplykt, Hs20=Stopp=nedre rød
					elseif (MainSignal == "Hs2") then t = t.."-HS2" --2-lys Hs, Hs20=Stopp=nedre rød / Hs21=Kjør med redusert hast.=øvre grønn
					elseif (MainSignal == "Hs3") then t = t.."-HS3" --3-lys Hs, Hs20=Stopp=nedre rød / Hs21=Kjør med redusert hast.=øvre grønn / Hs22=Kjør=Øvre+nedre grønn
					end
					if (DistantSignal ~= "-") then t = t.."-FS" end
					if (EndOfTrainRouteSignal ~= "-") then t = t.."-TVS" end --Togvei slutt signal 66, 'S'
					if (DwarfSignal ~= "-") then t = t.."-DS" end
					if (HighShuntingSignal ~= "-") then t = t.."-ZS" end --Høyt skiftesignal
					if (PositionLamp ~= "-") then t = t.."-MKS" end --Middelkontrollampe signal, hvit blinkende
					if (CautiousDrivingSignal ~= "-") then t = t.."-FKS" end
					if (LineSignal ~= "-") then t = t.."-LS" end --Linjesignal (het 'hovedlinjesignal' tidligere)
					if (OpticalSpeedSignal ~= "-") then t = t.."-LHS" end --Lysende HastighetsSignal, lysende 10-ere for en eller flere aspekter
					if (DepartureSignal ~= "-") then t = t.."-AVS" end --Avgangssignal
					if (BrakeTestSignal ~= "-") then t = t.."-BPS" end --Bremseprøvesignal
					if Sunscreen == "-" then t = t.."-UTEN-SKJERM" end
					if PortalMounted then t = t.."-ÅK" end
					if KneeTowardsTrack then if KneeTowardsTrack ~= "-" then t = t..(RightSided and "-VKNE" or "-HKNE") end end
					if t:match("%-NSI63%-DS") and not t:match("ÅK") then t = t.."-2000" end --Add '-2000' pole total length to shunting signal if free-standing shunting signal
					return t
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject Name="Frittstående forsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-FS-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="name" Value="Fs."/>
			<SetValue Key="type" Value="distant"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="Frittstående Dvergsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-DS-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="type" Value="shunting"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="Frittstående Dvergsignal med togvei slutt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TVS-DS-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="EndOfTrainRouteSignal" Value="Ja"/>
			<SetValue Key="type" Value="shunting"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="Frittstående Dvergsignal med middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-DS-MKS-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="shunting"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="Frittstående Dvergsignal med middelkontroll og togvei slutt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TVS-DS-MKS-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="EndOfTrainRouteSignal" Value="Ja"/>
			<SetValue Key="type" Value="shunting"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="Frittstående Høyt Skiftesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ZS-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="HighShuntingSignal" Value="Ja"/>
			<SetValue Key="type" Value="shunting"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="Frittstående Høyt Skiftesignal med Middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-ZS-MKS-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="HighShuntingSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="shunting"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="1-lys stopplykt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS1-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs1"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="1-lys Rep. hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS1-{{SymbolMode}}"
				SubGroup="Frittstående Signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="RepHs1"/>
			<SetValue Key="type" Value="repeater"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="2-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys Rep. hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" 
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="RepHs2"/>
			<SetValue Key="type" Value="repeater"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
			<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-SIG-NSI63-HS-2-LYS-REP"/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg og forsiktig kjøring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-FKS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg, forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-FKS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg, middelkontroll og forsiktig kjøring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-FKS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg, middelkontroll, forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-FKS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal dverg og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-LS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-LS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg, middelkontroll og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-LS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="2-lys hovedsignal med dverg, middelkontroll, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-DS-MKS-LS-LHS-{{SymbolMode}}"
				SubGroup="2-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="3-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="3-lys hovedsignal med linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-LS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="3-lys hovedsignal med linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-LS-LHS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="3-lys hovedsignal med lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-LHS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="3-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-{{SymbolMode}}" 
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="3-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-LHS-{{SymbolMode}}" 
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="3-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-MKS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="3-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="3-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="main"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="4-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="4-lys hovedsignal med middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-MKS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-MKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>	
		
		<InsertPointObject Name="4-lys hovedsignal med forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-FKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-LS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>	

		<InsertPointObject Name="4-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="4-lys hovedsignal med dverg, middelkontroll og forsiktig kjøring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-FKS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg, middelkontroll, forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-FKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg, forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-FKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg, middelkontroll og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-LS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="4-lys hovedsignal med dverg, middelkontroll, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-FS-DS-MKS-LS-LHS-{{SymbolMode}}"
				SubGroup="4-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs2"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="5-lys hovedsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-MKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-MKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="5-lys hovedsignal med forsiktig kjøring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-FKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-FKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="5-lys hovedsignal med linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="LineSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="5-lys hovedsignal med dverg og middelkontroll" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="5-lys hovedsignal med dverg og forsiktig kjøring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="5-lys hovedsignal med dverg, middelkontroll og forsiktig kjøring" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-FKS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, middelkontroll og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="Linjesignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, middelkontroll og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, middelkontroll, forsiktig kjøring og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-FKS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, middelkontroll, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-MKS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="PositionLamp" Value="Ja"/>
			<SetValue Key="Linjesignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, forsiktig kjøring og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="Linjesignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, forsiktig kjøring, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-FKS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="CautiousDrivingSignal" Value="Ja"/>
			<SetValue Key="Linjesignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg og linjesignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-LS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="Linjesignal" Value="Ja"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<InsertPointObject Name="5-lys hovedsignal med dverg, linjesignal og lysende hastighetssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-FS-DS-LS-LHS-{{SymbolMode}}"
				SubGroup="5-lys signal"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="MainSignal" Value="Hs3"/>
			<SetValue Key="DistantSignal" Value="Ja"/>
			<SetValue Key="DwarfSignal" Value="Ja"/>
			<SetValue Key="Linjesignal" Value="Ja"/>
			<SetValue Key="OpticalSpeedSignal" Value="Ja"/>
			<SetValue Key="type" Value="combined"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
		
		<!-- Note: EnableDirectionSetting=="true" in element InsertPointObject (enable keybd shortcut for direction flipping up/down), so RC adds 180 DD to the 'down' direction: -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="true">
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
			NO-BN-2D-JBTSA_SIG-SIGNAL
			{% if MainSignal == 'Hs1' or MainSignal == 'RepHs1' %}HS1
			{% elsif MainSignal == 'Hs2' or MainSignal == 'RepHs2' %}HS2
			{% elsif MainSignal == 'Hs3' %}HS3
			{% endif %}
			{% if DistantSignal == 'Ja' %}FS{% endif %}
			{% if EndOfTrainRouteSignal == 'Ja' %}TVS{% endif %}
			{% if DwarfSignal == 'Ja' %}DS{% endif %}
			{% if HighShuntingSignal == 'Ja' %}ZS{% endif %}
			{% if PositionLamp == 'Ja' %}MKS{% endif %}
			{% if CautiousDrivingSignal == 'Ja' %}FKS{% endif %}
			{% if LineSignal == 'Ja' %}LS{% endif %}
			{% if OpticalSpeedSignal == 'Ja' %}LHS{% endif %}
			{% if BrakeTestSignal == 'Ja' %}BPS{% endif %}
			{% if DepartureSignal == 'Ja' %}AVS{% endif %}
			{% if PortalMounted %}AAK{% endif %}
			{{SymbolMode}}
			</BlockNameFormat>
			
			<SymbolAttribute Tag="LS">
				<Value>{{LineSignalValue}}</Value>
			</SymbolAttribute>
			
			<SymbolAttribute Tag="LHS">
				<Value>{{OpticalSpeedSignalValue}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament"/>
			</SnapPoints>
		</DockPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Togsporsignal
	Togsporsignal på egen mast eller på vegg eller i åk
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_TrackSignal" Name="JBTSA_SIG Togsporsignal"
				Layer="JBTSA_SIG" Color="ByLayer" 
				Group="Signal/Hjelpesignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>signal</RelationSpace>
		 <!-- Note: When  PassAttachmentToTarget is true, then objects attached to it, even if through an intermediate object, will have their "Attachment" property set to the signal. -->
		<AttachmentCategory Name="signal" PassAttachmentToTarget="true"/>
		<AttachTo Category="stolpe_med_fot"/>
		<AttachTo Category="signal"/>

		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>

		<Variants DefaultValue="Togsporsignal">
			<Variant Name="Togsporsignal 1-begrep">
			</Variant>
			<Variant Name="Togsporsignal 2-begrep">
			</Variant>
			<Variant Name="Togsporsignal 1-begrep, sidestilt">
			</Variant>
			<Variant Name="Togsporsignal 2-begrep, sidestilt">
			</Variant>
		</Variants>

		<LuaExpression Name="IsyPostnotat"><Formula>NOBN_sig_getSignalFullName()</Formula></LuaExpression> 

		<CustomProperty DataType="String" ReadOnly="true" Category="Model check" Name="mc_SafetyDistanceFromSignalToOcsPole" DisplayName="Sikkerhetsavstand til KL" 
			Description="Below 6 meter: Warning – Signal is too close to OCS pole, a potential HVAC hazard for maintenance personnel.\nAbove 6 meter: OK – No known HVAC danger to personnel."/>
		<CustomProperty DataType="String" ReadOnly="true" Category="Model check" Name="mc_LeftSideDistanceFromSignalToTrack" DisplayName="Avstand til spor venstre"
			Description="Dwarf signal:\Below 2.37m: Error – Signal too close to track.\nFrom 2.37m to 2.77m: Warning – Within tolerance, potentially too close to track.\nAbove 2.77m: OK – Far enough from track.\n\nOther signals:\nBelow 2.52m: Error - Signal too close to track.\nFrom 2.52m to 2.92m: Warning - Within tolerance, potentially too close to track.\nAbove 2.92m: OK - Far enough from track.\n\nThe calculations take into account the nose/coach midpoint curvature extension."/>
		<CustomProperty DataType="String" ReadOnly="true" Category="Model check" Name="mc_RightSideDistanceFromSignalToTrack" DisplayName="Avstand til spor høyre"
			Description="Dwarf signal:\Below 2.37m: Error – Signal too close to track.\nFrom 2.37m to 2.77m: Warning – Within tolerance, potentially too close to track.\nAbove 2.77m: OK – Far enough from track.\n\nOther signals:\nBelow 2.52m: Error - Signal too close to track.\nFrom 2.52m to 2.92m: Warning - Within tolerance, potentially too close to track.\nAbove 2.92m: OK - Far enough from track.\n\nThe calculations take into account the nose/coach midpoint curvature extension."/>
		
		<LuaExpression Name="mc_SafetyDistanceFromSignalToOcsPole" IsModelCheck="true"><Formula>NOBN_sig_chkSafetyDistanceFromSignalToOcsPole()</Formula></LuaExpression>
		<LuaExpression Name="mc_LeftSideDistanceFromSignalToTrack" IsModelCheck="true"><Formula>NOBN_sig_chkLeftSideDistanceFromSignalToTrack()</Formula></LuaExpression>
		<LuaExpression Name="mc_RightSideDistanceFromSignalToTrack" IsModelCheck="true"><Formula>NOBN_sig_chkRightSideDistanceFromSignalToTrack()</Formula></LuaExpression>

		<LuaExpression Name="Geometry3D_0.Name"><Formula>_JBTSA_SIG_Togsporsignal_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_Togsporsignal_Geometry3DName()" ReturnType="String" HideFromUser="false"
			Description="">
			<Signature>String _JBTSA_SIG_Togsporsignal_Geometry3DName()</Signature>
			<Formula>
				function _JBTSA_SIG_Togsporsignal_Geometry3DName()
					local t = "NO-BN-3D-SA-SIG-NSI63-TSS"
					if Variant == "Togsporsignal 1-begrep" then
						return t.."-TOGSPORSIGNAL-HODE" 
					elseif Variant == "Togsporsignal 1-begrep, sidestilt" then
						if RightSided then
							return (dir == 'up') and t.."-H" or t.."-V"
						else
							return (dir == 'up') and t.."-V" or t.."-H"
						end
					elseif Variant == "Togsporsignal 2-begrep" then
						return t.."-HV" 
					elseif Variant == "Togsporsignal 2-begrep, sidestilt" then
						return t.."-HV"  --User must adjust sideways 3D offset towards track and add Pole Routing himself
					else 
						return "Unrecognized variant ["..Variant.."], cannot determine 3D Model Name.",_warning
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="Geometry3D_0.Offset.Z">
			<Formula>
				local d = (Variant:find("sidestilt") or Variant:find("2%-begrep")) and 0.15 or 0 --juster litt ned hvis signalet har arm(er)
				local a = Attachment
				if a then
					if a.Variant:find(" 1.6m") then return 0.690 - d
					elseif a.Variant:find(" 2m") then return 1.090 - d 
					elseif a.Variant:find(" 3m") then return 2.090 - d
					elseif a.Variant:find(" 3.2m") then return 2.290 - d
					else return 1.090 - d
					end
				else 
					return 1.090 - d --Standard Ø76 stolpe er 2m høy
				end
			</Formula>
		</LuaExpression>

		<InsertPointObject Name="Togsporsignal 1-begrep" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-1-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="type" Value="other:togsporSignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="Togsporsignal 2-begrep" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="type" Value="other:togsporSignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="Togsporsignal 1-begrep, sidestilt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-3-VSIDE-{{SymbolMode}}" 
				AskForAttachment="true"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true"/>
			<SetValue Key="type" Value="other:togsporSignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="Togsporsignal 2-begrep, sidestilt" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL-4-VSIDE-{{SymbolMode}}"
				AskForAttachment="true"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" MirrorAboutJigXAxisIfLeftSideOfAlignment="true"/>
			<SetValue Key="type" Value="other:togsporSignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>
     													    
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTSA_SIG-SIGNAL-TOGSPORSIGNAL
				{%    if Variant == 'Togsporsignal 1-begrep' %}1
				{% elsif Variant == 'Togsporsignal 2-begrep' %}2
				{% elsif Variant == 'Togsporsignal 1-begrep, sidestilt' %}
					{% if RightSided  %}
						{% if dir == 'up' %}3-HSIDE
						{% else %}3-VSIDE
						{% endif %}
					{% else  %}
						{% if dir == 'up' %}3-VSIDE
						{% else %}3-HSIDE
						{% endif %}
					{% endif %}
				{% elsif Variant == 'Togsporsignal 2-begrep, sidestilt' %}
					{% if RightSided  %}
						{% if dir == 'up' %}4-HSIDE
						{% else %}4-VSIDE
						{% endif %}
					{% else  %}
						{% if dir == 'up' %}4-VSIDE
						{% else %}4-HSIDE
						{% endif %}
					{% endif %}
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{% if PortalMounted %}AAK{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="stolpe_med_fot"/>
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3"/>
				<SnapPoint X="3" Y="-3"/>
				<SnapPoint X="-3" Y="3"/>
				<SnapPoint X="-3" Y="-3"/>
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>





<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Rasvarslingssignal (med dobbel 's'...)
	Bygges som vanlig 3-lys Hs. 
	Merk: Det er i RC ikke et eget "Rasvarslingssignal" med "R" i ring i firkant. Det forutsettes at et R-skilt attaches til R-signalet.
	Signalbilder:
		Signal 59 To blinkende gule oppe/nede = "Rasfare" - Tog skal stoppe ved rasvarslingsstolpen.
		Signal 56C Blinkende hvit midtre = "Tog kan passere rasfarestrekningen".
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_AvalancheSignal" Name="JBTSA_SIG Rasvarslingssignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Hjelpesignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		 <!-- Note: When  PassAttachmentToTarget is true, then objects attached to it, even if through an intermediate object, will have their "Attachment" property set to the signal. -->
		<AttachmentCategory Name="signal" PassAttachmentToTarget="true"/>

		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED"/>
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>
		
		<Variants DefaultValue="Rasvarslingssignal">
			<Variant Name="Rasvarslingssignal">
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-SIG-NSI63-RASVARSLING"/>
			</Variant>
		</Variants>
	
		<InsertPointObject Name="Rasvarslingssignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="type" Value="other:rasvarslingsSignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'Rasvarslingssignal' %}HS3
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament"/>
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Brusignal/Frostportsignal
	Bygges som vanlig 3-lys Hs. 
	Signalbilder:
		Signal 20C To blinkende røde øver/nedre = "Stopp" - Tog og skift skal stoppe foran signalet.
		Signal 56D Blinkende hvit midtre = "Klar linje" - Tog og skift kan passere signalet og kjører over bevegelig bru eller forbi åpen frostport.
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_BridgeAndFrostDoorSignal" Name="JBTSA_SIG Brusignal/Frostportsignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Hjelpesignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		 <!-- Note: When  PassAttachmentToTarget is true, then objects attached to it, even if through an intermediate object, will have their "Attachment" property set to the signal. -->
		<AttachmentCategory Name="signal" PassAttachmentToTarget="true"/>

		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED"/>
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>
		
		<Variants DefaultValue="Brusignal/Frostportsignal">
			<Variant Name="Brusignal/Frostportsignal">
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-SIG-NSI63-BRU-OG-FROSTPORTSIGNAL"/>
			</Variant>
			<!--på egen kabelplan se https://trv.jbv.no/wiki/Felles_bestemmelser/Definisjoner,_forkortelser_og_symboler#Symboler_for_Bruer-->
		</Variants>
	
		<InsertPointObject Name="Brusignal/Frostportsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="type" Value="other:broSignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS3-{{SymbolMode}}" AllowSymbolMove="true">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'Brusignal/Frostportsignal' %}20-HS3
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament"/>
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	HJELPESIGNALER
	JBTSA_SIG Planovergangssignal (med dobbel 's'...)
	Bygges som 2-lys signal med vanlig 2-lys ramme men med avrundet bakgrunnsskjerm.
	Signalbilder:
		PLO: Signal 55 Rødt blinkende lys øvre = "Stopp foran planovergangen" - Tog og skift skal stoppe foran planovergangen.
		PLO: Signal 56A Hvitt blinkende lys nedre = "Planovergangen kan passeres" - Tog og skift kan passere planovergangen.
		PLO-Fs: Signal 57 Fiolett blinkende lys øvre = "Planovergangssignalet viser stopp foran planovergangen"
			- Toget skal redusere hastigheten slik at toget kan stoppe foran planovergangssignalet. Tilhørende
			planovergangssignal viser signal 55 «Stopp foran planovergangen".
		PLO-Fs: Signal 56B Hvitt blinkende lys nedre = "«Planovergangssignalet viser at planovergangen kan passeres»"
			- Toget kan fortsette med største tillatte hastighet. Tilhørende planovergangssignal viser signal 56 «Planovergangen kan passeres».
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_LevelCrossingSignalTowardsRail" Name="JBTSA_SIG Planovergangssignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Veibomanlegg"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal</RelationSpace>
		 <!-- Note: When  PassAttachmentToTarget is true, then objects attached to it, even if through an intermediate object, will have their "Attachment" property set to the signal. -->
		<AttachmentCategory Name="signal" PassAttachmentToTarget="true"/>

		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED"/>
		<xpp:expand select="NOBN_sig_STD_CUSTOMATTRIBUTES___SPREADING_LENS"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>
		
		<Variants DefaultValue="Planovergang, signal">
			<Variant Name="Planovergang, signal"/>
			<Variant Name="Planovergang, forsignal"/>
		</Variants>

		<LuaExpression Name="Geometry3D_0.Name"><Formula>_JBTSA_SIG_Planovergangssignal_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_SIG_Planovergangssignal_Geometry3DName()" ReturnType="String" HideFromUser="false"
			Description="Returns the 3D model name for a Level Crossing signal (towards track).">
			<Signature>String _JBTSA_SIG_Planovergangssignal_Geometry3DName()</Signature>
			<Formula>
				function _JBTSA_SIG_Planovergangssignal_Geometry3DName()
					local t = "NO-BN-3D-SA-SIG-NSI63-W-PLANOVERGANG"
					if Variant == "Planovergang, signal" then
						return t.."-SIGNAL"
					elseif Variant == "Planovergang, forsignal" then
						return t.."-FORSIGNAL"
					else 
						return "Unrecognized variant ["..Variant.."], cannot determine 3D Model Name.",_warning
					end
				end
			</Formula>
		</LuaFunction>
		
		<InsertPointObject Name="Planovergang, signal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="type" Value="other:planovergangsSignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<InsertPointObject Name="Planovergang, forsignal" DisplayBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0">
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
			<SetValue Key="type" Value="other:planovergangForsignal"/>
			<SetValue Key="switchable" Value="true"/>
			<SetValue Key="virtual" Value="false"/>
			<SetValue Key="ruleCode" Value=""/>
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_SIG-SIGNAL-HS2-{{SymbolMode}}" AllowSymbolMove="true">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTSA_SIG-SIGNAL
				{% if Variant == 'Planovergang, signal' %}20-HS2
				{% elsif Variant == 'Planovergang, forsignal' %}20-HS2
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament"/>
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SIGNAL
	VEIBOMANLEGG
	JBTSA_SIG Veisignal
	Frittstående, mot biltrafikk
=========================================================================================================-->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" LuaName="rctype_LevelCrossingSignalTowardsRoad" Name="JBTSA_SIG Veisignal"
				Layer="JBTSA_SIG" Color="ByLayer"
				Group="Signal/Veibomanlegg"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>signal_mot_vei</RelationSpace>
		<AttachmentCategory Name="signal_mot_vei" PassAttachmentToTarget="true"/>
		
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___SYMBOLFRAME"/>
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___VAR"/>
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG"/>
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG"/>
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS"/>
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT"/>
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL"/>

		<Variants DefaultValue="Veisignal">
			<Variant Name="Veisignal/Enkelt signal mot vei">
				<SetValue Key="name" Value="V.(enkeltspor)"/>
				<!-- TODO 3D modell for Veisignal for planovergang -->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-FE-DIV-UKJENT"/>
			</Variant>
			<Variant Name="Veisignal/Dobbelt signal mot vei">
				<!-- TODO 3D modell for Veisignal for planovergang -->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-FE-DIV-UKJENT"/>
				<SetValue Key="name" Value="V.(flerspor)"/>
			</Variant>
		</Variants>

		<InsertPointObject Name="Veisignal/Enkelt signal mot vei" DisplayName="Planovergang/Enkelt signal mot vei" 
				DisplayBlockName="NO-BN-2D-JBTSA_SIG-VEISIGNAL-1-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="6.0">
			<OwnAlignmentTargetSpace>vei</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
		</InsertPointObject>

		<InsertPointObject Name="Veisignal/Dobbelt signal mot vei" DisplayName="Planovergang/Dobbelt signal mot vei"
				DisplayBlockName="NO-BN-2D-JBTSA_SIG-VEISIGNAL-2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="6.0">
			<OwnAlignmentTargetSpace>vei</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true"/>
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true">
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}"/>	
			<BlockNameFormat JoinBy="-">
				NO-BN-2D-JBTSA_SIG-VEISIGNAL
				{% if Variant == 'Veisignal/Enkelt signal mot vei' %}VS1
				{% elsif Variant == 'Veisignal/Dobbelt signal mot vei' %}VS2
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{% if PortalMounted %}AAK{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true"/>

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt"/>
				<SnapPoint X="0" Y="0" TargetSpace="signalfundament"/>
			</SnapPoints>
		</DockPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SIGNAL
	AUXILIARY SIGNALS
=========================================================================================================-->
	<!-- TODO Definere frittstående bremseprøvesignal, frittstående lysende sporvekselsignal / kryssvekselsignal, frittstående avgangssignal (finnes de??) -->



<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

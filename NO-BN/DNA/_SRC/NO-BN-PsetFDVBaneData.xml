<!--========================================================================================================

    NO-BN-PsetFDVBaneData.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2021. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>

<!--========================================================================================================
	Extended data property sets (will be picked up by AutoCAD as Extended Data, and exports to IFC using Civil 3D)
=========================================================================================================-->

<!-- Datasettet «FDV BaneData» benyttes dersom det er objekter som skal registreres i BaneData. Disse objektene har  -->
<!-- fått Banedata ID under utarbeidelse av arbeidsgrunnlaget, og denne skal benyttes når supplerende informasjon skal sendes inn.  -->

<PropertySets>
	<ExtendedDataPropertySet Name="FDV BaneData" IsVisible="true" IsWritable="true" IsLocked="false" >
		<Properties>
			<ExtendedDataProperty Name="ObjektID" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="1" />
			<ExtendedDataProperty Name="Beskrivelse" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="2" />
			<ExtendedDataProperty Name="Tilhører objekt" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="3" />
			<ExtendedDataProperty Name="Tilhører lokasjon" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="4" />
			<ExtendedDataProperty Name="Navn/nr" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="5" />
			<ExtendedDataProperty Name="Idriftssatt dato" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="6" />
			<ExtendedDataProperty Name="Km(fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="7" />
			<ExtendedDataProperty Name="Side(fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="8" />
			<ExtendedDataProperty Name="Sportype(fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="9" />
			<ExtendedDataProperty Name="Spornr. (fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="10" />
			<ExtendedDataProperty Name="Avst/Spormidt(fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="11" />
			<ExtendedDataProperty Name="Eier" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="12" />
			<ExtendedDataProperty Name="Nord(fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="13" />
			<ExtendedDataProperty Name="Øst(fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="14" />
			<ExtendedDataProperty Name="Høyde(fra)" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="15" />
			<ExtendedDataProperty Name="Dokument referanse" DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="16" />
			<ExtendedDataProperty Name="Serienr." DataType="Text" Description="" DefaultValue="---" IsVisible="true" DisplayOrder="17" />
		</Properties>
	</ExtendedDataPropertySet>
</PropertySets>

<!--========================================================================================================
    ObjectType element 'CustomAttribute' macros for FDV BaneData
=========================================================================================================-->


 
 <!-- RailCOMPLETE benytter en extended data definisjon (element PropertySets / ExtendedDataPropertySet) for å definere et  -->
 <!-- property set som kan legges inn i objekters AutoCAD Extended Data. De dukker da opp i alle Autodesk produkter som  -->
 <!-- objektdata / Extended Data. -->
 
 <!-- Data som ligger som Extended Data i et AutoCAD-objekt vil "bli med på lasset" over til IFC dersom du har Civil 3D installert -->
 <!-- og benytter kommandoen for eksport til IFC, EXPORTIFC. -->

	<!-- <xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" /> -->
<xpp:define name="NOBN_com_PSET_FDV_BANEDATA" >
	<xpp:bloc>
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="ObjektID" Name="FDVBaneDataObjektID" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="ObjektID" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Beskrivelse" Name="FDVBaneDataBeskrivelse" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Beskrivelse" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Tilhører objekt" Name="FDVBaneDataTilhorerObjekt" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Tilhører objekt" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Tilhører lokasjon" Name="FDVBaneDataTilhorerLokasjon" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Tilhører lokasjon" />				
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Idriftssatt dato" Name="FDVBaneDataIdriftssattDato" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Idriftssatt dato" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Km(fra)" Name="FDVBaneDataKmFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Km(fra)" />
		<LuaExpression Name="FDVBaneDataKmFra" >
			<Formula>
				if (Alignment~=nil and Alignment.RcType == "JBTKO_SPO Spor") then 
					return Mileage
				else
					local tracks = getClosestTracks()
					if tracks.Count > 0 then
						return getAlignmentInfo(getClosestTracks()[0].id, geoCoord.x, geoCoord.y).Mileage
					end
					return 0, _info("Could not find track")
				end
			</Formula>
		</LuaExpression>						
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Side(fra)" Name="FDVBaneDataSideFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Side(fra)" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Sportype(fra)" Name="FDVBaneDataSportypeFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Sportype(fra)" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Spornr.(fra)" Name="FDVBaneDataSporNrFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Spornr.(fra)" />	
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Avst/Spormidt(fra)" Name="FDVBaneDataAvstSpormidtFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Avst/Spormidt(fra)" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Eier" Name="FDVBaneDataEier" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Eier" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Nord(fra)" Name="FDVBaneDataNordFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Nord(fra)" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Øst(fra)" Name="FDVBaneDataØstFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Øst(fra)" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Høyde(fra)" Name="FDVBaneDataHøydeFra" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Høyde(fra)" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Dokument referanse" Name="FDVBaneDataDokumentReferanse" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Dokument referanse" />
		<CustomAttribute Category="Pset FDV BaneData" DataType="String" DisplayName="Serienr." Name="FDVBaneDataSerienr" DefaultValue="" 
				ExtendedDataPropertySet="FDV BaneData" ExtendedDataPropertyDefinition="Serienr." />
				

	</xpp:bloc>
</xpp:define>
<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>
<!--========================================================================================================

    NO-BN-BoardsAndPoles.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2023. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>



<!--========================================================================================================
	bnp - Boards 'n poles.
	Domain-specific Lua functions, stored in Global Extension Dictionary (not in each object).
=========================================================================================================-->
    <LuaFunction Name="NOBN_bnp_getBoardOrPoleName()" ReturnType="String"
		Description="Returns a short type name for signs (boards and poles), according to the object's variant." >
        <Constructor>String NOBN_bnp_getBoardOrPoleName()</Constructor>
        <Formula>
			function NOBN_bnp_getBoardOrPoleName()
				if Variant:find("ERTMS Level crossing, announcement") then 
					return "Fs-PLO"
				elseif Variant:find("E36 Level crossing, location") then 
					return "PLO"
				elseif Variant:find("E36 Level crossing, location") then
					s = s.."PLO"
				elseif Variant:find("ERTMS Level crossing, announcement") then
					s = s.."PLO-Fs"
				elseif Variant:find("E108 Interlocked area") then
					s = s.."Sh.start"
				elseif Variant:find("E106 Stop for shunting") then
					s = s.."Sh.slutt"
				elseif Variant:find("E107 Unsecured area with handoperated points")
					then s = s.."Sup.slutt"
				elseif Variant:find("Bevegelig kryss") then
					return "Bev.X"
				elseif Variant:find("refleks") then
					return "Refl."
				elseif Variant:find("Baliseskilt") then
					return "Balise"
				elseif Variant:find("innkoblet") then
					return "Innkobl."
				elseif Variant:find("utkoblet") then
					return "Utkobl."
				elseif Variant:find("Nødtelefon") then
					return "Nødtlf."
				elseif Variant:find("1000V") then
					return "1000V"
				elseif Variant:find("se og lytt") then
					return "Se/lytt"
				elseif Variant:find("enkeltspor") then --Veisignal
					return "138"
				elseif Variant:find("flere spor") then --Veisignal
					return "138-fler"
				elseif Variant:find("Sidespor") then
					return "Ssp."
				elseif Variant:find("Kjedebrudd") then
					return "Kj.br."
				elseif Variant:find("meterangivelse") then
					return "Meterang."
				elseif Variant:find("Spornummer") then
					return "Spornr"
				elseif Variant:find("Anleggsområde") then
					return "Anl.omr."
				elseif Variant:find("Rømningsavstand") then
					local s,r,n
					s = rel_Anything_Has_Marker
					r,n = getRelatedObjects(s)
					if n == 0 then 
						return "UNFINISHED - Relate with '"..s.."' to one or two marker objects (marking the escape route entrances)."
					else
						return "Rømn.avst."
					end
				elseif Variant:find("Arbeidsområdeskilt Type 1%-2") then
					return "Ao type 1-2"
				elseif Variant:find("Arbeidsområdeskilt Type 1%-3") then
					return "Ao type 1-3"
				elseif Variant:find("Arbeidsområdeskilt Type 2%-2") then
					return "Ao type 2-2"
				elseif Variant:find("Arbeidsområdeskilt Type 2%-3") then
					return "Ao type 2-3"	
				elseif Variant:find("Arbeidsområdeskilt Orienterende") then
					return "Ao type Orient."
				elseif Variant:match("%d+%w+-%d") then
					return Variant:match("%d+%w+-%d")
				elseif Variant:match("%d+-%w+") then
					return Variant:match("%d+-%w+")
				elseif Variant:match("%d+%w+") then
					return Variant:match("%d+%w+")
				end
			end
        </Formula>
    </LuaFunction> 


	
	<!-- TODO 2022-04-21 CLFEY The function 'RC__NumberCollection(t)' should be replaced by the standard Lua table.sort() function. -->
	<LuaFunction Name="NOBN_bnp_getEscapeDistanceBoardTexts()" ReturnType="String"
		Description="Returns a table {'Left'=Lval,'Right'=Rval} with distance to nearest related marker. Default step 10, default offset 0. '?':missing marker, '+':multiple markers found." >
		<Constructor>String NOBN_bnp_getEscapeDistanceBoardTexts([Int step[, Int offset]])</Constructor>
		<Formula>
			function NOBN_bnp_getEscapeDistanceBoardTexts(step,offset)
				local r,n,s,t,i,k,downIndex,upIndex
				if step == nil then 
					step = 10
				else
					step = math.floor(math.abs(step))
					if step == 0 then 
						step = 10 
					end
				end
				offset = offset or 0
				if this.RcType ~= rctype_SignNssEscapeRouteDistance then
					return _warning, "Bad object type ["..RcType.."], '"..rctype_SignNssEscapeRouteDistance.."' was expected"
				else
					relationName = rel_Anything_Has_Marker
					r,n = getRelatedObjects(relationName)
					s = {}
					t = {}
					for i = 1, n do
						table.insert(t,r[i-1].ReferenceMileage) --collection r is indexed from 0
					end
					t = RC__NumberCollection(t)
					k = 0
					for i = 1, n do
						if ReferenceMileage &gt; t[i] then
							k = k + 1
						end
					end
					if leftSided then
						downIndex = "Left"
						upIndex = "Right"
					else
						downIndex = "Right"
						upIndex = "Left"
					end
					if k == 0 then
						s[downIndex] = "?"
					elseif k == 1 then
						s[downIndex] = math.floor((offset + ReferenceMileage - t[k] + step/2)/step)*step
					elseif k &gt;= 1 then
						s[downIndex] = math.floor((offset + ReferenceMileage - t[k] + step/2)/step)*step.."+"
					end
					if k == n then
						s[upIndex] = "?"
					elseif k == n-1 then
						s[upIndex] = math.floor((offset + t[k+1] - ReferenceMileage + step/2)/step)*step
					elseif k &lt;= n-2 then
						s[upIndex] = math.floor((offset + t[k+1] - ReferenceMileage + step/2)/step)*step.."+"
					end
				end
				return s
			end
		</Formula>
	</LuaFunction>

	
	
	<LuaFunction Name="NOBN_bnp_getEscapeDistanceBoardTextLeft()" ReturnType="String"
			Description="Returns distance from escape route board to a left-sided related marker. '?':No marker found in arrow direction. '+':Multiple markers found in arrow direction. denoting the emergency exit (with optional step and offset). Default step size is 10. Default offset is 0." >
		<Constructor>String NOBN_bnp_getEscapeDistanceBoardTextLeft([[Int step[, Int offset]])</Constructor>
		<Formula>
			function NOBN_bnp_getEscapeDistanceBoardTextLeft(step,offset)
				if Variant:lower():match("venstre") or Variant:lower():match("begge") then
						return NOBN_bnp_getEscapeDistanceBoardTexts(step,offset)["Left"] 
					else 
						return "-", _info("Relate escape distance board to a marker with relation '"..rel_Anything_Has_Marker.."'.")
				end
			end
		</Formula>
	</LuaFunction>


	
	<LuaFunction Name="NOBN_bnp_getEscapeDistanceBoardTextRight()" ReturnType="String"
			Description="Returns distance from escape route board to a right-sided related marker. '?':No marker found in arrow direction. '+':Multiple markers found in arrow direction. denoting the emergency exit (with optional step and offset). Default step size is 10. Default offset is 0." >
		<Constructor>String NOBN_bnp_getEscapeDistanceBoardTextRight([[Int step[, Int offset]])</Constructor>
		<Formula>
			function NOBN_bnp_getEscapeDistanceBoardTextRight(step,offset)
				if Variant:lower():match("høyre") or Variant:lower():match("begge") then
					return NOBN_bnp_getEscapeDistanceBoardTexts(step,offset)["Right"]
				else 
					return "-", _info("Relate escape distance board to a marker with relation '"..rel_Anything_Has_Marker.."'.")
				end
			end
		</Formula>
	</LuaFunction>



<!--========================================================================================================
	BOARDS
	TRAIN DRIVERS
	ERTMS SIGNALLING BOARDS (not signals)
=========================================================================================================-->
	<!-- ERTMS boards with pole. (signals should feature the "mast foot"). -->
	<!-- TODO: Re-distribute ETCS signs to various EULYNX classes, there are several to choose from, such as EtcsSpeedChangeMarker or EtcsLevelTransitionMarker. -->
	<ObjectType DataType="tSignal" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignEtcsSignal" Name="JBTSA_MSS ERTMS Signalskilt"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/ERTMS Signalskilt"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
		<RelationSpace>ertms_skilt</RelationSpace>
		<AttachmentCategory Name="ertms_skilt" />
		<AttachTo Category="ertms_skilt" />
		<AttachTo Category="markerboard" />
		<AttachTo Category="skiltfeste" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_SIGNAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<LuaExpression Name="IsyPostnotat" ><Formula>NOBN_bnp_getBoardOrPoleName().." - "..code</Formula></LuaExpression> 

		<Variants>
			<Variant Name="E106 Stop for shunting" >
				<SetValue Key="type" Value="other:ertmsStopForShunting" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E107 Unsecured area with handoperated points" >
				<SetValue Key="type" Value="other:ertmsUnsecuredAreaWithHandoperatedPoints" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<!-- Removed from Bane NOR TRV? -->
			<!-- <Variant Name="E108 Interlocked area" > -->
				<!-- <SetValue Key="type" Value="other:ertmsInterlockedArea" /> -->
				<!-- <SetValue Key="switchable" Value="false" /> -->
				<!-- <SetValue Key="virtual" Value="true" /> -->
				<!-- <SetValue Key="ruleCode" Value="" /> -->
			<!-- </Variant> -->
			<Variant Name="E36 Level crossing, location" >
				<SetValue Key="type" Value="other:ertmsLevelCrossingLocation" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E36 Level crossing, announcement" >
				<SetValue Key="type" Value="other:ertmsLevelCrossingAnnouncement" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E38 Avalanche area" >
				<SetValue Key="type" Value="other:ertmsAvalancheArea" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E39 Frost gate" >
				<SetValue Key="type" Value="other:ertmsFrostGate" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E200 Level zero" >
				<SetValue Key="type" Value="other:ertmsLevelZero" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E201 Level transition ETCS" >
				<SetValue Key="type" Value="other:ertmsLevelTransitionEtcs" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E202 Speed restriction 10" >
				<SetValue Key="type" Value="other:ertmsSpeedRestriction10" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E202 Speed restriction 20" >
				<SetValue Key="type" Value="other:ertmsSpeedRestriction20" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E202 Speed restriction 30" >
				<SetValue Key="type" Value="other:ertmsSpeedRestriction30" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E202 Speed restriction lifted" >
				<SetValue Key="type" Value="other:ertmsSpeedRestrictionLifted" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
			<Variant Name="E206 GSM-R network Norway" >
				<SetValue Key="type" Value="other:ertmsGsmNetworkNorway" />
				<SetValue Key="switchable" Value="false" />
				<SetValue Key="virtual" Value="true" />
				<SetValue Key="ruleCode" Value="" />
			</Variant>
		</Variants>

<!-- @KNHEL: Fullfør objekter / varianter / InsertPointObject, 2D-symboler og 3D modeName formel for alle disse: -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E37A-LEVEL-TRANSITION -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E37B-LEVEL-0 -->

<!-- @KNHEL: Fullfør objekter / varianter / InsertPointObject, 2D-symboler og 3D modeName formel for alle disse: -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E200-LEVEL-ZERO -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E201-LEVEL-TRANSITION-ETCS -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E202-SPEED-RESTRICTION-10 -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E203-SPEED-RESTRICTION-20 -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E204-SPEED-RESTRICTION-30 -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E205-SPEED-RESTRICTION-LIFTED -->
<!-- NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-E206-SELECT-GSM-R-NETWORK-NORWAY -->

<!-- @KNHEL: Fullfør objekter / varianter / InsertPointObject, 2D-symboler og 3D modeName formel for alle disse: -->
<!--TODO - RcType "JBTEH_BKT ERTMS Strømavtagerskilt", 2D-symboler: -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E65H-WARNING-LOWERING-OF-PANTOGRAPH -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E65H-WARNING-LOWERING-OF-PANTOGRAPH -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E65K-RAISING-OF-PANTOGRAPH -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E65L-WARNING-OF-DEAD-SECTION -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E65M-DISCONNECTION-IN-DEAD-SECTION -->
<!-- NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-E65N-CONNECTION-AFTER-DEAD-SECTION -->

<!-- @KNHEL: Fullfør objekter / varianter / InsertPointObject, 2D-symboler og 3D modeName formel for alle disse: -->
<!--TODO - RcType "JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-E61-DISTANCE", 2D-symboler: -->

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<!-- Add Lua expressions from 'bnp' since these signals are physically just boards: -->
		<LuaExpression Name="Geometry3D_0.PoleRouting3D" ><Formula>NOBN_bnp_getPoleRoutingDefaultValue()</Formula></LuaExpression>
		<LuaExpression Name="Geometry3D_0.Offset3D.Z" ><Formula>NOBN_bnp_getBoardOffset3DZ()</Formula></LuaExpression>

		<LuaExpression Name="Geometry3D_0.Name" ><Formula>_JBTSA_MSS_ertms_signalBoard_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_MSS_ertms_signalBoard_Geometry3DName()" ReturnType="String"
				HideFromUser="false"
				Description="Returns the 3D model name [String] for the ERTMS board. Covers various ERTMS board types, except stop/location markerboards." >
			<Constructor>String _JBTSA_MSS_ertms_signalBoard_Geometry3DName()</Constructor>
			<Formula>
				function _JBTSA_MSS_ertms_signalBoard_Geometry3DName()
					--Board type:
					t = "NO-BN-3D-SA-MSS"
					
					if Variant == "E106 Stop for shunting" then 
						return t.."-E106-STOP-FOR-SHUNTING"
					
					elseif Variant == "E107 Unsecured area with handoperated points" then
						return t.."-E107-UNSECURED-AREA"
					
					--Removed from Bane NOR TRV?
					--elseif Variant == "E108 Interlocked area" then 
						--return t.."-E108-INTERLOCKED-AREA"
					
					elseif Variant == "E36 Level crossing, location" then 
						return t.."-E36-LEVEL-CROSSING"
					
					elseif Variant == "ERTMS Level crossing, announcement" then 
						--Same 3D as the LX signal:
						return t.."-E36-LEVEL-CROSSING"
					
					elseif Variant == "E38 Avalanche area" then 
						return t.."-E38-AVALANCHE-AREA"
					
					elseif Variant == "E39 Frost gate" then 
						return t.."-E39-FROST-GATE"
					
					else
						return "ERROR - Unrecognized variant ["..Variant.."], cannot determine 3D Model Name.",_error
					end
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject VariantName="E106 Stop for shunting" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-ERTMS-SHUNTING-AREA-END-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="E107 Unsecured area with handoperated points" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-ERTMS-SUPERVISED-AREA-END-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<!-- Removed from Bane NOR TRV? -->
		<!-- <InsertPointObject VariantName="E108 Interlocked area" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-ERTMS-SHUNTING-AREA-BEGIN-{{SymbolMode}}" -->
				<!-- DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" > -->
			<!-- <OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> -->
			<!-- <JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" /> -->
		<!-- </InsertPointObject> -->

		<InsertPointObject VariantName="E36 Level crossing, location" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-ERTMS-LEVEL-CROSSING-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="ERTMS Level crossing, announcement" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-ERTMS-LEVEL-CROSSING-ANNOUNCE-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="E38 Avalanche area" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-ERTMS-AVALANCHE-AREA-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="E39 Frost gate" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-ERTMS-FROST-GATE-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_MSS
				SKILT-ERTMS
				{%    if Variant == 'E106 Stop for shunting' %}SHUNTING-AREA-END
				{% elsif Variant == 'E107 Unsecured area with handoperated points' %}SUPERVISED-AREA-END
				{% elsif Variant == 'E36 Level crossing, location' %}LEVEL-CROSSING
				{% elsif Variant == 'ERTMS Level crossing, announcement' %}LEVEL-CROSSING-ANNOUNCE
				{% elsif Variant == 'E38 Avalanche area' %}AVALANCHE-AREA
				{% elsif Variant == 'E39 Frost gate' %}FROST-GATE
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{% if PortalMounted %}PORTAL{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
				<!-- Removed from Bane NOR TRV? -->
				<!-- {% elsif Variant == 'E108 Interlocked area' %}SHUNTING-AREA-BEGIN -->
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />
		
		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<!-- Ingen displaypoints - 2D-symbolet settes der InsertionPoint er -->

	</ObjectType>



<!--========================================================================================================
	BOARDS
	TRAIN DRIVERS
	ID BOARDS
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignEtcsId" Name="JBTSA_MSS Signal E101 ERTMS Identifikasjonsskilt"
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/ERTMS ID-skilt"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="markerboard" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<!-- Names are given explicitly, not through the usual naming formula for boards and poles -->
		<Variants>
			<Variant Name="Signal E101-A ID-skilt, Indre, 400x325, hvit" >
				<SetValue Key="name" Value="ID ERTMS (Indre)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101A-400x325-ERTMS-ID-INNER-MARKER-BOARD-90-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-B ID-skilt, Innkjør, 400x325, gul" >
				<SetValue Key="name" Value="ID ERTMS (Innkjør)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101B-400x325-ERTMS-ID-ENTRANCE-MARKER-BOARD-90-90-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-C ID-skilt, Utkjør, Ø400, gul" >
				<SetValue Key="name" Value="ID ERTMS (Utkjør)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101C-Ø400-ERTMS-ID-EXIT-MARKER-BOARD-90-90-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-D ID-skilt, Blokk, Ø400, hvit" >
				<SetValue Key="name" Value="ID ERTMS (Blokk)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101D-Ø400-ERTMS-ID-BLOCK-MARKER-BOARD-90-90-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-E ID-skilt, Dverg, 160x150" >
				<SetValue Key="name" Value="ID ERTMS (Dverg)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101E-160x150-ERTMS-ID-FREE-STANDING-SHUNTING-SIGNAL-60" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-F ID-skilt, Dverg på bakken under MB i åk, 160x150" >
				<SetValue Key="name" Value="ID ERTMS (Dverg i åk)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101F-160x150-ERTMS-ID-SHUNTING-SIGNAL-BELOW-MB-IN-PORTAL-45" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="-1.7" />
			</Variant>
			<Variant Name="Signal E101-G ID-skilt, Stopp for skift, 160x150" >
				<SetValue Key="name" Value="ID ERTMS (Stopp for skift)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101G-400x325-ERTMS-ID-STOP-FOR-SHUNTING-90-90-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-H ID-skilt, Forriglet område, 160x150" >
				<SetValue Key="name" Value="ID ERTMS (Forriglet område)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101H-400x325-ERTMS-ID-INTERLOCKED-AREA-90-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-J ID-skilt, Veisikringsanlegg, 160x150" >
				<SetValue Key="name" Value="ID ERTMS (Veisikringsanlegg)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101J-400x325-ERTMS-ID-LEVEL-CROSSING-90-60-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-K ID-skilt, Snøskredområde, 160x150" >
				<SetValue Key="name" Value="ID ERTMS (Snøskredområde)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101K-400x325-ERTMS-ID-AVALANCHE-AREA-60-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal E101-L ID-skilt, Frostport, 160x150" >
				<SetValue Key="name" Value="ID ERTMS (Frostport)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-E101L-400x325-ERTMS-ID-FROST-GATE-60-90" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<CustomAttribute DataType="String" Name="ID_BOKSTAV" DisplayName="ID-skilt litra (øvre linje)" DefaultValue="" />
		<CustomAttribute DataType="String" Name="ID_NUMMER" DisplayName="ID-skilt signalnummer (midtre/øvre linje)" DefaultValue="" />
		<CustomAttribute DataType="String" Name="ID_STED" DisplayName="ID-skilt stedsforkortelse (nedre linje)" DefaultValue="" />
		<CustomAttribute DataType="String" Name="ID_KM" DisplayName="Kilometerangivelse" DefaultValue="" />
		<CustomAttribute DataType="String" Name="ID_MINDRE_SIGNAL" DisplayName="Litra/Nummer" DefaultValue="" />
						   
		<LuaExpression Name="code" ><Formula>_JBTSA_MSS_E101_code()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_MSS_E101_code()" ReturnType="String"
			Description="Returns the associated ERTMS markerboard, shunting signal or auxiliary board's code." >
		<Constructor>String _JBTSA_MSS_E101_code()</Constructor>
			<Formula>
				function _JBTSA_MSS_E101_code()
					return attachment and attachment.code or "UNFINISHED - Attach ID board to its associated ERTMS object (or if ID for low shunting signal associated with an MB in a portal above, then enter MB's ID number as ID board's 4-digit code."
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="name" ><Formula>_JBTSA_MSS_E101_name()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_MSS_E101_name()" ReturnType="String"
			Description="Returns the associated ERTMS markerboard, shunting signal or auxiliary board's code." >
		<Constructor>String _JBTSA_MSS_E101_name()</Constructor>
			<Formula>
				function _JBTSA_MSS_E101_name()
					return Attachment and "" or code
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="ID_BOKSTAV" ><Formula>NOBN_sig_getSignalLitra()</Formula></LuaExpression>
		<LuaExpression Name="ID_NUMMER" ><Formula>NOBN_sig_getSignalNumber()</Formula></LuaExpression>

		<LuaExpression Name="ID_STED" ><Formula>_JBTSA_MSS_E101_ID_STED()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_MSS_E101_ID_STED()" ReturnType="String"
			Description="Returns the associated ERTMS object's site code (2- or 3-letter abbreviation)." >
		<Constructor>String _JBTSA_MSS_E101_ID_STED()</Constructor>
			<Formula>
				function _JBTSA_MSS_E101_ID_STED()
					return Attachment and Attachment.NOBN_com_getOcpCode() or "OCP?"
				end
			</Formula>
		</LuaFunction>
		
		<LuaExpression Name="Geometry3D_0.Offset3D.Z" ><Formula>_JBTSA_MSS_E101_Offset3DZ()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_MSS_E101_Offset3DZ()" ReturnType="String" 
			Description="Returns the ERTMS ID board's placement above its insertion point." >
		<Constructor>String _JBTSA_MSS_E101_Offset3DZ()</Constructor>
			<Formula>
				function _JBTSA_MSS_E101_Offset3DZ()
					ym = Attachment and Attachment.PortalMounted or PortalMounted
					if Variant == "Signal E101-E ID-skilt, Dverg, 160x150" 
					or Variant == "Signal E101-F ID-skilt, Dverg på bakken under MB i åk, 160x150"
					then
						return ym and -1.2 or 1.2
					else
						return ym and -2.6 or 2.6
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="ID_KM" ><Formula>NOBN_trk_toKm(ReferenceMileage)</Formula></LuaExpression>
		
		<InsertPointObject VariantName="Signal E101-A ID-skilt, Indre, 400x325, hvit" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-2-ID-2-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-B ID-skilt, Innkjør, 400x325, gul" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-1-ID-3-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-C ID-skilt, Utkjør, Ø400, gul" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-3-ID-RUNDT-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-D ID-skilt, Blokk, Ø400, hvit" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-3-ID-RUNDT-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-E ID-skilt, Dverg, 160x150" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-6-ID-MINDRE-SIGNAL-300x100-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-F ID-skilt, Dverg på bakken under MB i åk, 160x150" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-6-ID-MINDRE-SIGNAL-300x100-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-G ID-skilt, Stopp for skift, 160x150" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-2-ID-2-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-H ID-skilt, Forriglet område, 160x150" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-2-ID-2-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-J ID-skilt, Veisikringsanlegg, 160x150" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-2-ID-2-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-K ID-skilt, Snøskredområde, 160x150" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-2-ID-2-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal E101-L ID-skilt, Frostport, 160x150" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-2-ID-2-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-1-ID-3-LINJER-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	

			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal E101-A ID-skilt, Indre, 400x325, hvit' %}101-2-ID-2-LINJER
				{% elsif Variant == 'Signal E101-B ID-skilt for ERTMS, 3 linjer, 400x325' %}101-1-ID-3-LINJER
				{% elsif Variant == 'Signal E101-C ID-skilt, Utkjør, Ø400, gul' %}101-3-ID-RUNDT
				{% elsif Variant == 'Signal E101-D ID-skilt, Blokk, Ø400, hvit' %}101-3-ID-RUNDT
				{% elsif Variant == 'Signal E101-E ID-skilt, Dverg, 160x150' %}101-6-ID-MINDRE-SIGNAL-300x100
				{% elsif Variant == 'Signal E101-F ID-skilt, Dverg på bakken under MB i åk, 160x150' %}101-6-ID-MINDRE-SIGNAL-300x100
				{% elsif Variant == 'Signal E101-G ID-skilt, Stopp for skift, 160x150' %}101-2-ID-2-LINJER
				{% elsif Variant == 'Signal E101-H ID-skilt, Forriglet område, 160x150' %}101-1-ID-3-LINJER
				{% elsif Variant == 'Signal E101-J ID-skilt, Veisikringsanlegg, 160x150' %}101-2-ID-2-LINJER
				{% elsif Variant == 'Signal E101-K ID-skilt, Snøskredområde, 160x150' %}101-2-ID-2-LINJER
				{% elsif Variant == 'Signal E101-L ID-skilt, Frostport, 160x150' %}101-2-ID-2-LINJER
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
			<SymbolAttribute Tag="ID_BOKSTAV" >
				<Value>{{ID_BOKSTAV}}</Value>
			</SymbolAttribute>
			<!-- Shunting signal ID board: -->
			<!-- Ref. Bane NOR document 1000001649_00E, "ERTMS Programme Design requirements - Signs and boards" (2020-04-28), -->
			<!-- chapter 4.2 Design of ID-boards for shunting signals: -->
			<!-- "Standalone shunting signal with numbers up to and including 99 shall have an R in front of the number -->
			<!-- (on the same line). As of 100, R is not used in front of the number. The only time 4 digits are used is -->
			<!-- when a MB is placed in the portal and a shunting signal on own mast below, because the shunting -->
			<!-- signal shall have the same ID as the MB." -->
			<SymbolAttribute Tag="ID_NUMMER" >
				<Value>{{ID_NUMMER}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="ID_BOKSTAV_OG_NR" >
				<!-- Used by 2-line 2D-symbol for entry MB: -->
				<Value>{{ID_BOKSTAV}} {{ID_NUMMER}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="ID_STED" >
				<Value>{{ID_STED}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="ID_MINDRE_SIGNAL" >
				<!-- In use solely by the shunting signals, which use the Class-B ID-board for shunting signals. -->
				<!-- TODO: Produce dedicated 2D-symbol with correct symbol description for all ERTMS ID boards. -->
				<Value>{% if ID_NUMMER.size &lt; 3 %}R{% endif %}{{ID_NUMMER}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<!-- T01 is used by E101-B Entry MB, E101-C Exit MB, E101D Block MB and E101-G Stop for shunting: -->
				<Value>{{ID_BOKSTAV}}</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<!-- T02 is used by E101-A Inner MB, E101-B Entry MB, E101-C Exit MB, E101D Block MB and E101-H Interlocked area: -->
				<Value>{{ID_NUMMER}}</Value>
			</Attribute>
			<Attribute Tag="T03" >
				<!-- T03 is used by E101-A Inner MB, E101-B Entry MB, E101-C Exit MB, E101D Block MB and E101-G Stop for shunting: -->
				<Value>{{ID_STED}}</Value>
			</Attribute>
			<Attribute Tag="T04" >
				<!-- T04 is used by shunting signal ID boards E101-E and E101-F. Precede with 'R' if 1 or 2 digits in code: -->
				<Value>{% if ID_NUMMER | append: "" | size &lt; 3 %}R{{ID_NUMMER}}{% else %}{{ID_NUMMER}}{% endif %}</Value>
			</Attribute>
			<Attribute Tag="T05" >
				<!-- T05 is used by E101-G Stop for shunting -->
				<Value>R</Value>
			</Attribute>
			<Attribute Tag="T06" >
				<!-- T06 is used by E101-H Interlocked area: -->
				<Value>Z</Value>
			</Attribute>
			<Attribute Tag="T07" >
				<!-- T07 is used by E101-J Level crossing: -->
				<Value>W{{ID_NUMMER}}</Value>
			</Attribute>
			<Attribute Tag="T08" >
				<!-- T08 is used by E101-J Level crossing, E101-K Avalanche area and E101-L Frost gate: -->
				<Value>km</Value>
			</Attribute>
			<Attribute Tag="T09" >
				<!-- T08 is used by E101-J Level crossing, E101-K Avalanche area and E101-L Frost gate: -->
				<Value>{{ID_KM}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
				<SnapPoint X="7" Y="7" />
				<SnapPoint X="7" Y="-7" />
				<SnapPoint X="-7" Y="7" />
				<SnapPoint X="-7" Y="-7" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/REFLEKSER
	On main signals and distant signals
	TODO 2018-07-06: Kvitte oss med attachment, skifte det ut men relation som gjør tilsvarende. Må ha det nå pga reflekser kan attaches til signaler og reflekser.
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssReflectiveMarker" Name="JBTSA_MSS Refleks på lyssignal" 
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/Reflekser"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="signal" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXATTRIBUTES___VERTICAL_AND_FAR___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___SIG" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<Variants DefaultValue="Hel refleksring for Ø127 signalmast" >
			<Variant Name="Hel refleksring for Ø127 signalmast" >
				<SetValue Key="Geometry3D_0.PoleRouting3D" Value="None" />
			</Variant>
			<Variant Name="Halv refleksring for Ø127 signalmast" >
				<SetValue Key="Geometry3D_0.PoleRouting3D" Value="None" />
			</Variant>
			<Variant Name="Flat ensidet refleks for lyssignal" >
				<SetValue Key="Geometry3D_0.PoleRouting3D" Value="Vertical" />
			</Variant>
		</Variants>
		
		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<LuaExpression Name="Geometry3D_0.Name" ><Formula>_JBTSA_MSS_Refleks_paa_lyssignal_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTSA_MSS_Refleks_paa_lyssignal_Geometry3DName()" 
				ReturnType="String"
				HideFromUser="false"
				Description="Returns the object's default 3D object model name." >
			<Constructor>String _JBTSA_MSS_Refleks_paa_lyssignal_Geometry3DName()</Constructor>
			<Formula>
				function _JBTSA_MSS_Refleks_paa_lyssignal_Geometry3DName()
					t = "NO-BN-3D-SA-MSS-REFLEKS-"
					if Variant == "Hel refleksring for Ø127 signalmast" then 
						return t.."HEL-RING-Ø127"
					elseif Variant == "Halv refleksring for Ø127 signalmast" then 
						return t.."HALV-RING-Ø127"
					elseif Variant == "Flat ensidet refleks for lyssignal" then 
						return t.."FLAT-ENKELSIDET"
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="Geometry3D_0.Offset3D.Z" >
			<Formula>
				if (Attachment.RcType == rctype_Signal) then 
					return 1.84
				elseif (Attachment.RcType == rctype_SignNssReflectiveMarker) then --stacked reflective markers on one signal, they shall be 80 cm apart according to BN rules
					return 2.91
				else 
					return 0
				end
			</Formula>
		</LuaExpression>

		<LuaExpression Name="name" ><Formula>NOBN_bnp_getBoardOrPoleName()</Formula></LuaExpression>

		<InsertPointObject VariantName="Hel refleksring for Ø127 signalmast" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-REFLEKS-HEL-{{SymbolMode}}" 
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Halv refleksring for Ø127 signalmast" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-REFLEKS-HALV-{{SymbolMode}}" 
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Flat ensidet refleks for lyssignal" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-REFLEKS-HALV-{{SymbolMode}}" 
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-REFLEKS-HEL-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-REFLEKS
				{% if Variant == 'Hel refleksring for Ø127 signalmast' %}HEL
				{% elsif Variant == 'Halv refleksring for Ø127 signalmast' %}HALV
				{% elsif Variant == 'Flat ensidet refleks for lyssignal' %}HALV
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/HØYSPENTANLEGG
	EH-BKT Signal 65 Strøm
=========================================================================================================-->
	<!-- TODO: Include the ETCS traction current signs (they exist in the 3D library) -->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssPantograph" Name="JBTEH_BKT Signal 65 Strømavtager"
				DrawTail="true"
				Layer="JBTEH_BKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Høyspentanlegg"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="kl-mast" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___OCS" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_EH_BKT" />

		<Variants DefaultValue="Signal 65A Jordet seksjon" >
			<Variant Name="Signal 65A Jordet seksjon" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65A-JORDET-SEKSJON" />
			</Variant>
			<Variant Name="Signal 65B Varselsignal for kontaktledningssignal" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65B-VARSELSIGNAL-FOR-KL-SIGNAL" />
			</Variant>
			<Variant Name="Signal 65C Utkobling foran dødseksjon" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65C-UTKOBLING-FORAN-DØDSEKSJON" />
			</Variant>
			<Variant Name="Signal 65D Innkobling etter dødseksjon" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65D-INNKOBLING-ETTER-DØDSEKSJON" />
			</Variant>
			<Variant Name="Signal 65E Senking av strømavtaker" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65E-SENK-STRØMAVTAGER" />
			</Variant>
			<Variant Name="Signal 65F Heving av strømavtaker" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65F-HEV-STRØMAVTAGER" />
			</Variant>
			<Variant Name="Signal 65G-1 Stopp for elektrisk lokomotiv" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65G-1-STOPP-FOR-ELEKTRISK-LOK" />
			</Variant>
			<Variant Name="Signal 65G-2 Stopp for elektrisk lokomotiv, strømløst mot høyre" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65G-2-STOPP-FOR-ELEKTRISK-LOK-H" />
			</Variant>
			<Variant Name="Signal 65G-3 Stopp for elektrisk lokomotiv, strømløst mot venstre" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-EH-BKT-SKILT-65G-3-STOPP-FOR-ELEKTRISK-LOK-V" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 65A Jordet seksjon" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65A-JORDETSEKSJON-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65B Varselsignal for kontaktledningssignal" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65B-KONTAKTLEDNING-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65C Utkobling foran dødseksjon" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65C-UTKOBLING-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65D Innkobling etter dødseksjon" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65D-INNKOBLING-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65E Senking av strømavtaker" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65E-SENKSTROEMAVTAKER-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65F Heving av strømavtaker" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65F-HEVSTROEMAVTAKER-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65G-1 Stopp for elektrisk lokomotiv" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65G-1-STOPPELLOK-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65G-2 Stopp for elektrisk lokomotiv, strømløst mot høyre" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65G-2-STOPPELLOK-VSIDE-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 65G-3 Stopp for elektrisk lokomotiv, strømløst mot venstre" DisplayBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65G-3-STOPPELLOK-VSIDE-{{SymbolMode}}"
                DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL-65A-JORDETSEKSJON-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy='-'>
				NO-BN-2D-JBTEH_BKT-SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal 65A Jordet seksjon' %}65A-JORDETSEKSJON
				{% elsif Variant == 'Signal 65B Varselsignal for kontaktledningssignal' %}65B-KONTAKTLEDNING
				{% elsif Variant == 'Signal 65C Utkobling foran dødseksjon' %}65C-UTKOBLING
				{% elsif Variant == 'Signal 65D Innkobling etter dødseksjon' %}65D-INNKOBLING
				{% elsif Variant == 'Signal 65E Senking av strømavtaker' %}65E-SENKSTROEMAVTAKER
				{% elsif Variant == 'Signal 65F Heving av strømavtaker' %}65F-HEVSTROEMAVTAKER
				{% elsif Variant == 'Signal 65G-1 Stopp for elektrisk lokomotiv' %}65G-1-STOPPELLOK
				{% elsif Variant == 'Signal 65G-2 Stopp for elektrisk lokomotiv, strømløst mot høyre' %}65G-2-STOPPELLOK-VSIDE
				{% elsif Variant == 'Signal 65G-3 Stopp for elektrisk lokomotiv, strømløst mot venstre' %}65G-3-STOPPELLOK-VSIDE
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Signal 66 Togvei slutt
	Signal 66, Togvei slutt, selve skiltplata, ikke signalet som sluttpunkt for togvei
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssEndOfTrainRoute" Name="JBTKO_SKT Signal 66 Togvei slutt"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
		<AttachTo Category="signal" DrawTail="true" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<Variants DefaultValue="66 Togvei slutt" >
			<Variant Name="66 Togvei slutt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-66-TOGVEI-SLUTT" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="66 Togvei slutt" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-66-TOGVEI-SLUTT-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-66-TOGVEI-SLUTT-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/ORIENTERINGSSIGNALER
	JBTKO_SKT Signal 67 Orienteringssignal
	Orienteringssignal for PLO/plattform - dag/natt - ikke bruk tyfon nattestid, eller på angitte klokkeslett
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssGiveAudibleSignal" Name="JBTKO_SKT Signal 67 Orienteringssignal" 
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Orienteringssignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<Variants DefaultValue="Signal 67A Orienteringssignal" >
			<Variant Name="Signal 67A Orienteringssignal" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-67A-ORIENTERINGSSIGNAL" />
			</Variant>
			<Variant Name="Signal 67B Orienteringssignal for planovergang" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-67B-ORIENTERINGSSIGNAL-FOR-PLANOVERGANG" />
			</Variant>
			<Variant Name="Signal 67C Orienteringssignal for holdeplass" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-67C-ORIENTERINGSSIGNAL-FOR-HOLDEPLASS" />
			</Variant>
			<Variant Name="Signal 67D Orienteringssignal for planovergang og holdeplass" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-67D-ORIENTERINGSSIGNAL-FOR-PLANOVERGANG-OG-HOLDEPLASS" />
			</Variant>
			<Variant Name="Signal 67E Orienteringssignal dagtid" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-67E-ORIENTERINGSSIGNAL-DAGTID" />
			</Variant>
		</Variants>

		<InsertPointObject VariantName="Signal 67A Orienteringssignal" DisplayName="67A Orienteringssignal" 
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-67A-ORIENTERINGSIGNAL-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
	
		<InsertPointObject VariantName="Signal 67B Orienteringssignal for planovergang"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-67B-ORIENTERINGSIGNAL-PLANOVERGANG-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 67C Orienteringssignal for holdeplass"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-67C-ORIENTERINGSIGNAL-HOLDEPLASS-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 67D Orienteringssignal for planovergang og holdeplass"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-67D-ORIENTERINGSIGNAL-PLANOVERGANG-HOLDEPLASS-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<!-- TODO Skilt natt/dag mangler som 3D-objekt -->
		<InsertPointObject VariantName="Signal 67E Orienteringssignal dagtid"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-67E-ORIENTERINGSIGNAL-DAGTID-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-67A-ORIENTERINGSIGNAL-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy='-'>
				NO-BN-2D-JBTKO_SKT
				SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal 67A Orienteringssignal' %}67A-ORIENTERINGSIGNAL
				{% elsif Variant == 'Signal 67B Orienteringssignal for planovergang' %}67B-ORIENTERINGSIGNAL-PLANOVERGANG
				{% elsif Variant == 'Signal 67C Orienteringssignal for holdeplass' %}67C-ORIENTERINGSIGNAL-HOLDEPLASS
				{% elsif Variant == 'Signal 67D Orienteringssignal for planovergang og holdeplass' %}67D-ORIENTERINGSIGNAL-PLANOVERGANG-HOLDEPLASS
				{% elsif Variant == 'Signal 67E Orienteringssignal dagtid' %}67E-ORIENTERINGSIGNAL-DAGTID
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/HASTIGHETSSIGNALER
	JBTKO_SKT Signal 68/69 hastighetssignal
	Permanente og midlertidige hastighetsgrenser og -varsler. Sporvekselhastigheter.
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssSpeedRestriction" Name="JBTKO_SKT Signal 68/69 hastighetssignal"
				DrawTail="true"
                Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Hastighetssignaler"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" /> 
		<AttachTo Category="signal" DrawTail="true" />
		<AttachTo Category="kl-mast" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />
				
		<Variants DefaultValue="68A Nedsatt hastighet" >
			<Variant Name="Signal 68A Nedsatt hastighet" >
			</Variant>
			<Variant Name="Signal 68B Økt hastighet" >
			</Variant>
			<Variant Name="Signal 68C Avvikende hastighet" >
			</Variant>
			<Variant Name="Signal 68D-1 Markeringsmerke" >
			</Variant>
			<Variant Name="Signal 68D-2 Markeringsmerke på motrettet 68B" >
			</Variant>
			<Variant Name="Signal 68D-3 Markeringsmerke på motrettet 69B" >
			</Variant>
			<Variant Name="Signal 68F Tilleggshastighet" >
			</Variant>
			<Variant Name="Signal 68G Hastighet for krengetog" >
			</Variant>
			<Variant Name="Signal 69A Midlertidig nedsatt hastighet" >
			</Variant>
			<Variant Name="Signal 69B Midlertidig hastighet opphører" >
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<CustomAttribute DataType="UInt32" Name="SignSpeed" DisplayName="Hastighet" DefaultValue="120" />
		<CustomAttribute DataType="UInt32" Name="SignPlusSpeed" DisplayName="Plusshastighet" DefaultValue="5" />
		<CustomAttribute DataType="UInt32" Name="SignTiltSpeed" DisplayName="Krengetoghastighet" DefaultValue="160" />
				
		<CustomAttribute DataType="String" ReadOnly="true" Category="Model check" Name="mc_SpeedTargetBoardVariant" DisplayName="Markeringsmerke variant" 
			Description="Assessment that the 68D subtype 1/2/3 speed target board matches the presence or absence of a nearby counter-directed 68B 'Increased speed' or 69B 'End of Temporary Speed Restriction'." />
		<LuaExpression Name="mc_SpeedTargetBoardVariant" IsModelCheck="true" ><Formula>_JBTKO_SKT_chkSpeedTargetBoardVariant()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SKT_chkSpeedTargetBoardVariant()" ReturnType="String"
			Description = "Model check assessing that the 68D subtype 1/2/3 speed target board matches the presence or absence of a nearby counter-directed 68B 'Increased speed' or 69B 'End of Temporary Speed Restriction" >
			<Constructor>String _JBTKO_SKT_chkSpeedTargetBoardVariant()</Constructor>
			<Formula>
				function _JBTKO_SKT_chkSpeedTargetBoardVariant()
					if Variant:match("68D") then 
						local tol = 1.0 --[m]
						local obj68B = getNearbyPointObjects2D(tol,RcType):filter(function (x) return x.Variant:match("68B") end)
						local obj69B = getNearbyPointObjects2D(tol,RcType):filter(function (x) return x.Variant:match("69B") end)
						local n68B = getCollectionLength(obj68B)
						local n69B = getCollectionLength(obj69B)
						if Variant:match("68D%-1") then
							if n68B &gt; 0 then 
								return "WARNING - Variant should be 68D-2 due to the nearby counter-directed board 68B.",_warning
							elseif n69B &gt; 0 then 
								return "WARNING - Variant should be 68D-3 due to the nearby counter-directed board 69B.",_warning
							else 
								return "OK - No nearby counter-directed board 68B or 69B",_ok
							end
						elseif Variant:match("68D%-2") then
							if n68B == 0 and n69B == 0 then 
								return "WARNING - Variant should be 68D-1 since there is no nearby counter-directed board 68B or 69B.",_warning
							elseif n68B == 0 and n69B &gt; 0 then 
								return "WARNING - Variant should be 68D-3 due to the nearby counter-directed board 69B.",_warning
							elseif n68B &gt; 0 then
								return "OK - A nearby counter-directed board 68B was found.",_ok
							end
						elseif Variant:match("68D%-3") then
							if n68B == 0 and n69B == 0 then 
								return "WARNING - Variant should be 68D-1 since there is no nearby counter-directed board 68B or 69B.",_warning
							elseif n68B &gt; 0 and n69B == 0 then 
								return "WARNING - Variant should be 68D-2 due to the nearby counter-directed board 68B.",_warning
							elseif n69B &gt; 0 then
								return "OK - A nearby counter-directed board 69B was found.",_ok
							end
						end
					end
				end
			</Formula>
		</LuaFunction> 

		<CustomAttribute DataType="String" ReadOnly="true" Category="Model check" Name="mc_NearbySpeedBoardsToBeModelchecked"
			DisplayName="Andre objekter som modelsjekkes" 
			Description="When this speed board object is modelchecked, then nearby speed boards are modelchecked as well." />
		<LuaExpression Name="mc_NearbySpeedBoardsToBeModelchecked" IsModelCheck="true" ><Formula>_JBTKO_SKT_chkTriggerNearbySpeedBoards()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SKT_chkTriggerNearbySpeedBoards()" ReturnType="String"
			Description="Triggers modelchecking in nearby speed boards." >
			<Constructor>_JBTKO_SKT_chkTriggerNearbySpeedBoards()</Constructor>
			<Formula>
				function _JBTKO_SKT_chkTriggerNearbySpeedBoards()
					local tol = 1.0 --[m]
					local speedBoards = getNearbyPointObjects2D(tol,RcType)
					local n = getCollectionLength(speedBoards)
					return n,speedBoards, _info(n.." speed boards have been modelchecked.")
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="Geometry3D_0.Name" ><Formula>_JBTKO_SKT_68_69_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SKT_68_69_Geometry3DName()" 
				ReturnType="String"
				HideFromUser="false"
				Description="Returns the 68/69 board's default 3D object model name." >
			<Constructor>String _JBTKO_SKT_68_69_Geometry3DName()</Constructor>
			<Formula>
				function _JBTKO_SKT_68_69_Geometry3DName()
					t = "NO-BN-3D-KO-SKT-SKILT-"
					if Variant == "Signal 68A Nedsatt hastighet"						then return t.."68A-NEDSATT-KJØREHASTIGHET"
					elseif Variant == "Signal 68B Økt hastighet"						then return t.."68B-ØKT-KJØREHASTIGHET"
					elseif Variant == "Signal 68C Avvikende hastighet"					then return t.."68C-AVVIKENDE-HASTIGHET"
					elseif Variant == "Signal 68D-1 Markeringsmerke"					then return t.."68D-MARKERINGSMERKE"
					elseif Variant == "Signal 68D-2 Markeringsmerke på motrettet 68B"	then return t.."68D-MARKERINGSMERKE"
					elseif Variant == "Signal 68D-3 Markeringsmerke på motrettet 69B"	then return t.."68D-MARKERINGSMERKE"
					elseif Variant == "Signal 68F Tilleggshastighet"					then return t.."68F-TILLEGGSHASTIGHET"
					elseif Variant == "Signal 68G Hastighet for krengetog"				then return t.."68G-HASTIGHET-FOR-KRENGETOG"
					elseif Variant == "Signal 69A Midlertidig nedsatt hastighet"		then return t.."69A-MIDLERTIDIG-NEDSATT-HASTIGHET"
					elseif Variant == "Signal 69B Midlertidig hastighet opphører"		then return t.."69B-MIDLERTIDIG-HASTIGHET-OPPHØRER"
					else
						return "ERROR - Bad Variant ["..Variant.."]."
					end
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject VariantName="Signal 68A Nedsatt hastighet" DisplayName="68A Nedsatt hastighet"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68A-NEDSATT-HASTIGHET-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignSpeed" Value="40" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 68B Økt hastighet" DisplayName="68B Økt hastighet"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68B-OEKT-HASTIGHET-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignSpeed" Value="80" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 68C Avvikende hastighet" DisplayName="68C Avvikende hastighet"
					DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68C-NEDSATT-HASTIGHET-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignSpeed" Value="50" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 68D-1 Markeringsmerke" DisplayName="68D-1 Markeringsmerke"
					DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68D-1-MARKERINGSMERKE-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignSpeed" Value="40" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 68D-2 Markeringsmerke på motrettet 68B" DisplayName="68D-2 Markeringsmerke på motrettet 68B"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68D-2-MARKERINGSMERKE-MOTRETTET-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignSpeed" Value="40" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 68D-3 Markeringsmerke på motrettet 69B" DisplayName="68D-3 Markeringsmerke på motrettet 69B"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68D-3-MARKERINGSMERKE-MOTRETTET-MIDLERTIDIG-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignSpeed" Value="40" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 68F Tilleggshastighet" DisplayName="68F Tilleggshastighet (underskilt)"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68F-TILLEGGSHASTIGHET-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignPlusSpeed" Value="5" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 68G Hastighet for krengetog" DisplayName="68G Hastighet for krengetog"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68G-HASTIGHET-KRENGETOG-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="SignTiltSpeed" Value="160" />
		</InsertPointObject>
		
		<!-- Fastened to rail using a special clamp (pole is drawn to rail). Assume board is max 40 cm wide, the train needs 2.12 free space. -->
		<InsertPointObject VariantName="Signal 69A Midlertidig nedsatt hastighet" DisplayName="69A Midlertidig nedsatt hastighet"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-69A-MIDLERTIDIG-NEDSATT-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="0.75" > 
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="RelativeElevation" Value="-0.15" />
			<SetValue Key="SignSpeed" Value="40" />
			<SetValue Key="OffsetTowardsSide3D" Value="-1.75" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 69B Midlertidig hastighet opphører" DisplayName="69B Midlertidig hastighet opphører"
				DisplayBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-69B-MIDLERTIDIG-OPPHOERER-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="0.75" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
			<SetValue Key="RelativeElevation" Value="-0.15" />
			<SetValue Key="SignSpeed" Value="80" />
			<SetValue Key="OffsetTowardsSide3D" Value="-1.75" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTKO_SKT-SKILT-KJOERENDE-SIGNAL-68A-NEDSATT-HASTIGHET-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTKO_SKT
				SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal 68A Nedsatt hastighet' %}68A-NEDSATT-HASTIGHET
				{% elsif Variant == 'Signal 68B Økt hastighet' %}68B-OEKT-HASTIGHET
				{% elsif Variant == 'Signal 68C Avvikende hastighet' %}68C-NEDSATT-HASTIGHET
				{% elsif Variant == 'Signal 68D-1 Markeringsmerke' %}68D-1-MARKERINGSMERKE
				{% elsif Variant == 'Signal 68D-2 Markeringsmerke på motrettet 68B' %}68D-2-MARKERINGSMERKE-MOTRETTET
				{% elsif Variant == 'Signal 68D-3 Markeringsmerke på motrettet 69B' %}68D-3-MARKERINGSMERKE-MOTRETTET-MIDLERTIDIG
				{% elsif Variant == 'Signal 68F Tilleggshastighet' %}68F-TILLEGGSHASTIGHET
				{% elsif Variant == 'Signal 68G Hastighet for krengetog' %}68G-HASTIGHET-KRENGETOG
				{% elsif Variant == 'Signal 69A Midlertidig nedsatt hastighet' %}69A-MIDLERTIDIG-NEDSATT
				{% elsif Variant == 'Signal 69B Midlertidig hastighet opphører' %}69B-MIDLERTIDIG-OPPHOERER
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
			
			<SymbolAttribute Tag="HAST_10" >
				<!--'v10' DotLiquid funksjon: Returnerer input div 10 (input er en float railML verdi) -->
				<Value>{{SignSpeed | v10}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HAST_5" >
				<!--'v5' DotLiquid funksjon: Dersom hastighet ender på 0..4 så returneres 0, ellers returneres 5-->
				<Value>{{SignSpeed | v5}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="PLUSS_HAST" >
				<Value>+{{SignPlusSpeed}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="KRENGE_HAST" >
				<Value>{{SignTiltSpeed}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{SignSpeed | v10}}</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>{{SignSpeed | v5}}</Value>
			</Attribute>
			<Attribute Tag="T03" >	
				<Value>+{{SignPlusSpeed}}</Value>
			</Attribute>
			<Attribute Tag="T04" >
				<Value>{{SignTiltSpeed}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	SA-MSS Skilt meterangivelse
	Underskilt for meterangivelse til målpunkt, evt for annet formål
	TODO: BANEDATA KODING MANGLER (sist sjekket: 2020-10-06)
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssTargetDistance" Name="JBTSA_MSS Skilt meterangivelse (målavstand)"
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<CustomAttribute DataType="UInt32" Name="TargetDistance" DisplayName="Avstand i meter" DefaultValue="300" />

		<Variants>
			<Variant Name="Meterangivelse (underskilt)" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-METERANGIVELSE" />
			</Variant>
		</Variants>
	
		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />	   
	
		<InsertPointObject VariantName="Meterangivelse (underskilt)" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-UNDERSKILT-METERANGIVELSE-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-UNDERSKILT-METERANGIVELSE-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<SymbolAttribute Tag="AVSTAND" >
				<Value>{{TargetDistance}}m</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{TargetDistance}}m</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/ATC
	JBTSA_MSS Signal 60 ATC
	Signal 60 ATC-skilt som ikke egentlig kan hektes på lyssignaler (dvs alle 60-skilt unntatt 60E)
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssAtp" Name="JBTSA_MSS Signal 60 ATC"
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/ATC"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<!-- Merk: Skilt 60E "ATC Varsel" er gruppert sammen med Ugyldighetsskilt, kan bare hektes på et signal -->
		<Variants DefaultValue="Signal 60D ATC repeter hastighet" >
			<Variant Name="Signal 60A ATC forsignal" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60A-ATC-FORSIGNAL" />
			</Variant>
			<Variant Name="Signal 60B ATC repeter målpunkt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60B-ATC-REPETER-MÅLPUNKT" />
			</Variant>
			<Variant Name="Signal 60C ATC nødbrems" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60C-ATC-NØDBREMS" />
			</Variant>
			<Variant Name="Signal 60D ATC repeter hastighet" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60D-ATC-REPETER-HASTIGHET" />
			</Variant>
			<Variant Name="Signal 60D ATC repeter hastighet 10 km/h" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60D-10-ATC-REPETER-HASTIGHET-10" />
			</Variant>
			<Variant Name="Signal 60D ATC repeter hastighet 40 km/h" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60D-40-ATC-REPETER-HASTIGHET-40" />
			</Variant>
			<Variant Name="Signal 60F FATC" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60F-FATC" />
			</Variant>
			<Variant Name="Signal 60G DATC" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60G-DATC" />
			</Variant>
			<Variant Name="Signal 60H ATC slutter" > <!--Grå bakgrunn, 'ATC' overstrøket, alle de andre FATC/DATC har gul bakgrunn-->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60H-ATC-SLUTTER" />
			</Variant>
			<Variant Name="Signal 60F FATC begynner (gammel type)" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60F-FATC-TILLEGGSTEKST" />
			</Variant>
			<Variant Name="Signal 60G DATC begynner (gammel type)" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60G-DATC-TILLEGGSTEKST" />
			</Variant>
			<Variant Name="Signal ATC innkoblet" > <!--ATC innkoblet/utkoblet, S.047608/9, har ikke eget nummer i SJT TFF-->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60-ATC-INNKOBLET" />
			</Variant>
			<Variant Name="Signal ATC utkoblet" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60-ATC-UTKOBLET" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 60A ATC forsignal" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60A-ATC-FORSIGNAL-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 60B ATC repeter målpunkt" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60B-ATC-REPETER-MAALPUNKT-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 60C ATC nødbrems" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60C-ATC-NOEDBREMS-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 60D ATC repeter hastighet" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60D-ATC-REPETER-HASTIGHET-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Signal 60D ATC repeter hastighet 10 km/h" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60D-ATC-REPETER-HASTIGHET-10-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Signal 60D ATC repeter hastighet 40 km/h" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60D-ATC-REPETER-HASTIGHET-40-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<!-- 60E: Se lenger opp, skilt som bare kan hektes på lyssignaler -->
		<InsertPointObject VariantName="Signal 60F FATC" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60F-FATC-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 60G DATC" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60G-DATC-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Signal 60H ATC slutter" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60H-ATC-SLUTTER-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 60F FATC begynner (gammel type)" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60F-FATC-TILLEGGSTEKST-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 60G DATC begynner (gammel type)" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60G-DATC-TILLEGGSTEKST-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal ATC innkoblet" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-ATC-INNKOBLET-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" /> <!--Har ikke eget signalnummer hos Bane NOR-->
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal ATC utkoblet" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-ATC-UTKOBLET-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<!--TODO mangler 2D-symbol for visning av 60H, kan lages fra 'FJS slutter'-->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK
				SKILT-KJOERENDE
				{%    if Variant == 'Signal 60A ATC forsignal' %}SIGNAL-60A-ATC-FORSIGNAL
				{% elsif Variant == 'Signal 60B ATC repeter målpunkt' %}SIGNAL-60B-ATC-REPETER-MAALPUNKT
				{% elsif Variant == 'Signal 60C ATC nødbrems' %}SIGNAL-60C-ATC-NOEDBREMS
				{% elsif Variant == 'Signal 60D ATC repeter hastighet' %}SIGNAL-60D-ATC-REPETER-HASTIGHET
				{% elsif Variant == 'Signal 60D ATC repeter hastighet 10 km/h' %}SIGNAL-60D-ATC-REPETER-HASTIGHET-10
				{% elsif Variant == 'Signal 60D ATC repeter hastighet 40 km/h' %}SIGNAL-60D-ATC-REPETER-HASTIGHET-40
				{% elsif Variant == 'Signal 60F FATC' %}SIGNAL-60F-FATC
				{% elsif Variant == 'Signal 60F FATC begynner (gammel type)' %}SIGNAL-60F-FATC-TILLEGGSTEKST
				{% elsif Variant == 'Signal 60G DATC' %}SIGNAL-60G-DATC
				{% elsif Variant == 'Signal 60G DATC begynner (gammel type)' %}SIGNAL-60G-DATC-TILLEGGSTEKST
				{% elsif Variant == 'Signal 60H ATC slutter' %}SIGNAL-60H-ATC-SLUTTER
				{% elsif Variant == 'Signal ATC innkoblet' %}ATC-INNKOBLET
				{% elsif Variant == 'Signal ATC utkoblet' %}ATC-UTKOBLET
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTSA_MSS Baliseskilt
	Baliseskilt på plattformkanten (siden mot sporet).
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignBalise" Name="JBTSA_MSS Baliseskilt"
				DrawTail="false"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<Variants DefaultValue="Baliseskilt" >
			<Variant Name="Baliseskilt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-BALISE" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Baliseskilt" DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-VEDLIKEHOLD-BALISE-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
			<SetValue Key="dir" Value="both" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_MSS-SKILT-VEDLIKEHOLD-BALISE-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_MSS
				SKILT-VEDLIKEHOLD
				{% if Variant == 'Baliseskilt' %}BALISE
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>BALISE</Value>
			</Attribute>
		</Annotation3DTagDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" />
				<SnapPoint X="0" Y="3" />
				<SnapPoint X="0" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/AVSTANDSSKILT
	JBTSA_MSS Signal 61 Avstandsskilt
	Frittstående men relatert til signaler
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssDistanceToSignal" Name="JBTSA_MSS Signal 61 Avstandsskilt"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Avstandsskilt"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" DrawTail="false" />
		<AttachTo Category="kl-mast" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<Variants DefaultValue="61C Avstandsskilt 3 (250m til Hs)" >
			<Variant Name="61A Avstandsskilt 1 (1000m til Hs)" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-61A-AVSTANDSSKILT-1" />
			</Variant>
			<Variant Name="61B Avstandsskilt 2 (800m til Hs)" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-61B-AVSTANDSSKILT-2" />
			</Variant>
			<Variant Name="61C Avstandsskilt 3 (250m til Hs)" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-61C-AVSTANDSSKILT-3" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="61A Avstandsskilt 1 (1000m til Hs)" DisplayName="61A Avstandsskilt 1" 
				DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-61A-AVSTAND1-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="61B Avstandsskilt 2 (800m til Hs)" DisplayName="61B Avstandsskilt 2" 
				DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-61B-AVSTAND2-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="61C Avstandsskilt 3 (250m til Hs)" DisplayName="61C Avstandsskilt 3"
				DisplayBlockName="NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-61C-AVSTAND3-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-61A-AVSTAND1-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSA_MSS
				SKILT-KJOERENDE
				{%    if Variant ==  '61A Avstandsskilt 1 (1000m til Hs)' %}SIGNAL-61A-AVSTAND1
				{% elsif Variant ==  '61B Avstandsskilt 2 (800m til Hs)' %}SIGNAL-61B-AVSTAND2
				{% elsif Variant ==  '61C Avstandsskilt 3 (250m til Hs)' %}SIGNAL-61C-AVSTAND3
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/SKILT PÅ LYSSIGNALER
	SA-MSS Skilt på signal
	Signal 60E ATC Varsel, 62 Ugyldighetsskilt, 70 PLO, 72A/72B FJS, 73 Rasvarsling - som bare skal  plasseres på 
	lyssignaler (men vi lar dem få lov til å hekte seg på stolper også, i tilfelle signalet er "fullt")
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssBoardFixedToSignal" Name="SA-MSS Skilt på lyssignal"
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/Skilt på lyssignal"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				> 
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="signal" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<Variants DefaultValue="Signal 60E ATC Varsel" >
			<Variant Name="Signal 60E ATC Varsel" >
				<!-- Foran på 3-lys Hs skjerm hvis montert på standard mast -->
				<SetValue Key="3D Offset Towards Driver" Value="0.10" />  
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-60E-ATC-VARSEL" />
			</Variant>
			<Variant Name="Signal 62 Ugyldighetsskilt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-62-UGYLDIGHETSSKILT" />
			</Variant>
			<Variant Name="Signal 70 Planovergang" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-70-PLANOVERGANGSSKILT" />
			</Variant>
			<Variant Name="Signal 72A FJS begynner" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-72A-FJS-BEGYNNER" />
			</Variant>
			<Variant Name="Signal 72B FJS slutter" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-72B-FJS-SLUTTER" />
			</Variant>
			<Variant Name="Signal 73 Rasvarsling" >
				<!--TODO sjekk om 73 tilhører SA og ikke KO - er jo plassert på et signal-->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-73-RASVARSLINGSSKILT" /> 
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 60E ATC Varsel" DisplayName="60E ATC Varsel"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60E-ATC-VARSEL-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 62 Ugyldighetsskilt" DisplayName="62 Ugyldighetsskilt"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-62-UGYLDIGHETSSKILT-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 70 Planovergang" DisplayName="70 Planovergang"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-70-PLANOVERGANGSSKILT-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 72A FJS begynner" DisplayName="72A FJS begynner"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-72A-FJS-BEGYNNER-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 72B FJS slutter" DisplayName="72B FJS slutter"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-72B-FJS-SLUTTER-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 73 Rasvarsling" DisplayName="73 Rasvarslingsskilt"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-73-RASVARSEL-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSA_MSS-SKILT-KJOERENDE-SIGNAL-60E-ATC-VARSEL-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				{% if Variant == 'Signal 60E ATC Varsel' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-60E-ATC-VARSEL
				{% elsif Variant == 'Signal 62 Ugyldighetsskilt' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-62-UGYLDIGHETSSKILT
				{% elsif Variant == 'Signal 70 Planovergang' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-70-PLANOVERGANGSSKILT
				{% elsif Variant == 'Signal 72A FJS begynner' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-72A-FJS-BEGYNNER
				{% elsif Variant == 'Signal 72B FJS slutter' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-72B-FJS-SLUTTER
				{% elsif Variant == 'Signal 73 Rasvarsling' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-73-RASVARSEL
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/STIGNING- OG FALLVISERE
	JBTKO_SKT Signal 63 Stigning-/fallviser
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssGradient" Name="JBTKO_SKT Signal 63 Stigning-/fallviser" 
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Stigning- og fallvisere"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="kl-mast" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<CustomAttribute Name="Gradient" DataType="Int32" DefaultValue="99" />
		
		<Variants DefaultValue="Signal 63A Fallviser" >
			<Variant Name="Signal 63A Fallviser" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-63A-FALLVISER" />
			</Variant>
			<Variant Name="Signal 63B Stigningsviser" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-63B-STIGNINGSVISER" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		
		<InsertPointObject VariantName="Signal 63A Fallviser" DisplayName="63A Fallviser" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-63A-FALLVISER-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 63B Stigningsviser" DisplayName="63B Stigningsviser" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-63B-STIGNINGSVISER-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-63A-FALLVISER-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				{% if Variant == 'Signal 63A Fallviser' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-63A-FALLVISER
				{% elsif Variant == 'Signal 63B Stigningsviser' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-63B-STIGNINGSVISER
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
			<SymbolAttribute Tag="Gradient" >
				<Value>{{GRADIENT}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{GRADIENT}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/STOLPER
	JBTKO_SKT Signal 64 Stolpe
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssPole" Name="JBTKO_SKT Signal 64 Stolpe"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Stolper"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>stolpe</RelationSpace>
		<AttachmentCategory Name="stolpe" PassAttachmentToTarget="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
			
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<LuaExpression Name="name" ><Formula>NOBN_bnp_getBoardOrPoleName()</Formula></LuaExpression>

		<CustomAttribute DataType="Boolean" Name="RotateText" InvertOnAlignmentReverse="true" DisplayName="Roter tekst" DefaultValue="false" />  
		<CustomAttribute DataType="String" Name="LeftText" DisplayName="Venstrejustert tekst" DefaultValue="Svart/Hvit" />
		<CustomAttribute DataType="String" Name="RightText" DisplayName="Høyrejustert tekst" DefaultValue="Svart/Hvit" />

		<Variants DefaultValue="Signal 64A Grensestolpe" >
			<Variant Name="Signal 64A Grensestolpe" >
				<!-- Note: Denne forekommer i Banedata også som EH-BKT Signal 64A -->
				<!-- Note: Denne forekommer i Banedata også som SA-MSS Signal 64A -->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-STOLPE-64A-GRENSE-INNKOBLINGSSTOLPE" />
				<SetValue Key="LeftText" Value="Svart/Hvit" />
				<SetValue Key="RightText" Value="Svart/Hvit" />
				<SetValue Key="RotateText" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			</Variant>
			<Variant Name="Signal 64B Seksjoneringsstolpe" >
				<!-- Note: Denne forekommer i Banedata også som EH-BKT Signal 64B -->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-STOLPE-64B-SEKSJONERINGSSTOLPE" />
				<SetValue Key="LeftText" Value="Rød/Hvit" />
				<SetValue Key="RightText" Value="Rød/Hvit" />
				<SetValue Key="RotateText" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			</Variant>
			<Variant Name="Signal 64C Rasvarslingsstolpe" >
				<!-- Note: Denne forekommer i Banedata også som SA-MSS Signal 64C -->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-STOLPE-64C-RASVARSLINGSSTOLPE" />
				<SetValue Key="LeftText" Value="Gul/Hvit" />
				<SetValue Key="RightText" Value="Gul/Hvit" />
				<SetValue Key="RotateText" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			</Variant>
			<Variant Name="Signal 64D Bremsestolpe" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-STOLPE-64D-BREMSESTOLPE" />
				<SetValue Key="LeftText" Value="Gul/Svart" />
				<SetValue Key="RightText" Value="Gul/Svart" />
				<SetValue Key="RotateText" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			</Variant>
			<Variant Name="Signal 64E Teknisk stolpe" >
				<!-- Note: Denne forekommer i Banedata også som EH-BKT Signal 64E -->
				<!-- Note: Denne forekommer i Banedata også som SA-MSS Signal 64E -->
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-STOLPE-64E-TEKNISK-STOLPE" />
				<SetValue Key="LeftText" Value="Blå/Hvit" />
				<SetValue Key="RightText" Value="Blå/Hvit" />
				<SetValue Key="RotateText" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			</Variant>
			<Variant Name="Signal 64F Dvergsignalstolpe" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-STOLPE-64F-DVERGSIGNALSTOLPE" />
				<SetValue Key="LeftText" Value="Svart/Hvit" />
				<SetValue Key="RightText" Value="Svart/Hvit" />
				<SetValue Key="RotateText" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 64A Grensestolpe" DisplayName="64A Grensestolpe"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64A-GRENSE-INNKOBLINGSSTOLPE-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 64B Seksjoneringsstolpe" DisplayName="64B Seksjoneringsstolpe"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64B-SEKSJONERINGSSTOLPE-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 64C Rasvarslingsstolpe" DisplayName="64C Rasvarslingsstolpe"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64C-RASVARSLINGSSTOLPE-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 64D Bremsestolpe" DisplayName="64D Bremsestolpe"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64D-BREMSESTOLPE-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 64E Teknisk stolpe" DisplayName="64E Teknisk stolpe"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64E-TEKNISK-STOLPE-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		<InsertPointObject VariantName="Signal 64F Dvergsignalstolpe" DisplayName="64F Dvergsignalstolpe"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64F-DVERGSIGNALSTOLPE-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64A-GRENSESTOLPE-{{SymbolMode}}"
				AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				{% if Variant == 'Signal 64A Grensestolpe' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64A-GRENSE-INNKOBLINGSSTOLPE
				{% elsif Variant == 'Signal 64B Seksjoneringsstolpe' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64B-SEKSJONERINGSSTOLPE
				{% elsif Variant == 'Signal 64C Rasvarslingsstolpe' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64C-RASVARSLINGSSTOLPE
				{% elsif Variant == 'Signal 64D Bremsestolpe' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64D-BREMSESTOLPE
				{% elsif Variant == 'Signal 64E Teknisk stolpe' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64E-TEKNISK-STOLPE
				{% elsif Variant == 'Signal 64F Dvergsignalstolpe' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-64F-DVERGSIGNALSTOLPE
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
			<SymbolAttribute Tag="LEFTUP" >
				<Value>{% if RotateText == 'False' and dir == 'up' %}{{LeftText}}{% elsif RotateText == 'True' and dir == 'down' %}{{LeftText}}{% else %}{% endif %}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="RIGHTUP" >
				<Value>{% if RotateText == 'True' and dir == 'up' %}{{RightText}}{% elsif RotateText == 'False' and dir == 'down' %}{{RightText}}{% else %}{% endif %}</Value>
			</SymbolAttribute>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	
	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Skilt nødtelefon
	TODO Lage 3D-modell for skilt Nødtelefon
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssEmergencyTelephone" Name="JBTKO_SKT Skilt nødtelefon"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="apparatskap" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<Variants DefaultValue="Nødtelefon" >
			<Variant Name="Nødtelefon" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-NØDTELEFON" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Nødtelefon" DisplayBlockName="NO-BN-2D-JBTTE_SKP-SKILT-TREDJEPERSON-NOEDTELEFON-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
			<SetValue Key="dir" Value="both" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTTE_SKP-SKILT-TREDJEPERSON
				{% if Variant == 'Nødtelefon' %}NOEDTELEFON
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" />
				<SnapPoint X="0" Y="3" />
				<SnapPoint X="0" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Signal 74 Toglengdeskilt
=========================================================================================================-->
	<ObjectType DataType="tStopPost" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssTrainLength" Name="JBTKO_SKT Signal 74 Toglengdeskilt"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<CustomAttribute DataType="UInt32" Name="HUNDRE_M" DisplayName="Hundre-metere" 
			DotLiquidExpression="{{trainLength | toint | divided_by:100}}" />

		<CustomAttribute DataType="UInt32" Name="TI_M" DisplayName="Ti-metere" 
			DotLiquidExpression="{{trainLength | toint | modulo:100 | divided_by:10}}" />

		<CustomAttribute DataType="UInt32" Name="EN_M" DisplayName="En-metere" 
			DotLiquidExpression="{{trainLength | toint | modulo:10}} " />

		<Variants DefaultValue="Signal 74-1 Toglengde (bred type)" >
			<Variant Name="Signal 74-1 Toglengde (bred type)" >
				<SetValue Key="name" Value="74-1" />
				<SetValue Key="trainLength" Value="741" />
			</Variant>
			<Variant Name="Signal 74-2 Toglengde (smal type)" >
				<SetValue Key="name" Value="74-2" />
				<SetValue Key="trainLength" Value="742" />
			</Variant>
		</Variants>
		
		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<LuaExpression Name="Geometry3D_0.Name" ><Formula>_JBTKO_SKT_74_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SKT_74_Geometry3DName()" 
				ReturnType="String"
				HideFromUser="false"
				Description="Returns the object's default 3D object model name." >
			<Constructor>String _JBTKO_SKT_74_Geometry3DName()</Constructor>
			<Formula>
				function _JBTKO_SKT_74_Geometry3DName()
					t = "NO-BN-3D-KO-SKT-SKILT-74-"
					if Variant == "Signal 74-1 Toglengde (bred type)" then 
						return t.."1-TOGLENGDESKILT-ALT-1"
					elseif Variant == "Signal 74-2 Toglengde (smal type)" then 
						return t.."2-TOGLENGDESKILT-ALT-2"
					end
				end
			</Formula>
		</LuaFunction>
		
		<InsertPointObject VariantName="Signal 74-1 Toglengde (bred type)" DisplayName="74-1 Toglengdeskilt (bred type)"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-74-1-TOGLENGDE1-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
		<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Signal 74-2 Toglengde (smal type)" DisplayName="74-2 Toglengdeskilt (smal type)"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-74-2-TOGLENGDE2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-74-1-TOGLENGDE1-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal 74-1 Toglengde (bred type)' %}74-1-TOGLENGDE1
				{% elsif Variant == 'Signal 74-2 Toglengde (smal type)' %}74-2-TOGLENGDE2
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>

			<!-- "Info: Bred type 2D toglengdeskilt symbol benytter tag TOGLENGDE, mens smal type 3D-objekt benytter tags HUNDRE_M, TI_M og EN_M: -->
			<SymbolAttribute Tag="TOGLENGDE" >
				<Value>{{trainLength}}m</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HUNDRE_M" >
				<Value>{{HUNDRE_M}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TI_M" >
				<Value>{{TI_M}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="EN_M" >
				<Value>{{EN_M}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<!-- "Info: Bred type 3D toglengdeskilt benytter tag T01, mens smal type 3D-objekt benytter T02, T03 og T04: -->
		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{trainLength}}m</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>{{HUNDRE_M}}</Value>
			</Attribute>
			<Attribute Tag="T03" >
				<Value>{{TI_M}}</Value>
			</Attribute>
			<Attribute Tag="T04" >
				<Value>{{EN_M}}</Value>
			</Attribute>
			<Attribute Tag="T05" >
				<Value>m</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Skilt spornummer
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssTrackNumber" Name="JBTKO_SKT Skilt spornummer"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="aak" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___PORTALMOUNTED" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<Variants>
			<Variant Name="Spornummer" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-SPORNUMMER" />
				<SetValue Key="PortalMounted" Value="true" />
				<SetValue Key="code" Value="38" />
			</Variant>
		</Variants>
		
		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<!-- Assume that the track number board has been placed close to "own" track: -->
		<LuaExpression Name="TrackNumber" ><Formula>getClosestTracks()[0].code</Formula></LuaExpression>
		
		<!-- Assume portal placement, but stay away from exact ventre track in order to keep the tail drawing in place: -->
		<LuaExpression Name="DistanceToAlignment" ><Formula>RightSided and 4e-4 or -4e-4</Formula></LuaExpression>
		
		<!-- In alignment snap mode, assume pole,l not portal. -->
		<InsertPointObject VariantName="Spornummer" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SPORNUMMER-{{SymbolMode}}" 
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SPORNUMMER-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<SymbolAttribute Tag="SPORNUMMER" >
				<Value>{{code}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{code}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
				<SnapPoint X="0" Y="3" />
				<SnapPoint X="0" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/IDSKILT
	SA-MSS Signal 101 Identifikasjonsskilt
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssId" Name="SA-MSS Signal 101 Identifikasjonsskilt"
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/ID- og pilskilt"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="signal" DrawTail="true" />
		<AttachTo Category="markerboard" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<!-- (Name is given explicitly, not through the usual naming formula for boards and poles) -->

		<CustomAttribute DataType="String" Name="ID_BOKSTAV" DisplayName="ID-skilt litra (øvre linje)" DefaultValue="" />
		<CustomAttribute DataType="String" Name="ID_NUMMER" DisplayName="ID-skilt signalnummer (midtre/øvre linje)" DefaultValue="" />
		<CustomAttribute DataType="String" Name="ID_STED" DisplayName="ID-skilt stedsforkortelse (nedre linje)" DefaultValue="" />
		<CustomAttribute DataType="String" Name="ID_MINDRE_SIGNAL" DisplayName="Litra/Nummer" DefaultValue="" />
						   
		<LuaExpression Name="code" ><Formula>Attachment and Attachment.code or "(no attachment found)"</Formula></LuaExpression>
		<LuaExpression Name="ID_BOKSTAV" ><Formula>NOBN_sig_getSignalLitra()</Formula></LuaExpression>
		<LuaExpression Name="ID_NUMMER" ><Formula>NOBN_sig_getSignalNumber()</Formula></LuaExpression>
		<LuaExpression Name="ID_STED" ><Formula>Attachment and Attachment.NOBN_com_getOcpCode() or "(no attachment found)"</Formula></LuaExpression>

		<LuaExpression Name="ID_MINDRE_SIGNAL" >
			<Formula>
				if Variant == 'Signal 101-5 ID-skilt for dvergsignal og togsporsignal, 1-linje, 180x100' then
					return "R"..code
				elseif Variant == 'Signal 101-6 ID-skilt for dvergsignal, 1-linje, 300x100' then
					return "R"..code
				elseif Variant == 'Signal 101-7 ID-skilt for planovergangsignal, 200x300' then
					return "W"..code
				elseif Variant == 'Signal 101-8 ID-skilt for høyt skiftesignal, 300x200' then
					return "Z"..code
				else 
					return ""
				end
			</Formula>
		</LuaExpression>

		<Variants>
			<Variant Name="Signal 101-1 ID-skilt for Hs og Fs, 3 linjer, 800x455" >
				<SetValue Key="name" Value="ID (Hs/Fs/3-lj.)" />
				<!--3D-verdiene er tilpasset BN hovedsignal:-->
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="2.02" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-101-1-800x455-ID-SKILT-3-LINJER" />
			</Variant>
			<Variant Name="Signal 101-2 ID-skilt for Hs og Fs, 2 linjer, 800x325" >
				<SetValue Key="name" Value="ID (Hs/Fs/2-lj.)" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="2.02" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-101-2-800x325-ID-SKILT-2-LINJER" />
			</Variant>
			<Variant Name="Signal 101-3 ID-skilt for Hs og Fs, 3 linjer, Ø600" >
				<SetValue Key="name" Value="ID (Hs/Fs/rundt)" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-101-3-Ø600-ID-SKILT-3-LINJER" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="2.02" />
			</Variant>
			<Variant Name="Signal 101-5 ID-skilt for dvergsignal og togsporsignal, 1-linje, 180x100" >
				<SetValue Key="name" Value="ID Ds/Tsp, lite" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-101-5-180x100-ID-SKILT-DS-OG-TSS" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="0.6" />
			</Variant>
			<Variant Name="Signal 101-6 ID-skilt for dvergsignal, 1-linje, 300x100" >
				<SetValue Key="name" Value="ID Ds, stort" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-101-6-300x100-ID-SKILT-DS" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="0.6" />
			</Variant>
			<Variant Name="Signal 101-7 ID-skilt for planovergangsignal, 200x300" >
				<SetValue Key="name" Value="ID PLOs/Fs-PLO" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-101-7-200x300-ID-SKILT-PLO-SIGNAL" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
			<Variant Name="Signal 101-8 ID-skilt for høyt skiftesignal, 300x200" >
				<SetValue Key="name" Value="ID Skiftesig." />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-101-8-300x200-ID-SKILT-HØYT-SKIFTESIGNAL" />
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.7" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 101-1 ID-skilt for Hs og Fs, 3 linjer, 800x455" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-1-ID-3-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 101-2 ID-skilt for Hs og Fs, 2 linjer, 800x325" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-2-ID-2-LINJER-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 101-3 ID-skilt for Hs og Fs, 3 linjer, Ø600" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-3-ID-RUNDT-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 101-5 ID-skilt for dvergsignal og togsporsignal, 1-linje, 180x100" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-5-ID-MINDRE-SIGNAL-180x100-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Signal 101-6 ID-skilt for dvergsignal, 1-linje, 300x100" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-6-ID-MINDRE-SIGNAL-300x100-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 101-7 ID-skilt for planovergangsignal, 200x300" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-7-ID-MINDRE-SIGNAL-200x300-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 101-8 ID-skilt for høyt skiftesignal, 300x200" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-8-ID-MINDRE-SIGNAL-300x200-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-101-1-ID-3-LINJER-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	

			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal 101-1 ID-skilt for Hs og Fs, 3 linjer, 800x455' %}101-1-ID-3-LINJER
				{% elsif Variant == 'Signal 101-2 ID-skilt for Hs og Fs, 2 linjer, 800x325' %}101-2-ID-2-LINJER
				{% elsif Variant == 'Signal 101-3 ID-skilt for Hs og Fs, 3 linjer, Ø600' %}101-3-ID-RUNDT
				{% elsif Variant == 'Signal 101-5 ID-skilt for dvergsignal og togsporsignal, 1-linje, 180x100' %}101-5-ID-MINDRE-SIGNAL-180x100
				{% elsif Variant == 'Signal 101-6 ID-skilt for dvergsignal, 1-linje, 300x100' %}101-6-ID-MINDRE-SIGNAL-300x100
				{% elsif Variant == 'Signal 101-7 ID-skilt for planovergangsignal, 200x300' %}101-7-ID-MINDRE-SIGNAL-200x300
				{% elsif Variant == 'Signal 101-8 ID-skilt for høyt skiftesignal, 300x200' %}101-8-ID-MINDRE-SIGNAL-300x200
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>

			<SymbolAttribute Tag="ID_BOKSTAV" >
				<Value>{{ID_BOKSTAV}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="ID_NUMMER" >
				<Value>{{ID_NUMMER}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="ID_STED" >
				<Value>{{ID_STED}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="ID_BOKSTAV_OG_NR" >
				<Value>{{ID_BOKSTAV}} {{ID_NUMMER}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="ID_MINDRE_SIGNAL" >
				<Value>{{ID_MINDRE_SIGNAL}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{ID_BOKSTAV}}</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>{{ID_NUMMER}}</Value>
			</Attribute>
			<Attribute Tag="T03" >
				<Value>{{ID_STED}}</Value>
			</Attribute>
			<Attribute Tag="T04" >
				<Value>{{ID_BOKSTAV}} {{ID_NUMMER}}</Value>
			</Attribute>
			<Attribute Tag="T05" >
				<Value>{{ID_MINDRE_SIGNAL}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
				<SnapPoint X="7" Y="7" />
				<SnapPoint X="7" Y="-7" />
				<SnapPoint X="-7" Y="7" />
				<SnapPoint X="-7" Y="-7" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL PILSLKILT
	SA-MSS Signal 102 Pilskilt (underskilt)
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssArrow" Name="SA-MSS Signal 102 Pilskilt (underskilt)"
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Kjørende personell/ID- og pilskilt"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="signal" DrawTail="true" /> 
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<LuaExpression Name="name" ><Formula>NOBN_bnp_getBoardOrPoleName()</Formula></LuaExpression>

		<Variants>
			<Variant Name="Signal 102-1 Pil mot høyre" >
				<SetValue Key="name" Value="Pil (høyre)" />
				<!--
				3D-verdier tilpasset frittstående SATEMA dverg: 3D Offset.Z=1.18, 3D OffsetTowardsDriver=-0.13:
				3D-verdier tilpasset NSI-63 signal med vanlig signalskap og SATEMA dverg: 3D Offset.Z=1.33, 3D OffsetTowardsDriver=0.20 -->
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.33" />
				<SetValue Key="3D Offset Towards Driver" Value="0.20" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-102-1-PIL-H" />
			</Variant>
			<Variant Name="Signal 102-2 Pil mot venstre" >
				<SetValue Key="name" Value="Pil (venstre)" />
				<!--3D-verdier tilpasset NSI-63 signal med vanlig signalskap og SATEMA dverg:-->
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="1.33" />
				<SetValue Key="3D Offset Towards Driver" Value="0.20" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-102-2-PIL-V" />
			</Variant>
			<Variant Name="Signal 102-3 Pil begge veier" >
				<SetValue Key="name" Value="Pil (begge veier)" />
				<!--3D-verdier tilpasset skilt på 3.50 m høy stolpe med underskilt "pilskilt":-->
				<SetValue Key="Geometry3D_0.Offset3D.Z" Value="2.9" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-102-3-PIL-HV" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 102-1 Pil mot høyre" DisplayName="102-1 Pilskilt" 
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-102-1-PIL-H-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 102-2 Pil mot venstre" DisplayName="102-2 Pilskilt"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-102-2-PIL-V-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 102-3 Pil begge veier" DisplayName="102-3 Pilskilt"
				DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-102-3-PIL-HV-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-102-3-PIL-HV-{{SymbolMode}}"
				AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
				<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal 102-1 Pil mot høyre' %}102-1-PIL-H
				{% elsif Variant == 'Signal 102-2 Pil mot venstre' %}102-2-PIL-V
				{% elsif Variant == 'Signal 102-3 Pil begge veier' %}102-3-PIL-HV
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0.3" />  <!--Plassering litt opp på 2D-symbolets mast-->
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Skilt 1000V togvarmeanlegg
	TODO Lage 3D-modell for skilt "1000V"
	NOTE: Fant ikke noe om skiltet i Banedata. Kanskje EL-???
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssTrainHeating1000V" Name="JBTKO_SKT Skilt 1000V togvarmeanlegg"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="signalteknisk_bygg" DrawTail="true" />
		<AttachTo Category="apparatskap" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___POW" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<Variants>
			<Variant Name="1000V togvarmeanlegg" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-FE-DIV-UKJENT" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />
				   
		<InsertPointObject VariantName="1000V togvarmeanlegg" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-1000V-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-1000V-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				{% if Variant == '1000 V togvarmeanlegg' %}NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-1000V
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Skilt bevegelig kryss
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssMovablePointFrog" Name="JBTKO_SKT Skilt bevegelig kryss"
				DrawTail="true"
                Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />
		 
		<Variants>
			<Variant Name="Bevegelig kryss" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-BEVEGELIG-KRYSS" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Bevegelig kryss" DisplayBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-BEVEGELIG-KRYSS-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-BEVEGELIG-KRYSS-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/KILOMETERSKILT
	JBTKO_SKT Signal 75 Kilometerskilt
=========================================================================================================-->
	<!-- TODO: What is the relation between EULYNX.generic.AnchorPoint and EULYNX.sig.Milepost ? -->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Milepost" LuaName="rctype_SignNssKilometer" Name="JBTKO_SKT Signal 75 Kilometerskilt"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Kilometerskilt"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="kl-mast" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<CustomAttribute DataType="UInt32" Name="HEL_KM" DisplayName="Hel km" DefaultValue="0" />
		<CustomAttribute DataType="UInt32" Name="HEL_KM_UTEN_HALV" DisplayName="Hel km uten halv" DefaultValue="0" />
		<CustomAttribute DataType="UInt32" Name="HALV_KM" DisplayName="Halv km" DefaultValue="0" />

		<LuaExpression Name="HEL_KM" ><Formula>NOBN_trk_getNearestEntireKm()</Formula></LuaExpression>
		<LuaExpression Name="HEL_KM_UTEN_HALV" ><Formula>NOBN_trk_getNearestEntireKm2()</Formula></LuaExpression>
        <LuaExpression Name="HALV_KM" ><Formula>NOBN_trk_getNearestHalfKm()</Formula></LuaExpression>
								
		<Variants DefaultValue="Signal 75A-1 Kilometerskilt, enkelsidet, midtstilt" >
			<Variant Name="Signal 75A-1 Kilometerskilt, enkelsidet, midtstilt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-75A-1-KILOMETERSKILT-ENKELSIDET-MIDTSTILT" />
			</Variant>
			<Variant Name="Signal 75A-2 Kilometerskilt, gammel type" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-75A-2-KILOMETERSKILT-GAMMEL-TYPE" />
			</Variant>
			<Variant Name="Signal 75A-3 Kilometerskilt, dobbelsidet, midtstilt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-75A-3-KILOMETERSKILT-DOBBELSIDET-MIDTSTILT" />
			</Variant>
			<Variant Name="Signal 75A-4 Kilometerskilt, dobbelsidet, sidestilt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-75A-4-KILOMETERSKILT-DOBBELSIDET-SIDESTILT" />
			</Variant>
			<Variant Name="Signal 75B Kilometerskilt i tunnel, dobbelsidet" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-75B-KILOMETERSKILT-FOR-TUNNELER-DOBBELSIDET" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 75A-1 Kilometerskilt, enkelsidet, midtstilt" 
			DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-75A-1-KILOMETER-ENKELSIDET-{{SymbolMode}}" 
			DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 75A-2 Kilometerskilt, gammel type" 
			DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-75A-2-KILOMETER-GAMMEL-{{SymbolMode}}"
			DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Signal 75A-3 Kilometerskilt, dobbelsidet, midtstilt" 
			DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-75A-3-KILOMETER-DOBBELSIDET-{{SymbolMode}}"
			DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
			<SetValue Key="dir" Value="both" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 75A-4 Kilometerskilt, dobbelsidet, sidestilt"
			DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-75A-3-KILOMETER-DOBBELSIDET-{{SymbolMode}}"
			DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
			<SetValue Key="dir" Value="both" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 75B Kilometerskilt i tunnel, dobbelsidet" 
			DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-75B-KILOMETER-TUNNEL-DOBBELSIDET-{{SymbolMode}}"
			DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.8" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
			<SetValue Key="dir" Value="both" />
		</InsertPointObject>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL-75A-1-KILOMETER-ENKELSIDET-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIGNAL
				{% if Variant == 'Signal 75A-1 Kilometerskilt, enkelsidet, midtstilt' %}75A-1-KILOMETER-ENKELSIDET
				{% elsif Variant == 'Signal 75A-2 Kilometerskilt, gammel type' %}75A-2-KILOMETER-GAMMEL
				{% elsif Variant == 'Signal 75A-3 Kilometerskilt, dobbelsidet, midtstilt' %}75A-3-KILOMETER-DOBBELSIDET
				{% elsif Variant == 'Signal 75A-4 Kilometerskilt, dobbelsidet, sidestilt' %}75A-3-KILOMETER-DOBBELSIDET 
				{% elsif Variant == 'Signal 75B Kilometerskilt i tunnel, dobbelsidet' %}75B-KILOMETER-TUNNEL-DOBBELSIDET
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>

			<!-- NB: RC does not fill in duplicate ATTDEF tags - each tag must be unique in the 2D symbol. -->
			<SymbolAttribute Tag="HUNDRE_KM" >
				<Value>{{HEL_KM | divided_by:100}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TI_KM" >
				<Value>{{HEL_KM | modulo:100 | divided_by:10}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="EN_KM" >
				<Value>{{HEL_KM | modulo:10}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HEL_KM" >
				<Value>{{HEL_KM}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HALV_KM" >
				<Value>{{HALV_KM}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HEL_KM_UTEN_HALV" >
				<Value>{{HEL_KM_UTEN_HALV}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HUNDRE_KM2" >
				<Value>{{HEL_KM | divided_by:100}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TI_KM2" >
				<Value>{{HEL_KM | modulo:100 | divided_by:10}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="EN_KM2" >
				<Value>{{HEL_KM | modulo:10}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HEL_KM2" >
				<Value>{{HEL_KM}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HALV_KM2" >
				<Value>{{HALV_KM}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<!-- RC accepts that the same ATTDEF tag name is used multiple times in a 3D block. -->
			<Attribute Tag="T01" >
				<Value>{{HEL_KM}}</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>{{HALV_KM}}</Value>
			</Attribute>
			<Attribute Tag="T03" >
				<Value>{{HEL_KM | divided_by:100}}</Value>
			</Attribute>
			<Attribute Tag="T04" >
				<Value>{{HEL_KM | modulo:100 | divided_by:10}}</Value>
			</Attribute>
			<Attribute Tag="T05" >
				<Value>{{HEL_KM | modulo:10}}</Value>
			</Attribute>
			<Attribute Tag="T06" >
				<Value>{{HEL_KM_UTEN_HALV}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
				<SnapPoint X="0" Y="3" />
				<SnapPoint X="0" Y="-3" />
				<SnapPoint X="3" Y="0" />
				<SnapPoint X="-3" Y="-0" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Skilt anleggsområde
	TODO Lage 3D-modell for skilt Anleggsområde begynner/slutter
	Innfesting: Søk på "Damkjær vedlikehold".
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssConstructionArea" Name="JBTKO_SKT Anleggsområde"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />
		
		<Variants>
			<Variant Name="Anleggsområde begynner" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-ANLEGGSOMRÅDE-BEGYNNER" />
			</Variant>
			<Variant Name="Anleggsområde slutter" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-ANLEGGSOMRÅDE-SLUTTER" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />
		
		<InsertPointObject VariantName="Anleggsområde begynner" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-ANLEGGSOMRAADE-BEGYNNER-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<InsertPointObject VariantName="Anleggsområde slutter" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-ANLEGGSOMRAADE-SLUTTER-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-ANLEGGSOMRAADE-BEGYNNER-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-ANLEGGSOMRAADE
				{% if Variant == 'Anleggsområde begynner' %}BEGYNNER
				{% elsif Variant == 'Anleggsområde slutter' %}SLUTTER
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	KJØRENDE PERSONELL/DIVERSE
	JBTKO_SKT Skilt sidespor
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssSiding" Name="JBTKO_SKT Sidespor"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Kjørende personell/Diverse"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				> 
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />

		<CustomAttribute DataType="String" Name="SSP_NAVN" DisplayName="Sidespor navn (store bokstaver):" DefaultValue="Firmanavn AS" />
		<CustomAttribute DataType="String" Name="SSP_KM" DisplayName="Kilometer (xxx,xx):" DefaultValue="0,0" />
		<CustomAttribute DataType="String" Name="SSP_FRA_STASJON" DisplayName="Stasjon 1" DefaultValue="Askeby" />
		<CustomAttribute DataType="String" Name="SSP_TIL_STASJON" DisplayName="Stasjon 2" DefaultValue="Potteby" />
		
		<LuaExpression Name="dir" ><Formula>"both"</Formula></LuaExpression>

		<Variants>
			<Variant Name="Sidespor" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-FE-DIV-UKJENT" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />
		
		<InsertPointObject VariantName="Sidespor" DisplayBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIDESPOR-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="180" EnableDirectionSetting="false" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKK-SKILT-KJOERENDE-SIDESPOR-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<SymbolAttribute Tag="SSP_NAVN" >
				<Value>{{SSP_NAVN}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="SSP_KM" >
				<Value>Km. {{SSP_KM}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="SSP_STASJON" >
				<Value>{{SSP_FRA_STASJON}}og {{SSP_TIL_STASJON}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{SSP_NAVN}}</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>Km. {{SSP_KM}}</Value>
			</Attribute>
			<Attribute Tag="T03" >
				<Value>{{SSP_FRA_STASJON} } og {{SSP_TIL_STASJON}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	VEDLIKEHOLDSPERSONELL
	JBTKO_SKT Signal 75C/75D Hev/senk sporrenser
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssSnowClearing" Name="JBTKO_SKT Signal 75C/75D Hev/senk sporrenser"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Vedlikeholdspersonell/Sporrenser"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="kl-mast" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />
		
		<LuaExpression Name="Geometry3D_0.Name" ><Formula>_JBTKO_SKT_75CD_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SKT_75CD_Geometry3DName()" ReturnType="String"
				Description="Obtains the board's 3D model name." >
			<Constructor>String _JBTKO_SKT_75CD_Geometry3DName()</Constructor>
			<Formula>
				function _JBTKO_SKT_75CD_Geometry3DName()
					if RightSided then 
						side = (dir == 'up' and "VSIDE" or "VSIDE")
						number = (dir == 'up' and 1 or 2)
					else 
						side = (dir == 'up' and "VSIDE" or "VSIDE")
						number = (dir == 'up' and 2 or 1)
					end
					if Variant:match("75C") then
						return "NO-BN-3D-KO-SKT-SKILT-75C-"..number.."-HEV-SPORRENSER-"..side
					elseif Variant:match("75D") then
						return "NO-BN-3D-KO-SKT-SKILT-75D-"..number.."-SENK-SPORRENSER-"..side
					else	
						return "Unrecognized variant ["..Variant.."]."
					end
				end
			</Formula>
		</LuaFunction>

		<Variants DefaultValue="Signal 75C Hev sporrenser" >
			<Variant Name="Signal 75C Hev sporrenser" />
			<Variant Name="Signal 75D Senk sporrenser" />
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Signal 75C Hev sporrenser" DisplayBlockName=
"NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-SIGNAL-75C-{% if dir == 'up' %}{% if RightSided %}1{% else %}2{% endif %}{% else %}{% if RightSided %}2{% else %}1{% endif %}{% endif %}-HEV-{% if dir == 'up' %}{% if RightSided %}VSIDE{% else %}VSIDE{% endif %}{% else %}{% if RightSided %}VSIDE{% else %}VSIDE{% endif %}{% endif %}-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfLeftSideOfAlignment="false" AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Signal 75D Senk sporrenser" DisplayBlockName=
"NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-SIGNAL-75D-{% if dir == 'up' %}{% if RightSided %}1{% else %}2{% endif %}{% else %}{% if RightSided %}2{% else %}1{% endif %}{% endif %}-SENK-{% if dir == 'up' %}{% if RightSided %}VSIDE{% else %}VSIDE{% endif %}{% else %}{% if RightSided %}VSIDE{% else %}VSIDE{% endif %}{% endif %}-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfLeftSideOfAlignment="false" AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-SKILT-VEDLIKEHOLD-SIGNAL-75C-1-HEV-VSIDE-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
			NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-SIGNAL
			{% if Variant == 'Signal 75C Hev sporrenser' %}75C{% else %}75D{% endif %}
			{% if dir == 'up' %}{% if RightSided %}1{% else %}2{% endif %}{% else %}{% if RightSided %}2{% else %}1{% endif %}{% endif %}
			{% if Variant == 'Signal 75C Hev sporrenser' %}HEV{% else %}SENK{% endif %}
			{% if dir == 'up' %}{% if RightSided %}VSIDE{% else %}VSIDE{% endif %}{% else %}{% if RightSided %}VSIDE{% else %}VSIDE{% endif %}{% endif %}
			{% if Variant != 'Signal 75C Hev sporrenser' and Variant != 'Signal 75D Senk sporrenser' %}BAD_Variant_{{Variant}}{% endif %}
			{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	
	</ObjectType>



<!--========================================================================================================
	SKILT
	VEDLIKEHOLDSPERSONELL
	JBTKO_SKT Signal 75E Skilt kjedebrudd
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.generic.AnchorPoint" LuaName="rctype_SignNssChainBreak" Name="JBTKO_SKT Signal 75E Kjedebrudd"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Vedlikeholdspersonell/Kjedebrudd"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />
		
		<Variants>
			<Variant Name="Signal 75E-1 Kjedebrudd" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-KJEDEBRUDD-EKSAKT" />
			</Variant>
			<Variant Name="Signal 75E-2 Eksakt kjedebrudd" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-KO-SKT-SKILT-KJEDEBRUDD-EKSAKT" />
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />
		
		<LuaExpression Name="Geometry3D_0.Name" ><Formula>_JBTKO_SKT_75E_Geometry3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SKT_75E_Geometry3DName()" 
				ReturnType="String"
				HideFromUser="false"
				Description="Returns the object's default 3D object model name." >
			<Constructor>String _JBTKO_SKT_75E_Geometry3DName()</Constructor>
			<Formula>
				function _JBTKO_SKT_75E_Geometry3DName()
					t = "NO-BN-3D-KO-SKT-SKILT-75E-"
					if Variant == "Signal 75E-1 Kjedebrudd"  then 
						return t.."1-KJEDEBRUDD"
					elseif Variant == "Signal 75E-2 Eksakt kjedebrudd" then 
						return t.."2-KJEDEBRUDD-EKSAKT"
					end
				end
			</Formula>
		</LuaFunction>
		

		<LuaExpression Name="dir" ><Formula>"both"</Formula></LuaExpression>

		<CustomAttribute DataType="String" Name="FRA_1" DisplayName="Fra km" DefaultValue="15" />
		<CustomAttribute DataType="String" Name="FRA_2"  DisplayName="Fra m hhv. mm" DefaultValue="422" />
		<CustomAttribute DataType="String" Name="TIL_1" DisplayName="Til km" DefaultValue="15" />
		<CustomAttribute DataType="String" Name="TIL_2"  DisplayName="Til m. hhv. mm" DefaultValue="450" />
		<CustomAttribute DataType="String" Name="SPRANG" DisplayName="Sprang i m" DefaultValue="+28 m" />

		<LuaExpression Name="FRA_1" >
			<Formula>
				local ai = getAlignmentInfo()
				local m = ai and ai.NearestMileageChange.MileageIn or 0.0
				return RC__isNan(m) and "0" or string.format("%0.f",math.floor(m))
			</Formula>
		</LuaExpression>
		<LuaExpression Name="FRA_2" >
			<Formula>
				local ai = getAlignmentInfo()
				local m = ai and ai.NearestMileageChange.MileageIn or 0.0
				if RC__isNan(m) then
					return "0",_warning, _info("Missing own alignment.")
				else
					if Variant == "Signal 75E-1 Kjedebrudd" then
						return string.format("%.0f",m%1e3)
					elseif Variant == "Signal 75E-2 Eksakt kjedebrudd" then
						return string.format("%.0f",(m*1000)%1e6)
					else
						return "Unrecognized variant ["..Variant.."]."
					end
				end
			</Formula>
		</LuaExpression>
		
		<LuaExpression Name="TIL_1" >
			<Formula>
				local ai = getAlignmentInfo()
				local m = ai and ai.NearestMileageChange.MileageOut or 0.0
				return RC__isNan(m) and "0" or string.format("%0.f",math.floor(m))
			</Formula>
		</LuaExpression>
		
		<LuaExpression Name="TIL_2" >
			<Formula>
				local ai = getAlignmentInfo()
				local m = ai and ai.NearestMileageChange.MileageOut or 0.0
				if RC__isNan(m) then
					return "0",_warning, _info("Missing own alignment.")
				else
					if Variant == "Signal 75E-1 Kjedebrudd" then
						return string.format("%.0f",m%1e3)
					elseif Variant == "Signal 75E-2 Eksakt kjedebrudd" then
						return string.format("%.0f",(m*1000)%1e6)
					else
						return "Unrecognized variant ["..Variant.."]."
					end
				end
			</Formula>
		</LuaExpression>
		
		<LuaExpression Name="SPRANG" >
			<Formula>
				local ai = getAlignmentInfo()
				if ai then 
					local mileageChange = getAlignmentInfo().NearestMileageChange
					if Variant == "Signal 75E-1 Kjedebrudd" then
						return string.format("%.0f", (mileageChange.MileageOut - mileageChange.MileageIn))
					elseif Variant == "Signal 75E-2 Eksakt kjedebrudd" then
						return string.format("%.3f", (mileageChange.MileageOut - mileageChange.MileageIn))
					else
						return "Unrecognized variant ["..Variant.."]."
					end
				else
					return "0"
				end
			</Formula>
		</LuaExpression>
				   
		<InsertPointObject VariantName="Signal 75E-1 Kjedebrudd" DisplayBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-SIGNAL-75E-KJEDEBRUDD-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
		</InsertPointObject>

		<InsertPointObject VariantName="Signal 75E-2 Eksakt kjedebrudd" DisplayBlockName="NO-BN-2D-SKILT-VEDLIKEHOLD-SIGNAL-75E-EKSAKT-KJEDEBRUDD-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
		</InsertPointObject>

		<!--TODO Få kjedebruddskiltet til å plukke opp verdiene sine fra de to alignment'ene som møtes på samme sted-->
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_THUMBNAIL-USPESIFISERT-Schematic" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
			NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-SIGNAL
			{% if Variant == 'Signal 75E-1 Kjedebrudd' %}75E-KJEDEBRUDD
			{% elsif Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}75E-EKSAKT-KJEDEBRUDD
			{% else %}BAD_Variant_{{Variant}}
			{% endif %}
			{{SymbolMode}}
			</BlockNameFormat>

			<SymbolAttribute Tag="FRA_1" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}Km{{FRA_1}},{% else %}{{FRA_1}}{% endif %}"</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="FRA_2" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}{{FRA_3}},{% else %}{{FRA_2}}{% endif %}"</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TIL_1" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}Km{{TIL_1}},{% else %}{{TIL_1}}{% endif %}"</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TIL_2" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}Km{{TIL_3}},{% else %}{{TIL_2}}{% endif %}"</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="SPRANG" >
				<Value>{% if sprang &gt; 0 %}+{% endif %}{{SPRANG}} m"</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T02" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}Km{{FRA_1}},{% else %}{{FRA_1}}{% endif %}"</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}{{FRA_3}},{% else %}{{FRA_2}}{% endif %}"</Value>
			</Attribute>
			<Attribute Tag="T03" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}Km{{TIL_1}},{% else %}{{TIL_1}}{% endif %}"</Value>
			</Attribute>
			<Attribute Tag="T04" >
				<Value>{% if Variant == 'Signal 75E-2 Eksakt kjedebrudd' %}Km{{TIL_3}},{% else %}{{TIL_2}}{% endif %}"</Value>
			</Attribute>
			<Attribute Tag="T05" >
				<Value>{% if sprang &gt; 0 %}+{% endif %}{{SPRANG}} m"</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" />
				<SnapPoint X="0" Y="3" />
				<SnapPoint X="0" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SIGN
	VEDLIKEHOLDSPERSONELL
	KO-???
	TODO: Det mangler fortsatt et par skilt, bl.a. trasépunkt, høyspentkabel jordingsende
	TODO: Det mangler en del avsn. 4 skilt for tredjeperson
=========================================================================================================-->



<!--========================================================================================================
	SIGN
	VEDLIKEHOLDSPERSONELL/ARBEIDSOMRÅDESKILT
	SA-MSS Arbeidsområdeskilt
	Note: AO-skilt er ikke omtalt i Banedata, verken JBTKO_SKT eller SA-MSS.
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sign.Sign" LuaName="rctype_SignNssWorkProtectionArea" Name="SA-MSS Arbeidsområdeskilt"
				DrawTail="true"
				Layer="JBTSA_MSS" Color="ByLayer"
				Group="Skilt/Vedlikeholdspersonell/Arbeidsområdeskilt"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}" 
				>

		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="signal" DrawTail="true" />
		<AttachTo Category="skilt" DrawTail="true" />
		<AttachTo Category="apparatskap" DrawTail="true" />
		<AttachTo Category="markerboard" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />

		<CustomAttribute DataType="String" Name="TEKST1" DisplayName="Tekstlinje 1" DefaultValue="" />
		<CustomAttribute DataType="String" Name="TEKST2" DisplayName="Tekstlinje 2" DefaultValue="Arbeidsområde" />
		<CustomAttribute DataType="String" Name="TEKST3" DisplayName="Tekstlinje 3" DefaultValue="" />
		<CustomAttribute DataType="String" Name="TEKST4" DisplayName="Tekstlinje 4" DefaultValue="" />
		<CustomAttribute DataType="String" Name="TEKST5" DisplayName="Tekstlinje 5" DefaultValue="Arbeidsområde" />
		<CustomAttribute DataType="String" Name="TEKST6" DisplayName="Tekstlinje 6" DefaultValue="" />

		<Variants>
			<Variant Name="Arbeidsområdeskilt Type 1-2" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-ARBEIDSOMRÅDE-1-2" />
			</Variant>
			<Variant Name="Arbeidsområdeskilt Type 1-3" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-ARBEIDSOMRÅDE-1-3" />
			</Variant>
			<Variant Name="Arbeidsområdeskilt Type 2-2" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-ARBEIDSOMRÅDE-2-2" />
			</Variant>
			<Variant Name="Arbeidsområdeskilt Type 2-3" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-ARBEIDSOMRÅDE-2-3" />
			</Variant>
			<Variant Name="Arbeidsområdeskilt Orienterende" >		
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-SKILT-ARBEIDSOMRÅDE-3" />
			</Variant>	
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />
		
		<InsertPointObject VariantName="Arbeidsområdeskilt Type 1-2" DisplayBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-ARBEIDSOMRAADE-1-2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="TEKST1" Value="Arbeidsområde" />
			<SetValue Key="TEKST2" Value="OSL 1" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Arbeidsområdeskilt Type 1-3" DisplayBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-ARBEIDSOMRAADE-1-3-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="TEKST1" Value="Arbeidsområde" />
			<SetValue Key="TEKST2" Value="OSL 1" />
			<SetValue Key="TEKST3" Value="OSL 3" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Arbeidsområdeskilt Type 2-2" DisplayBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-ARBEIDSOMRAADE-2-2-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="TEKST1" Value="   Arb.område" />
			<SetValue Key="TEKST2" Value="OSL 1" />
			<SetValue Key="TEKST4" Value="Arb.område   " />
			<SetValue Key="TEKST5" Value="OSL 3" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Arbeidsområdeskilt Type 2-3" DisplayBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-ARBEIDSOMRAADE-2-3-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="TEKST1" Value="Venstre" />
			<SetValue Key="TEKST2" Value="Arbeidsområde" />
			<SetValue Key="TEKST3" Value="OSL 1" />
			<SetValue Key="TEKST4" Value="Høyre" />
			<SetValue Key="TEKST5" Value="Arbeidsområde" />
			<SetValue Key="TEKST6" Value="OSL 3" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Arbeidsområdeskilt Orienterende" DisplayBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-ARBEIDSOMRAADE-3-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="dir" Value="none" />
			<SetValue Key="TEKST2" Value="Port til:" />
			<SetValue Key="TEKST4" Value="Arbeidsområde" />
			<SetValue Key="TEKST5" Value="OSL 1 - OSL 3" />
		</InsertPointObject>
		
		<!-- Note: EnableDirectionSetting=="true" in element InsertPointObject (enable keybd shortcut for direction flipping up/down), so RC adds 180 DD to the 'down' direction: -->
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD-ARBEIDSOMRAADE-3-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKV-SKILT-VEDLIKEHOLD
				{% if Variant == 'Arbeidsområdeskilt Type 1-2' %}ARBEIDSOMRAADE-1-2
				{% elsif Variant == 'Arbeidsområdeskilt Type 1-3' %}ARBEIDSOMRAADE-1-3
				{% elsif Variant == 'Arbeidsområdeskilt Type 2-2' %}ARBEIDSOMRAADE-2-2
				{% elsif Variant == 'Arbeidsområdeskilt Type 2-3' %}ARBEIDSOMRAADE-2-3
				{% elsif Variant == 'Arbeidsområdeskilt Orienterende' %}ARBEIDSOMRAADE-3
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
			<SymbolAttribute Tag="TEKST1" >
				<Value>{{TEKST1}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TEKST2" >
				<Value>{{TEKST2}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TEKST3" >
				<Value>{{TEKST3}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TEKST4" >
				<Value>{{TEKST4}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TEKST5" >
				<Value>{{TEKST5}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="TEKST6" >
				<Value>{{TEKST6}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{TEKST1}}</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>{{TEKST2}}</Value>
			</Attribute>
			<Attribute Tag="T03" >
				<Value>{{TEKST3}}</Value>
			</Attribute>
			<Attribute Tag="T04" >
				<Value>{{TEKST4}}</Value>
			</Attribute>
			<Attribute Tag="T05" >
				<Value>{{TEKST5}}</Value>
			</Attribute>
			<Attribute Tag="T06" >
				<Value>{{TEKST6}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
				<SnapPoint X="3" Y="0" />
				<SnapPoint X="-3" Y="0" />
				<SnapPoint X="0" Y="3" />
				<SnapPoint X="0" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>
	

	
<!--========================================================================================================
	SIGN
	THIRD PERSON
	JBTKO_SKT Rømningsavstand
	Mann, pil og avstand til nærmeste rømningsvei(er), vendt mot gangbane ved sporet
	TODO: Skille på 2D-symbol for begge veier, bare venstre og bare høyre avstand.
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssEscapeRouteDistance" Name="JBTKO_SKT Rømningsavstand"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Tredjeperson"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>skilt</RelationSpace>
		<AttachmentCategory Name="skilt" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt" />
		<AttachTo Category="kl-mast" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />
					
		<Variants DefaultValue="Skilt Rømningsavstand begge veier" >
			<Variant Name="Skilt Rømningsavstand begge veier" >
			</Variant>
			<Variant Name="Skilt Rømningsavstand mot venstre" >
			</Variant>
			<Variant Name="Skilt Rømningsavstand mot høyre" >
			</Variant>
		</Variants>

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />
		
		<SetValue Key="dir" Value="both" />

		<CustomAttribute DataType="String" Name="LeftDistance" DisplayName="Rømningsavstand mot venstre" DefaultValue="-" 
			Description="The 'LeftDistance' custom attribute holds the distance, along own alignment, between the board and a left-sided related marker object." />
		<CustomAttribute DataType="String" Name="RightDistance" DisplayName="Rømningsavstand mot høyre" DefaultValue="-"
			Description="The 'RightDistance' custom attribute holds the distance, along own alignment, between the board and a right-sided related marker object." />
		
		<LuaExpression Name="LeftDistance" ><Formula>NOBN_bnp_getEscapeDistanceBoardTextLeft(10,0)</Formula></LuaExpression>
		<LuaExpression Name="RightDistance" ><Formula>NOBN_bnp_getEscapeDistanceBoardTextRight(10,0)</Formula></LuaExpression>

		<LuaExpression Name="Geometry3D_0.Name" >
			<Formula>
				if Variant == "Skilt Rømningsavstand begge veier" then
					return "NO-BN-3D-KO-SKT-SKILT-RØMNINGSAVSTAND-VH"
				elseif  Variant == "Skilt Rømningsavstand mot venstre" then
					return "NO-BN-3D-KO-SKT-SKILT-RØMNINGSAVSTAND-V" 
				elseif  Variant == "Skilt Rømningsavstand mot høyre" then
					return "NO-BN-3D-KO-SKT-SKILT-RØMNINGSAVSTAND-H"
				else
					return "Unrecognized variant ["..Variant.."], cannot Evaluate 3D geometry's 'Name'",_warning
				end
			</Formula>
		</LuaExpression>
		
		<InsertPointObject VariantName="Skilt Rømningsavstand begge veier" DisplayBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-ROEMNINGSVEI-VH-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.8" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Skilt Rømningsavstand mot venstre" DisplayBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-ROEMNINGSVEI-V-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.8" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Skilt Rømningsavstand mot høyre" DisplayBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-ROEMNINGSVEI-H-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4.8" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
		</InsertPointObject>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-ROEMNINGSVEI-VH-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON
				{% if Variant == 'Skilt Rømningsavstand begge veier' %}ROEMNINGSVEI-VH
				{% elsif Variant == 'Skilt Rømningsavstand mot venstre' %}ROEMNINGSVEI-V
				{% elsif Variant == 'Skilt Rømningsavstand mot høyre' %}ROEMNINGSVEI-H
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
			<SymbolAttribute Tag="VDIST" >
				<Value>{{LeftDistance}}</Value>
			</SymbolAttribute>
			<SymbolAttribute Tag="HDIST" >
				<Value>{{RightDistance}}</Value>
			</SymbolAttribute>
		</SymbolDefinition>

		<Annotation3DTagDefinition>
			<Attribute Tag="T01" >
				<Value>{{LeftDistance}}</Value>
			</Attribute>
			<Attribute Tag="T02" >
				<Value>{{RightDistance}}</Value>
			</Attribute>
		</Annotation3DTagDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>



<!--========================================================================================================
	SKILT
	TREDJEPERSON
	JBTKO_SKT Stopp se og lytt
	'Stopp! se og lytt etter tog' - skilt mot vei
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Sign" LuaName="rctype_SignNssLookOutForTrain" Name="JBTKO_SKT Stopp se og lytt"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer"
				Group="Skilt/Tredjeperson"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>skilt_mot_vei</RelationSpace>
		<AttachmentCategory Name="skilt_mot_vei" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt_mot_vei" />
		<AttachTo Category="signal_mot_vei" />
		<AttachTo Category="skiltfeste" DrawTail="true" />
		
		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SKT" />
		

		<Variants>
			<Variant Name="Skilt Stopp se og lytt" >
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-FE-DIV-UKJENT" />
			</Variant>
		</Variants> 
		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<SetValue Key="dir" Value="both" />
		
		<InsertPointObject VariantName="Skilt Stopp se og lytt" DisplayBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-STOPPSEOGLYTT-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" >
			<OwnAlignmentTargetSpace>vei</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfRightSideOfAlignment="true" AddAngle="0" EnableDirectionSetting="false" />
		</InsertPointObject>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-STOPPSEOGLYTT-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt_mot_vei" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>

	</ObjectType>

	

<!--========================================================================================================
	SKILT
	TREDJEPERSON
	SA-MSS Trafikkskilt 138 Jernbaneovergang
	Diverse skilt, Trafikkskilt 138 Jernbaneovergang / ... vendt mot vei
=========================================================================================================-->
	<ObjectType DataType="tSign" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.StAndrewsCross" LuaName="rctype_SignStAndrewsCross" Name="SA-MSS Trafikkskilt 138 Jernbaneovergang"
				DrawTail="true"
				Layer="JBTKO_SKT" Color="ByLayer" 
				Group="Skilt/Tredjeperson"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>skilt_mot_vei</RelationSpace>
		<AttachmentCategory Name="skilt_mot_vei" PassAttachmentToTarget="true" />
		<AttachTo Category="skilt_mot_vei" />
		<AttachTo Category="signal_mot_vei" DrawTail="true" />
		<AttachTo Category="skiltfeste" DrawTail="true" />

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___VERTICAL_AND_STACKED___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___BNP" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_BOARD_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_RAIL" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_SA_MSS" />
		
		<!-- To be mounted on level crossing signal towards road traffic -->

		<Variants DefaultValue="Andreaskors for enkeltspor" >
			<Variant Name="Andreaskors for enkeltspor" >
				<SetValue Key="name" Value="Jernbaneovergang" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-TRAFIKKSKILT-138-JERNBANEOVERGANG-ENKELTSPOR" />
			</Variant>
			<Variant Name="Andreaskors for flere spor" >
				<SetValue Key="name" Value="Jernbaneovergang flere spor" />
				<SetValue Key="Geometry3D_0.Name" Value="NO-BN-3D-SA-MSS-TRAFIKKSKILT-138-JERNBANEOVERGANG-FLERSPOR" />
			</Variant>
		</Variants> 

		<SetDynamicProperty Type="Representation" Subtype="Geometry3D" />

		<InsertPointObject VariantName="Andreaskors for enkeltspor" DisplayName="Trafikkskilt 138 Jernbaneovergang"
				DisplayBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-138-MOT-VEI-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>vei</OwnAlignmentTargetSpace>
			<OwnAlignmentTargetSpace>hjelpelinje</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Andreaskors for flere spor" DisplayName="Trafikkskilt 138 Jernbaneovergang flere spor"
				DisplayBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-138-MOT-VEI-FLERE-SPOR-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="3.5" AskForAttachment="true" >
			<OwnAlignmentTargetSpace>vei</OwnAlignmentTargetSpace>
			<OwnAlignmentTargetSpace>hjelpelinje</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="-90" EnableDirectionSetting="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON-138-MOT-VEI-{{SymbolMode}}" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270|plus:0}}
														{% elsif dir == 'down' %}{{90|plus:0}}
														{% elsif dir == 'both' and RightSided %}{{180|plus:0}}
														{% elsif dir == 'both' and LeftSided %}{{0|plus:0}}
														{% elsif dir == 'none' and RightSided %}{{0|plus:0}}
														{% elsif dir == 'none' and LeftSided %}{{180|plus:0}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTSK_SKP-SKILT-TREDJEPERSON
				{% if Variant == 'Andreaskors for enkeltspor' %}138-MOT-VEI
				{% elsif Variant == 'Andreaskors for flere spor' %}138-MOT-VEI-FLERE-SPOR
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
			
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" DoNotIncludeInSymbolFrame="true" />

		<DockPointDefinitions>
			<SnapPoints>
				<SnapPoint X="0" Y="0" TargetSpace="skilt_mot_vei" />
				<SnapPoint X="0" Y="0" TargetSpace="skiltfeste" />
			</SnapPoints>
		</DockPointDefinitions>

		<DisplayPointDefinitions>
			<SnapPoints>
				<SnapPoint X="3" Y="3" />
				<SnapPoint X="3" Y="-3" />
				<SnapPoint X="-3" Y="3" />
				<SnapPoint X="-3" Y="-3" />
			</SnapPoints>
		</DisplayPointDefinitions>
	</ObjectType>
	


<!--========================================================================================================
    Placement in 3D relative to insertion point 
=========================================================================================================-->
	<LuaFunction Name="NOBN_bnp_getBoardOffset3DZ()" ReturnType="String"
		Description="Returns the default pole 3D offset Z, i.e. the height of the pole." >
		<Constructor>Double NOBN_bnp_getBoardOffset3DZ()</Constructor>
		<Formula>
			function NOBN_bnp_getBoardOffset3DZ()
				-- To be mounted below other board on common pole:
				if Variant:find("Meterangivelse") then return 2.6 --May be placed under 68F
				elseif Variant:find("68F") then return 2.8 --Tilleggshastighet, to be placed under 68
			
				--To be mounted relatively low on NSI63 optical signal's mast:
				elseif Variant:find("62") then return 2.85 --Ugyldighetssignal på standard Bane NOR signalmast alternativ 2
				elseif Variant:find("72") then return 2.45 --FJS begynner/slutter
				elseif Variant:find("73") then return 2.45 --Rasvarsling
				elseif Variant:find("F-ATC") or Variant:find("D-ATC") then return 2.9
			
				--To be mounted on front/top of optical light signal's sunscreen:
				elseif Variant:find("60E") then return 5.80 --ATC Varsel. Remember to adjust Offset3D.Y as well.
			
				--Close to track, low placement, with pole:
				elseif Variant:find("Bevegelig kryss") then return 0.5 --Short vertical pole close to track
				elseif Variant:find("69") then return 1.5 --Temporary speed restriction, to be mounted with horizontal pole to track/sleeper
			
				--Close to track, low placement, no pole:
				elseif Variant:find("Baliseskilt") then return 0.0 --Mounted on platform element's side towards track, at A-balise
			
				--May be hanging from portal, othwerwise on own pole:
				elseif Variant:find("Spornummer") then return PortalMounted and -1 or 3.5
				-- TODO elseif Variant:find("E34") then return PortalMounted and -1 or 3.5 --ERTMS Stedsskilt
				elseif Variant:find("E35") then return PortalMounted and -1 or 3.5 --ERTMS Stoppskilt
			
				--To be read by train driver sitting in train, AND by walking people:
				elseif Variant:find("1000V") then return 2.5
				elseif Variant:find("kjedebrudd") then return 2.5
			
				--To be read by walking people:
				elseif Variant:find("Nødtelefon") then return 2.00
				elseif Variant:find("Stopp se og lytt") then return 2.00 --Skilt langs bilvei, for mennesker
				elseif Variant:find("Arbeidsområde") then return 2.02 --Tenkt montert på et NSI hovedsignal
			
				-- High relative Elevations, no pole:
				elseif Variant:find("75B") then return 0.0 --Old km board type, directly on tunnel wall (high RelativeElevation)
				elseif Variant:find("Rømningsavstand") then return 0.0 --Escape route distance / direction board, directly on tunnel wall
			
				else 
					return 3.5
				end
			end
		</Formula>
	</LuaFunction>



<!--========================================================================================================
    Pole routing
=========================================================================================================-->
	<LuaFunction Name="NOBN_bnp_getPoleRoutingDefaultValue()" ReturnType="String"
		Description="Returns the default pole setting for the board in question, from {'none','vertical','horizontal'}." >
		<Constructor>Enumeration {'None','Vertical','Horizontal'} NOBN_bnp_getPoleRoutingDefaultValue()</Constructor>
		<Formula>
			function NOBN_bnp_getPoleRoutingDefaultValue()
				if RcType == rctype_EtcsEoA then
					return "Vertical"
				
				elseif RcType:match("JBTSA_MSS") or RcType:match("JBTKO_SKT") or RcType:match("JBTEH_BKT") then
					--Those who do NOT use pole routing:
					if Variant:match("Baliseskilt")
					or Variant:match("60E")
					or Variant:match("62")
					or Variant:match("64")
					or Variant:match("65") --pantograph signs are usually mounted on OCS pole
					or Variant:match("67E")
					or Variant:match("68D%-2")
					or Variant:match("68D%-3")
					or Variant:match("68F")
					or Variant:match("70")
					or Variant:match("72A")
					or Variant:match("72B")
					or Variant:match("73")
					or Variant:match("Arbeidsområde")
					or Variant:match("138") --Traffic sign St.Andrew cross along road at level crossing, to be fixed on traffic light towards road.
					then 
						return "None"
					
					elseif Variant:find("69") then
						return "Horizontal" --Fixed with temporary bracket to closest rail/sleeper

					else 
						return "Vertical"
					end
				else
					return "None"
				end
			end
		</Formula>
	</LuaFunction>


	
<!--========================================================================================================
    Sighting distance requirement for boards
=========================================================================================================-->
	<LuaFunction Name="NOBN_bnp_getBoardSightingRequirement()" ReturnType="String"
		Description="Returns the sighting requirement according to TRV regulations for vegetation clearance towards boards. Speed is extracted from the object's own alignment using getAlignmentInfo().Speed." >
		<Constructor>Double NOBN_bnp_getBoardSightingRequirement()</Constructor>
		<Formula>
			function NOBN_bnp_getBoardSightingRequirement()
				local DesignSpeed = getAlignmentInfo().Speed or 130 --130 km/h assumed if alignment has no design speed available
			
				if 	   Variant:find("Baliseskilt")
					or Variant:find("Arbeidsområde")
					or Variant:find("75C") -- 75C: Hev sporrenser
					or Variant:find("75D") -- 75D: Senk sporrenser
					or Variant:find("60E") --ATC Varsel - Monteres på Fs eller Hs+Fs
					or Variant:find("62") --Ugyldighetsskilt - står alltid sammen med Hs, Fs eller enkelt innkjørsignal
					or Variant:find("64E") --64E: Blå/Hvit Teknisk stolpe
					or Variant:find("67E") --Orienteringssignal dagtid, unngå å gi signal 83 "Tog kommer" mellom kl 22 og 06
					or Variant:find("68F") --Tilleggshastighet underskilt - står alltid sammen med signal 68AB
					or Variant:find("68G") --Krengetoghasighet underskilt - står alltid sammen med signal 68AB
					or Variant:find("101") --ID-skilt av alle typer
					or Variant:find("102") --PIL
					or Variant:find("138") --Traffic sign St.Andrew cross along road at level crossing, to be fixed on traffic light towards road.
				then
					--No sighting requirement:
					return 0, _info("No sighting requirement.")
			
				elseif
					(Variant:find("60") and not Variant:find("60E")) --60ABCD_FGH: ATC skilt
					or Variant:find("61") --61ABC: Avstandsskilt 1/2/3 (1000/800/250 meter)
					or Variant:find("63") --63AB: Fallviser/Stigningsviser
					or Variant:find("64A") --64A: Grense-innkoblingsstolpe
					or Variant:find("64B") --64B: Seksjoneringsstolpe
					or Variant:find("64C") --64C: Rasvarslingsstolpe
					or Variant:find("64D") --64D: Bremsestolpe
					or Variant:find("65") --65ABCDEFG: KL-skilt
					or Variant:find("66") --66: Togvei slutt
					or Variant:find("68A") --69A: Nedsatt hastighet
					or Variant:find("68B") --69B: Økt hastighet
					or Variant:find("68C") --69C: Avvikende hastighet
					or Variant:find("68D") --69D: Markeringsmerke
					or Variant:find("69") --69AB: Midlertidig hastighet
					or Variant:find("70") --70: Planovergangsskilt "V"
					or Variant:find("72") --72AB: FJS begynner/slutter
					or Variant:find("73") --73: Rasvarsling
					or Variant:find("74") --74: Toglengdeskilt
					or Variant:find("75A") --75AB: Kilometerskilt, gammel type
					or Variant:find("75B") --75AB: Kilometer, ny type
				then
					-- Ref TRV Underbygning vedlikehold, 2.1.1 "Sikt til signaler og skilt"
					v = math.max(40,math.min(130,DesignSpeed))
					d = RC__round(v/3.6 * 5, 0)
					return d, _info(d.."m required at "..DesignSpeed.." km/h (5 seconds unbroken sighting, min. 56m, max. 181m.")
			
				elseif		
					--Krav som til dvergsignaler pga kun aktuelle å observere under skifting (40 km/h / 50 meter)
					Variant:find("51") --51ABCD: Sporvekselsignal, lysreflekterende. A=tilRettspor, B=fraAvvik, C=tilV, D=tilH
					or Variant:find("52") --52ABCD: Sporvekselsignal for kryssporveksel. A=fraVtilH, B=fraHtilV, C=fraVtilV, D=fraHtilH.
					or Variant:find("53") --53: Sporsperresignal, "sporet sperret"
					or Variant:find("54") --54: Sporsperresignal, "sporet fritt"
					or Variant:find("64E") --64E: Dvergsignalstolpe
				then
					return 50, _info("50 m fixed sighting requirement during shunting movements.")
			
				else
					return 0, _info(DesignSpeed.." km/h: Bad board type [RcType="..RcType..", Variant="..(Variant and "(void)" or Variant.."."))
				end
			end
		</Formula>
	</LuaFunction>



<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

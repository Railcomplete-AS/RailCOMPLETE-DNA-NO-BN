<!--========================================================================================================

    NO-BN-OcsVariousObjects.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2021. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>

<!--========================================================================================================
	Line(ca)	Contents:
	  25		PROTECTION SCREEN AGAINST OVERVOLTAGE
	 220		SECTIONING ISOLATOR
	 290		CONTACT WIRE ISOLATOR
	 350		CATENARY SUPPORT WIRE ISOLATOR (and for contact wires outside the pantograph's reach)
	 420		FLOATING CROSSING
	 500		CURRENT BRIDGE
	 560		End Of File
=========================================================================================================-->


	
<!--========================================================================================================
	HIGH VOLTAGE
	PROTECTION SCREEN AGAINST HIGH VOLTAGE
=========================================================================================================-->
	<!-- See EH.705338, 900x1400 single screen construction. -->
	<!-- See EH.704042, 2000x775 double-screen construction. -->
	<!-- See EH.705339, Utførelse type I, II, III, IV/V - various ways to mount 2 x 900x1400 screens. -->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Fixing" LuaName="rctype_OcsProtectiveScreen" Name="JBTEH_ASK Avskjerming"
				Layer="JBTEH_ASK" Color="ByLayer"
				Group="Kontaktledning/Avskjerming"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				 
		<RelationSpace>avskjerming</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___OCS" />
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />

		<Variants DefaultValue="Avskjerming 2x900x1400xØ32 på betongmast / bjelkemast" >
			<Variant Name="Avskjerming 2x900x1400xØ32 på tunnelmast / tremast" >
				<!-- See EH.705338, Utførelse type I, II, III, IV/V-->
			</Variant>
			<Variant Name="Avskjerming 2x900x1400xØ32 på betongmast / bjelkemast" >
				<!-- See EH.705338, Utførelse type VI -->
				<!-- Assume HEB mast 200..280, or 240x240 concrete mast (3D models are made only for 240x240): -->
			</Variant>
			<Variant Name="Avskjerming 2x900x1400xØ32 på B-mast bredside" >
				<!-- See EH.705338, Utførelse type VI -->
			</Variant>
			<Variant Name="Avskjerming 2x900x1400xØ32 på B-mast smalside / H-mast" >
				<!-- See EH.705338, Utførelse type VI -->
			</Variant>
			<Variant Name="Avskjerming 2x900x1400xØ32 på hengemast" >
				<!-- See EH.705338, Utførelse type VI -->
			</Variant>
			<Variant Name="Avskjerming 2000x775xØ32 i åk, ett felt" >
				<!-- See EH.704042 type I+II (two plus two ears, placed one pair above the other) -->
			</Variant>
			<Variant Name="Avskjerming 2000x775xØ32 i åk, to felt" >
				<!-- See EH.704042 type I+II (two plus two ears, placed one pair above the other) -->
			</Variant>
		</Variants>

		<SetDynamicProperty DynamicPropertiesPropertyName="Representation" DynamicPropertyType="Model3D"/>

		<CustomAttribute DataType="Enumeration" Name="Tilt" DisplayName="Tilt"
			Description=
			"900x1400 protective screen inclination [00|01|10|11]: 00=none tilted, 01=tilted right, 10=tilted left, 11=both tilted." >
			<Values >
				<Value>00</Value>
				<Value>01</Value>
				<Value>10</Value>
				<Value>11</Value>
			</Values>
		</CustomAttribute>
		
		<TextPositionLuaExpression Name="OBJEKTNAVN" ><Formula>RC__TextAttributePosition(23,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTID" ><Formula>RC__TextAttributePosition(25,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTBESKRIVELSE" ><Formula>RC__TextAttributePosition(27,0)</Formula></TextPositionLuaExpression>

		<LuaExpression Name="name" >
			<Formula>
				if Variant:match("Avskjerming") then return "Avskjerming"
				else return "Unknown protective screen variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<!-- Reference 3D elevation is assumed to be be center of upper Ø32 tube frame -->
		<LuaExpression Name="Model3D_0.Model3DName" >
			<Formula>
				local s = "NO-BN-3D-EH-ASK-AVSKJERMING-2x900x1400xØ32-UTF"
				local t = "NO-BN-3D-EH-ASK-AVSKJERMING-2000x775xØ32"
				if Variant == "Avskjerming 2x900x1400xØ32 på tunnelmast / tremast" then 
					return string.format("%s-%d-%02d",s,1,tonumber(Tilt))
				elseif Variant == "Avskjerming 2x900x1400xØ32 på betongmast / bjelkemast" then 
					return string.format("%s-%d-%02d",s,2,tonumber(Tilt))
				elseif Variant == "Avskjerming 2x900x1400xØ32 på B-mast bredside" then 
					return string.format("%s-%d-%02d",s,3,tonumber(Tilt))
				elseif Variant == "Avskjerming 2x900x1400xØ32 på B-mast smalside / H-mast" then 
					return string.format("%s-%d-%02d",s,45,tonumber(Tilt))
				elseif Variant == "Avskjerming 2x900x1400xØ32 på hengemast" then 
					return string.format("%s-%d-%02d",s,6,tonumber(Tilt))
				elseif Variant == "Avskjerming 2000x775xØ32 i åk, ett felt" then 
					return string.format("%s-%s",t,"A")
				elseif Variant == "Avskjerming 2000x775xØ32 i åk, to felt" then 
					return string.format("%s-%s",t,"B")
				else 
					return "Unknown protective screen Variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<InsertPointObject VariantName="Avskjerming 2x900x1400xØ32 på tunnelmast / tremast"
				DisplayBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-1-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="false" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="Tilt" Value="00" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="RelativeElevation" Value="6.8" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Avskjerming 2x900x1400xØ32 på betongmast / bjelkemast" 
				DisplayBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-2-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="false" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="Tilt" Value="00" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="RelativeElevation" Value="6.8" />
		</InsertPointObject>

		<InsertPointObject VariantName="Avskjerming 2x900x1400xØ32 på B-mast bredside" 
				DisplayBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-3-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="false" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="Tilt" Value="00" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="RelativeElevation" Value="6.8" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Avskjerming 2x900x1400xØ32 på B-mast smalside / H-mast" 
				DisplayBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-45-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="false" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="Tilt" Value="00" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="RelativeElevation" Value="6.8" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Avskjerming 2x900x1400xØ32 på hengemast" 
				DisplayBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-6-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="false" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="Tilt" Value="00" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="RelativeElevation" Value="6.8" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Avskjerming 2000x775xØ32 i åk, ett felt" 
				DisplayBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-704042-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="false" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="Tilt" Value="00" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="RelativeElevation" Value="6.8" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="Avskjerming 2000x775xØ32 i åk, to felt" 
				DisplayBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-704042-{{SymbolMode}}"
				DefaultSnapMode="Point" SnapToAlignment="false" SnapDistance="4.0" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="false" RotateIfRightSideOfAlignment="true" />
			<SetValue Key="Tilt" Value="00" />
			<SetValue Key="dir" Value="both" />
			<SetValue Key="RelativeElevation" Value="6.8" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_ASK-AVSKJERMING-1-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_ASK
				AVSKJERMING
				{% if Variant == 'Avskjerming 2x900x1400xØ32 på tunnelmast / tremast' %}1
				{% elsif Variant == 'Avskjerming 2x900x1400xØ32 på betongmast / bjelkemast' %}2
				{% elsif Variant == 'Avskjerming 2x900x1400xØ32 på B-mast bredside' %}3
				{% elsif Variant == 'Avskjerming 2x900x1400xØ32 på B-mast smalside / H-mast' %}45
				{% elsif Variant == 'Avskjerming 2x900x1400xØ32 på hengemast' %}6
				{% elsif Variant == 'Avskjerming 2000x775xØ32 i åk, ett felt' %}704042
				{% elsif Variant == 'Avskjerming 2000x775xØ32 i åk, to felt' %}704042
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	SECTIONING ISOLATOR
=========================================================================================================-->
	<ObjectType DataType="RailCOMPLETEContinuation" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Fixing" LuaName="rctype_OcsSectioningIsolator" Name="JBTEH_SIL Seksjonsisolator"
				Layer="JBTEH_SIL" Color="ByLayer"
				Group="Kontaktledning/Isolatorer"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>seksjonsisolator</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_VERY_CLOSE___OCS" />
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_ocs_STD_LUAEXPRESSIONS___OVERHEADLINEBOUND_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_EH_SIL" />
	
		<Variants DefaultValue="Seksjonsisolator" >
			<Variant Name="Seksjonsisolator" >
			</Variant>
		</Variants>

		<SetDynamicProperty DynamicPropertiesPropertyName="Representation" DynamicPropertyType="Model3D"/>

		<TextPositionLuaExpression Name="OBJEKTNAVN" ><Formula>RC__TextAttributePosition(3,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTID" ><Formula>RC__TextAttributePosition(5,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTBESKRIVELSE" ><Formula>RC__TextAttributePosition(7,0)</Formula></TextPositionLuaExpression>

		<LuaExpression Name="code" ><Formula>Variant</Formula></LuaExpression>
		<LuaExpression Name="name" ><Formula>"Seksj.isol."</Formula></LuaExpression>

		<LuaExpression Name="Model3D_0.Model3DName" >
			<Formula>
				-- Ref. EK.704790, for speeds up to 80 km/h. Not drawn entirely to scale!
				if Variant == "Seksjonsisolator" then return "NO-BN-3D-EH-SIL-SEKSJONSISOLATOR-BICC"
				else return "Unknown section insulator variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<LuaExpression Name="Alignment" ><Formula>_JBTEH_SIL_Alignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_SIL_Alignment()" ReturnType="Double"
				Description="Obtains the mileage from its alignment." >
			<Constructor>Double _JBTEH_SIL_Alignment()</Constructor>
			<Formula>
				function _JBTEH_SIL_Alignment()
					tol = 1 --[m]
					closestAlignments = getClosestAlignments(tol,rctype_ContactWire)
					a1 = closestAlignments[0]
					a2 = closestAlignments[1]
					if a2 and RC__getDistance2D(a2.RcAlignment.EndPoint) &lt; tol then
						return a2,_info("Own alignment "..a2.code.." selected as CW, being the closest alignment with an end point within "..tol.." m from this object.")
					else
						return a1,_info("Own alignment "..a1.code.." selected as CW.")
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="TargetAlignment" ><Formula>_JBTEH_SIL_TargetAlignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_SIL_TargetAlignment()" ReturnType="Double"
				Description="Obtains the target alignment, as long as its snaps to own alignment close to this continuation object (this isolator). The isolator is supposed to connect two contact wires. Note that breaking the contact wire alignment is only needed if you want the visual 2D linetype to change / to let the 3D expression change automatically here." >
			<Constructor>ObjRef _JBTEH_SIL_TargetAlignment()</Constructor>
			<Formula>
				function _JBTEH_SIL_TargetAlignment()
					tol = 1 --[m]
					ta = getClosestAlignments(Alignment.RcType):filter(function (x) return x.id ~= Alignment.id end)[0]
					if ta and RC__getDistance2D(this,ta.RcAlignment.StartPoint) &lt; tol then
						return ta,_info("Target alignment "..ta.code.." selected as the closest other CW alignment with a start point within "..tol.." m from this object.")
					else
						return nil,_info("No target CW alignment selected - Move within "..tol.." m from a CW start point to snap to start.")
					end
				end
			</Formula>
		</LuaFunction>
						
		<LuaExpression Name="Mileage" ><Formula>_JBTEH_SIL_mileage()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_SIL_mileage()" ReturnType="Double"
				Description="Returns 'mileage', snapped to a compatible alignment if within 1m from object." >
			<Constructor>Double _JBTEH_SIL_mileage()</Constructor>
			<Formula>
				function _JBTEH_SIL_mileage()
					tol = 1 --[m] Snap to end point of own alignment if it is used as a connecting object, and if it is already close to its alignment's end point
					if RC__getDistance2D(Alignment.RcAlignment.EndPoint) &lt; tol then
						if RC__isNan(getAlignmentInfo().RelativePosition) then
							return _warning,getPropertyValue("mileage"),_info("No projection onto own alignment: Move object within reach of own alignment to snap to endpoint")
						else
							return Alignment.RcAlignment.EndMileage,_info("Snapped to endpoint of own alignment")
						end
					else
						return getPropertyValue("mileage"),_info("No snapping because we are far from own alignment's endpoint")
					end
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject VariantName="Seksjonsisolator" DisplayBlockName="NO-BN-2D-JBTEH_SIL-ISOLATOR-SEKSJONSISOLATOR-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>kontaktledning</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_SIL-ISOLATOR-SEKSJONSISOLATOR-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="true" />
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_SIL
				ISOLATOR
				{% if Variant == 'Seksjonsisolator' %}SEKSJONSISOLATOR
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	CATENARY SUPPORT WIRE ISOLATOR
	(and for contact wires tensioning wire outside, the pantograph's reach)
=========================================================================================================-->
	<ObjectType DataType="RailCOMPLETEContinuation" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Fixing" LuaName="rctype_OcsIsolator" Name="JBTEH_ISO Lineisolator"
				Layer="JBTEH_ISO" Color="ByLayer"
				Group="Kontaktledning/Isolatorer"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>lineisolator</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_VERY_CLOSE___OCS" />
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_ocs_STD_LUAEXPRESSIONS___OVERHEADLINEBOUND_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />

		<!-- Model checks (special care is taken for the JBTEH_ISO object): -->
		<xpp:expand select="NOBN_com_CHK_CONNECTION___CONTINUATION" />

		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />

		<Variants DefaultValue="Lineisolator" >
			<Variant Name="Lineisolator" >
			</Variant>
		</Variants>
		
		<SetDynamicProperty DynamicPropertiesPropertyName="Representation" DynamicPropertyType="Model3D"/>

		<TextPositionLuaExpression Name="OBJEKTNAVN" ><Formula>RC__TextAttributePosition(3,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTID" ><Formula>RC__TextAttributePosition(5,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTBESKRIVELSE" ><Formula>RC__TextAttributePosition(7,0)</Formula></TextPositionLuaExpression>
		
		<LuaExpression Name="code" ><Formula>Variant</Formula></LuaExpression>
		<LuaExpression Name="name" ><Formula>"Isol."</Formula></LuaExpression>

		<LuaExpression Name="Model3D_0.Model3DName" >
			<Formula>
				if Variant == "Lineisolator" then
					return "NO-BN-3D-EH-ISO-LINEISOLATOR-600x100"
				else
					return _warning,"Unrecognized variant ["..Variant.."]."
				end
			</Formula>
		</LuaExpression>

		<LuaExpression Name="Alignment" ><Formula>_JBTEH_ISO_Alignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_ISO_Alignment()" ReturnType="Double"
				Description="Obtains the mileage from its alignment." >
			<Constructor>Double _JBTEH_ISO_Alignment()</Constructor>
			<Formula>
				function _JBTEH_ISO_Alignment()
					tol = 1 --[m]
					closestAlignments = getClosestAlignments(tol):filter(function (x) return RC__isMemberOf({rctype_ContactWire,"JBTEH_FIL Fixline"},x.RcType) end)
					a1 = closestAlignments[0]
					a2 = closestAlignments[1]
					if a1.RcType == "JBTEH_FIL Fixline" then 
						return a1,_info("Own alignment "..a1.code.." selected as midpoint anchor line.")
					elseif a1.RcType == rctype_ContactWire then
						--see if we are close to an end point where two contact wires meet:
						if a2 and RC__getDistance2D(a2.RcAlignment.EndPoint) &lt; tol then
							return a2,_info("Own alignment "..a2.code.." selected as CW, being the closest alignment with an end point within "..tol.." m from this object.")
						else
							return a1,_info("Own alignment "..a1.code.." selected as CW.")
						end
					else
						return _error,nil,_info("ERROR - Isolator was inserted too far from a compatible alignment - move closer.")
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="TargetAlignment" ><Formula>_JBTEH_ISO_TargetAlignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_ISO_TargetAlignment()" ReturnType="Double"
				Description="Obtains the target alignment, as long as its snaps to own alignment close to this continuation object (this isolator). The isolator is supposed to connect a contact wire with a contact wire tensioning wire, or to connect two parts of a tensioning wire. Note that breaking the contact wire alignment is only needed if you want the visual 2D linetype to change / to let the 3D expression change automatically here." >
			<Constructor>ObjRef _JBTEH_ISO_TargetAlignment()</Constructor>
			<Formula>
				function _JBTEH_ISO_TargetAlignment()
					tol = 1 --[m]
					if Alignment.RcType == rctype_ContactWire then
						ta = getClosestAlignments(Alignment.RcType):filter(function (x) return x.id ~= Alignment.id end)[0]
						if ta and RC__getDistance2D(this,ta.RcAlignment.StartPoint) &lt; tol then
							return ta,_info("Target alignment "..ta.code.." selected as the closest other CW alignment with a start point within "..tol.." m from this object.")
						else
							return nil,_info("No target CW alignment selected - Move within "..tol.." m from a CW start point to snap to start.")
						end
					elseif Alignment.RcType == "JBTEH_FIL Fixline" then
						return nil,_nosymbol,_info("No target alignment selected since midpoint anchor lines shall not be split in several alignment parts.")
					else
						return nil,_error,_info("ERROR - Unexpected alignment type '"..Alignment.RcType.."'.")
					end
				end
			</Formula>
		</LuaFunction>
						
		<LuaExpression Name="Mileage" ><Formula>_JBTEH_ISO_mileage()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_ISO_mileage()" ReturnType="Double"
				Description="Returns 'mileage', snapped to a compatible alignment if within 1m from object." >
			<Constructor>Double _JBTEH_ISO_mileage()</Constructor>
			<Formula>
				function _JBTEH_ISO_mileage()
					tol = 1 --[m] Snap to end point of own alignment if it is used as a connecting object, and if it is already close to its alignment's end point
					if RC__getDistance2D(Alignment.RcAlignment.EndPoint) &lt; tol then
						if RC__isNan(getAlignmentInfo().RelativePosition) then
							return _warning,getPropertyValue("mileage"),_info("No projection onto own alignment: Move object within reach of own alignment to snap to endpoint")
						else
							return Alignment.RcAlignment.EndMileage,_info("Snapped to endpoint of own alignment")
						end
					else
						return getPropertyValue("mileage"),_info("No snapping because we are far from own alignment's endpoint")
					end
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject VariantName="Lineisolator" DisplayBlockName="NO-BN-2D-JBTEH_ISO-ISOLATOR-LINEISOLATOR-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>kontaktledning</OwnAlignmentTargetSpace>
			<OwnAlignmentTargetSpace>fixline</OwnAlignmentTargetSpace> 
			<OwnAlignmentTargetSpace>kl-bardun</OwnAlignmentTargetSpace> 
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_ISO-ISOLATOR-LINEISOLATOR-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="true" />
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_ISO
				ISOLATOR
				{% if Variant == 'Lineisolator' %}LINEISOLATOR
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	CONTACT WIRE ISOLATOR
=========================================================================================================-->
	<ObjectType DataType="RailCOMPLETEContinuation" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Fixing" LuaName="rctype_OcsRodIsolator" Name="JBTEH_ISS Stavisolator"
				Layer="JBTEH_ISS" Color="ByLayer"
				Group="Kontaktledning/Isolatorer"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>stavisolator</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_VERY_CLOSE___OCS" />
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_ocs_STD_LUAEXPRESSIONS___OVERHEADLINEBOUND_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />

		<Variants DefaultValue="Stavisolator" >
			<Variant Name="Stavisolator" >
			</Variant>
		</Variants>

		<SetDynamicProperty DynamicPropertiesPropertyName="Representation" DynamicPropertyType="Model3D"/>

		<LuaExpression Name="code" ><Formula>Variant</Formula></LuaExpression>
		<LuaExpression Name="name" ><Formula>"Stavisol."</Formula></LuaExpression>

		<!-- TODO lage 3D for stavisolator -->
		<LuaExpression Name="Model3D_0.Model3DName" >
			<Formula>
				if Variant == "Stavisolator" then return "NO-BN-3D-EH-ISS-STAVISOLATOR"
				else return "Unrecognized variant ["..Variant.."].",_warning
				end
			</Formula>
		</LuaExpression>

		<LuaExpression Name="Alignment" ><Formula>_JBTEH_ISS_Alignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_ISS_Alignment()" ReturnType="Double"
				Description="Obtains the mileage from its alignment." >
			<Constructor>Double _JBTEH_ISS_Alignment()</Constructor>
			<Formula>
				function _JBTEH_ISS_Alignment()
					tol = 1 --[m]
					closestAlignments = getClosestAlignments(tol,rctype_ContactWire)
					a1 = closestAlignments[0]
					a2 = closestAlignments[1]
					if a2 and RC__getDistance2D(a2.RcAlignment.EndPoint) &lt; tol then
						return a2,_info("Own alignment "..a2.code.." selected as CW, being the closest alignment with an end point within "..tol.." m from this object.")
					else
						return a1,_info("Own alignment "..a1.code.." selected as CW.")
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="TargetAlignment" ><Formula>_JBTEH_ISS_TargetAlignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_ISS_TargetAlignment()" ReturnType="Double"
				Description="Obtains the target alignment, as long as its snaps to own alignment close to this continuation object (this isolator). The isolator is supposed to connect two contact wires. Note that breaking the contact wire alignment is only needed if you want the visual 2D linetype to change / to let the 3D expression change automatically here." >
			<Constructor>ObjRef _JBTEH_ISS_TargetAlignment()</Constructor>
			<Formula>
				function _JBTEH_ISS_TargetAlignment()
					tol = 1 --[m]
					ta = getClosestAlignments(Alignment.RcType):filter(function (x) return x.id ~= Alignment.id end)[0]
					if ta and RC__getDistance2D(this,ta.RcAlignment.StartPoint) &lt; tol then
						return ta,_info("Target alignment "..ta.code.." selected as the closest other CW alignment with a start point within "..tol.." m from this object.")
					else
						return nil,_info("No target CW alignment selected - Move within "..tol.." m from a CW start point to snap to start.")
					end
				end
			</Formula>
		</LuaFunction>
						
		<LuaExpression Name="Mileage" ><Formula>_JBTEH_ISS_mileage()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_ISS_mileage()" ReturnType="Double"
				Description="Returns 'mileage', snapped to a compatible alignment if within 1m from object." >
			<Constructor>Double _JBTEH_ISS_mileage()</Constructor>
			<Formula>
				function _JBTEH_ISS_mileage()
					tol = 1 --[m] Snap to end point of own alignment if it is used as a connecting object, and if it is already close to its alignment's end point
					if RC__getDistance2D(Alignment.RcAlignment.EndPoint) &lt; tol then
						if RC__isNan(getAlignmentInfo().RelativePosition) then
							return _warning,getPropertyValue("mileage"),_info("No projection onto own alignment: Move object within reach of own alignment to snap to endpoint")
						else
							return Alignment.RcAlignment.EndMileage,_info("Snapped to endpoint of own alignment")
						end
					else
						return getPropertyValue("mileage"),_info("No snapping because we are far from own alignment's endpoint")
					end
				end
			</Formula>
		</LuaFunction>

		<InsertPointObject VariantName="Stavisolator" DisplayBlockName="NO-BN-2D-JBTEH_ISS-ISOLATOR-STAVISOLATOR-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>kontaktledning</OwnAlignmentTargetSpace>
			<JigSymbolAppearance AddAngle="0" EnableDirectionSetting="true" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_ISS-ISOLATOR-STAVISOLATOR-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="true" />
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_ISS
				ISOLATOR
				{% if Variant == 'Stavisolator' %}STAVISOLATOR
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	FLOATING CROSSING
	(Norwegian: svevende kryss Ref. EH.707403)
=========================================================================================================-->
	<!-- TODO: This one may form the connection object between high voltage wires -->
	<ObjectType DataType="eCrossing" Class="RailwayPlacedObject" EulynxDataType="EULYNX.sig.Fixing" LuaName="rctype_FloatingWireCrossing" Name="JBTEH_SVE Svevende kryss"
				Layer="JBTEH_SVE" Color="ByLayer"
				Group="Kontaktledning/Svevende kryss"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>svevende_kryss</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___OCS" />
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />

		<Variants DefaultValue="Svevende kryss" >
			<Variant Name="Svevende kryss" >
			</Variant>
		</Variants>
		
		<SetDynamicProperty DynamicPropertiesPropertyName="Representation" DynamicPropertyType="Model3D"/>

		<SetValue Key="AlignmentRcType" Value="{{rctype_ContactWire}}" />

		<LuaExpression Name="code" ><Formula>_JBTEH_SVE_code()</Formula></LuaExpression>
		<LuaFunction Name="_JBTEH_SVE_code()" ReturnType="String"
			Description="Returns a formated string containing the code properties '[Code1] -X- [Code2]' for the two contact wires that meet in a floating crossing." >
			<Constructor>String _JBTEH_SVE_code()</Constructor>
			<Formula>
				function _JBTEH_SVE_code()
					local first,second
					if RcType ~= "JBTEH_SVE Svevende kryss" then
						return "Bad object type ["..RcType.."], 'JBTEH_SVE Svevende kryss' was expected."
					else
						first = Alignment
						if first == nil then
							return "Bad or missing alignment reference",_warning
						end
						second = TargetAlignment
						if second == nil then
							return "Bad or missing intersecting alignment reference",_warning
						end
						if first.id == second.id then
							return "Alignment and intersecting alignment cannot be the same ["..first.Code.."]"
						end
						if KmStigerMotVenstre then
							first,second = second,first 
						end
						return "["..first.Code.."] -X- ["..second.Code.."]"
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="name" ><Formula>code</Formula></LuaExpression>
		<LuaExpression Name="dir" ><Formula>"none"</Formula></LuaExpression>
		
		<LuaExpression Name="DistanceToAlignment" ><Formula>0</Formula></LuaExpression>

		<!-- TODO Lage 3D-modeller for svevende kryss osv -->
		<LuaExpression Name="Model3D_0.Model3DName" >
			<Formula>
				if Variant == "Svevende kryss" then return "NO-BN-3D-EH-SVE-SVEVENDE-KRYSS-2500"
				else return _error, "Bad OCS crossing lines connector variant ["..Variant.."]."
				end
			</Formula>
		</LuaExpression>

		<InsertPointObject VariantName="Svevende kryss" DisplayBlockName="NO-BN-2D-JBTEH_SVE-FORBINDELSE-SVEVENDE-KRYSS-{{SymbolMode}}" 
				DefaultSnapMode="Alignment" SnapToAlignment="false" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>kontaktledning</OwnAlignmentTargetSpace> 
			<SetValue Key="name" Value="Svevende kryss" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" DefaultBlockName="NO-BN-2D-JBTEH_SVE-FORBINDELSE-SVEVENDE-KRYSS-{{SymbolMode}}" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="{% if dir == 'up' %}{{270.0|plus:AngularOffset}}
														{% elsif dir == 'down' %}{{90.0|plus:AngularOffset}}
														{% elsif dir == 'both' and RightSided %}{{180.0|plus:AngularOffset}}
														{% elsif dir == 'both' and LeftSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and RightSided %}{{0.0|plus:AngularOffset}}
														{% elsif dir == 'none' and LeftSided %}{{180.0|plus:AngularOffset}}
														{% else %}45.0
														{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_SVE-FORBINDELSE
				{% if Variant == 'Svevende kryss' %}SVEVENDE-KRYSS
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	HIGH VOLTAGE
	CURRENT BRIDGE
	EH-FOR Forbindelse (Strømbro "C" mellom kontaktledning og bæreline i to ledninger, med "M" mellom dem)
	Dvs elektrisk sammenkobling av to kontakttråder i et vekslingsfelt (seksjonsfelt har bryter)
	Ref. EH.705051.

	TODO 2020-09-26: Add 3D symbols to the library: Single / double Strømbro
=========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" LuaName="rctype_CurrentBridge" Name="JBTEH_FOR Forbindelse, strømbro"
				Layer="JBTEH_FOR" Color="ByLayer"
				Group="Kontaktledning/Forbindelser"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>kl-forbindelse</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_MEDIUM_CLOSE___OCS" />
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />

		<Variants DefaultValue="Strømbro" >
			<Variant Name="Strømbro" >
			</Variant>
		</Variants>
		
		<!-- Text attribute positions are stated in ACS for the 1:1 drawing scale: -->
		<TextPositionLuaExpression Name="OBJEKTNAVN" ><Formula>RC__TextAttributePosition(5,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTID" ><Formula>RC__TextAttributePosition(7,0)</Formula></TextPositionLuaExpression>
		<TextPositionLuaExpression Name="OBJEKTBESKRIVELSE" ><Formula>RC__TextAttributePosition(9,0)</Formula></TextPositionLuaExpression>

		<LuaExpression Name="DistanceToAlignment" ><Formula>RightSided and 4e-4 or -4e-4</Formula></LuaExpression>

		<InsertPointObject VariantName="Strømbro" DisplayBlockName="NO-BN-2D-JBTEH_FOR-FORBINDELSE-STROEMBRO-H-{{SymbolMode}}"
				DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<OwnAlignmentTargetSpace>kontaktledning</OwnAlignmentTargetSpace> 
			<SetValue Key="name" Value="Strømbro" />
		</InsertPointObject>
		
		<SymbolDefinition AllowSymbolMove="true" 
				DefaultBlockName="NO-BN-2D-JBTEH_SVE-FORBINDELSE-STROEMBRO-{% if dir == 'up' %}{% if RightSided %}H{% else %}V{% endif %}{% else %}{% if LeftSided %}H{% else %}V{% endif %}{% endif %}" >
			<Rotation Add180DegreesIfDirIsDown="false" 
				AddAngle="{% if RightSided %}{{0.0|plus:AngularOffset}}{% else %}{{180.0|plus:AngularOffset}}{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_FOR
				FORBINDELSE
				{% if Variant == 'Strømbro' %}STROEMBRO
					{% if dir == 'up' %}{% if RightSided %}H{% else %}V{% endif %}{% else %}{% if RightSided %}V{% else %}H{% endif %}{% endif %}
				{% else %}BAD_Variant_{{Variant}}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>			
			

<!--========================================================================================================
	SIGNALLING
	TECHNICAL BUILDING
=========================================================================================================-->
	<!-- AT-kiosk. -->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" EuLynxDataType="EULYNX.sig.Building" LuaName="rctype_Building" Name="JBTEH_TER Tekniske bygninger og rom"
				Layer="JBTEH_TER" Color="ByLayer"
				Group="Kontaktledning/Tekniske Bygninger"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>
				
		<RelationSpace>høyspent-teknisk_bygg</RelationSpace>

		<!-- <xpp:expand select="NOBN_xxx_DEPRECATED_MACRO___TO_BE_REMOVED" /> -->
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_TEXATTRIBUTES___VERTICAL_AND_FAR___SIG" />
		<xpp:expand select="NOBN_com_DISCIPLINE___OCS" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___WAYSIDE_GENERAL_OBJECT" />

		<!-- Connect earth to "jordspyd" typically: -->
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_OBJECT" />

		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_EH_TER" />

		<xpp:expand select="NOBN_eulynx_TECHNICAL_BUILDING" />

		<LuaExpression Name="IsyPostnotat" ><Formula>name</Formula></LuaExpression> 

		<Variants>
			<Variant Name="Teknisk hus" />
		</Variants>
		
		<SetDynamicProperty DynamicPropertiesPropertyName="Representation" DynamicPropertyType="Model3D"/>
		
		<SetValue Key="name" Value="Teknisk hus" />

		<!-- TODO: Make symbol for OCS as well -->
		<InsertPointObject VariantName="Teknisk hus" DisplayBlockName="NO-BN-2D-JBTEH_TER-TEKNISK-BYGNING-{{SymbolMode}}" 
				DefaultSnapMode="None" SnapToAlignment="true" SnapDistance="15" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance RotateIfLeftSideOfAlignment="true" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="true" >
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="{% if RightSided %}0{% else %}180{% endif %}" />	
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTEH_TER-TEKNISK-BYGNING
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />
		
	</ObjectType>

	

<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

<!--========================================================================================================

    NO-BN-TrackConnections.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml" />.

	(c) Railcomplete AS, Norway, 2015-2021. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>



<!--========================================================================================================
	trk - Track Connection Lua formulas (for continuations, switches and crossings).
	Domain-specific Lua functions, stored in Global Extension Dictionary (not in each object).
=========================================================================================================-->
	<!-- INFO: Function used e.g. when computing info for switch tables: -->
	<LuaFunction Name="NOBN_trk_getFoulingPointReferenceMileage()" ReturnType="String"
		Description="Returns the reference mileage for the fouling point being farthest from the stock rail joint, using reference alignment mileage. Assumes caller is a switch unless argument 'v' is given." >
		<Constructor>String NOBN_trk_getFoulingPointReferenceMileage(tSwitch v)</Constructor>
		<Formula>
			function NOBN_trk_getFoulingPointReferenceMileage(v)
				if v == nil then v = getObjectFromId(id) end
				if v.RcType ~= "JBTKO_SPV Sporveksel" then
					return "Bad object type ["..RcType.."], 'JBTKO_SPV Sporveksel' was expected"
				else
					local fp,dmax,w,i,d
					fp = getFoulingPoints(v)
					dmax = 0
					w = nil
					for i = 0,fp.count-1 do
						d = math.sqrt((fp[i].FoulingPoint.x - v.geocoord.x)^2 + (fp[i].FoulingPoint.y - v.geocoord.y)^2)
						if d > dmax then
							dmax = d
							w = fp[i].Branch1.ReferenceMileage
						end
					end
					if dmax == 0 then
						return "(no fouling points found)"
					else
						return w
					end
				end
			end 
		</Formula>
	</LuaFunction>



	<!-- INFO: Function used e.g. when computing info for switch tables: -->
	<LuaFunction Name="NOBN_trk_getFoulingPointMileage()" ReturnType="String"
		Description="Returns the own alignment mileage for the fouling point being farthest from the stock rail joint, using own alignment mileage. Assumes caller is a switch unless argument 'v' is given." >
		<Constructor>String NOBN_trk_getFoulingPointMileage(tSwitch v)</Constructor>
		<Formula>
			function NOBN_trk_getFoulingPointMileage(v)
				if v == nil then v = getObjectFromId(id) end
				if v.RcType ~= "JBTKO_SPV Sporveksel" then
					return "Bad object type ["..RcType.."], 'JBTKO_SPV Sporveksel' was expected"
				else
					local fp,dmax,w,i,d
					fp = getFoulingPoints(v)
					dmax = 0
					w = nil
					for i = 0,fp.count-1 do
						d = math.sqrt((fp[i].FoulingPoint.x - v.geocoord.x)^2 + (fp[i].FoulingPoint.y - v.geocoord.y)^2)
						if d > dmax then
							dmax = d
							w = fp[i].Branch1.Mileage
						end
					end
					if dmax == 0 then
						return "(no fouling points found)",_warning
					else
						return w
					end
				end
			end 
		</Formula>
	</LuaFunction>

	
	
<!--========================================================================================================
	TRACK AND EMBANKMENT
	ALIGNMENT CONTINUATIONS
	Objects that allows algorithms to graph-search from the end of one alignment and onwards in the next.
=========================================================================================================-->
	<!-- NB: 'KO-SPF' (Sporfortsettelser) er p.t. ikke en gyldig Banedata kode, men en vi 'fant på selv'. -->
	<ObjectType DataType="RailCOMPLETEContinuation" Class="RailwayPlacedObject" Name="JBTKO_SPF Sporfortsettelse"
				Layer="JBTKO_SPF" Color="ByLayer"
				Group="Overbygning/Sporfortsettelser"
				>
				
		<RelationSpace>sporfortsettelse</RelationSpace>

		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />		
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___MILEAGE_INCREASES_TOWARDS_LEFT" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CENTERED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___TRK" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___TRACKBOUND_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
				
		<!-- Model checks Continuation -->
		<xpp:expand select="NOBN_com_CHK_CONNECTION___CONTINUATION" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />

		<Variants DefaultValue="Sporfortsettelse" >
			<Variant Name="Sporfortsettelse" >
			</Variant>
		</Variants>
		
		<SetValue Key="ConnectedAlignmentType" Value="JBTKO_SPO Spor" />

		<LuaExpression Name="code" ><Formula>_JBTKO_SPF_code()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SPF_code()" ReturnType="String"
			Description="Returns a formated string containing the code properties '[Code1] --- [Code2]' for the two tracks that meet in a track continuation." >
			<Constructor>String _JBTKO_SPF_code()</Constructor>
			<Formula>
				function _JBTKO_SPF_code()
					local first,second
					if RcType ~= "JBTKO_SPF Sporfortsettelse" then
						return _error, "Bad object type ["..RcType.."] - 'JBTKO_SPF Sporfortsettelse' was expected."
					else
						first = Alignment
						if first == nil then
							return "Bad or missing alignment reference",_warning
						elseif Alignment.RcType ~= "JBTKO_SPO Spor" then
							return "Cannot connect to alignments of type '"..Alignment.RcType.."'.",_warning
						end
						second = TargetAlignment
						if second == nil then
							return "Bad or missing continuing alignment reference",_warning
						elseif TargetAlignment.RcType ~= "JBTKO_SPO Spor" then
							return "Cannot connect to alignments of type '"..Alignment.RcType.."'.",_warning
						end
						if first.id == second.id then
							return _error, "Own alignment and continuing alignment cannot be the same ["..first.Code.."]"
						end
						--2021-08-23 CLFEY: Leave the text as-is, emphasize showing what is own / what is target:
						--if KmStigerMotVenstre then
						--	first,second = second,first 
						--end
						return "["..first.Code.."] ==> ["..second.Code.."]"
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="name" ><Formula>code</Formula></LuaExpression>
					
		<LuaExpression Name="Mileage" ><Formula>_JBTKO_SPF_mileage()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SPF_mileage()" ReturnType="Double"
				Description="Obtains the mileage from its alignment." >
			<Constructor>Double _JBTKO_SPF_mileage()</Constructor>
			<Formula>
				function _JBTKO_SPF_mileage()
					ai = getAlignmentInfo()
					if RC__isNan(ai.RelativePosition) then return nil, _info("Position not found - move object inside the extent of its own alignment.") end
					return ai.RelativePosition &lt; (Alignment.RcAlignment.HorizontalProfile.Length - ai.RelativePosition)
							and Alignment.RcAlignment.StartMileage or Alignment.RcAlignment.EndMileage
				end
			</Formula>
		</LuaFunction>
						
		<LuaExpression Name="TargetAlignment" ><Formula>_JBTKO_SPF_TargetAlignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SPF_TargetAlignment()" ReturnType="Double"
				Description="Obtains the target alignment, as long as its snaps to own alignment close to this continuation object." >
			<Constructor>Double _JBTKO_SPF_TargetAlignment()</Constructor>
			<Formula>
				function _JBTKO_SPF_TargetAlignment()
					return getClosestAlignments(Alignment.RcType):filter(function (x) return x.id ~= Alignment.id end)[0]
				end
			</Formula>
		</LuaFunction>
						
		<InsertPointObject VariantName="Sporfortsettelse" DisplayBlockName="NO-BN-2D-JBTKO_SPF-FORBINDELSE-FORTSETTELSE-0-0-{{SymbolMode}}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
				
		<!-- Track and embankment viewpoint's symbol (the other disciplines don't show anything) -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="false" Layer="JBTKO$SPF"
				Color="ByBlock" LineType="ByBlock" LineWeight="ByBlock" Transparency="ByBlock" >
			<Rotation Add180DegreesIfDirIsDown="true" />
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTKO_SPF-FORBINDELSE-FORTSETTELSE
				{% if ExtendingFromEnd == 'True' %}
					{% if ContinuingWithBegin == 'False' %}0-1{% else %}0-0{% endif %}
				{% else %}
					{% if ContinuingWithBegin == 'False' %}0-0{% else %}1-0{% endif %}
				{% endif %}
				{{SymbolMode}}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
	TRACK AND EMBANKMENT
	CROSSING
=========================================================================================================-->
	<ObjectType DataType="eCrossing" Class="RailwayPlacedObject" Name="JBTKO_SPV Sporkryss"
				Layer="JBTKO_SPV" Color="ByLayer"
				Group="Overbygning/Sporkryss"
				>
				
		<RelationSpace>sporkryss</RelationSpace>
		
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___MILEAGE_INCREASES_TOWARDS_LEFT" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CENTERED___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___TRK" />
		<!-- Currently, the eCrossing class has no Ocp property -->
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___TRACKBOUND_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
				
		<LuaExpression Name="DistanceToAlignment" ><Formula>RightSided and 4e-4 or -4e-4</Formula></LuaExpression> 
		
		<!-- Model checks Crossing -->
		<xpp:expand select="NOBN_trk_CHK_CONNECTION___CROSSING" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SPV" />
		<!-- Debug info - using "Var1" or "Var2" as calling property names: -->
		<LuaExpression Name="Var1" ><Formula>NOBN_trk_chkConnectionGradientAndCantMatch("Var1")</Formula></LuaExpression>
		<LuaExpression Name="Var2" ><Formula>NOBN_trk_chkConnectionGradientAndCantMatch("Var2")</Formula></LuaExpression>
		
		<Variants DefaultValue="Sporkryss" >
			<Variant Name="Sporkryss" >
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-UNSPECIFIED" />
			</Variant>
		</Variants>
		
		<SetValue Key="ConnectedAlignmentType" Value="JBTKO_SPO Spor" />

		<LuaExpression Name="code" ><Formula>_JBTKO_SPV_crossingCode()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SPV_crossingCode()" ReturnType="String"
			Description="Returns a formated string containing the code properties '[Code1] -X- [Code2]' for the two tracks that meet in a track crossing." >
			<Constructor>String _JBTKO_SPV_crossingCode()</Constructor>
			<Formula>
				function _JBTKO_SPV_crossingCode()
					local first,second
					if RcType ~= "JBTKO_SPV Sporkryss" then
						return "Bad object type ["..RcType.."], 'JBTKO_SPV Sporkryss' was expected."
					else
						first = Alignment
						if first == nil then
							return "Bad or missing alignment reference",_warning
						end
						second = TargetAlignment
						if second == nil then
							return "Bad or missing intersecting alignment reference",_warning
						end
						if first.id == second.id then
							return "Alignment and intersecting alignment cannot be the same ["..first.Code.."]"
						end
						if KmStigerMotVenstre then
							first,second = second,first 
						end
						return "["..first.Code.."] -X- ["..second.Code.."]"
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="name" ><Formula>code</Formula></LuaExpression>
		<LuaExpression Name="dir" ><Formula>"none"</Formula></LuaExpression>
		
		<InsertPointObject VariantName="Sporkryss" DisplayBlockName="NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORKRYSS-{{SymbolMode}}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<!-- Track and embankment viewpoint's symbol (the other disciplines don't show anything) -->
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORKRYSS-{{SymbolMode}}" AllowSymbolMove="false" Layer="JBTKO$SPV" 
				Color="ByBlock" LineType="ByBlock" LineWeight="ByBlock" Transparency="ByBlock" >
			<Rotation Add180DegreesIfDirIsDown="false" AddAngle="0" />
		</SymbolDefinition>
				
		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>


	
<!--========================================================================================================
	TRACK AND EMBANKMENT
	TURNOUT
	NB! Variant must match the corresponding VariantName element in the FR-SR-SwitchGeometries.xml file, which is bundled
	together with the DNA:
	 <Switch>
		<VariantName>1:7 R190 FX 54E3 (KO-800157)</VariantName>
		...
	 </Switch>
=========================================================================================================-->
	<!--TODO Benytte ny feature (må lages) "ObjectInsertionMethodCycling" ("F" bokstav fra tastatur) til å veksle mellom SS, TK, BK1, BK2 som innsettingspunkt-->
	<ObjectType DataType="eSwitch" Class="RailwayPlacedObject" Name="JBTKO_SPV Sporveksel"
				Layer="JBTKO_SPV" Color="ByLayer"
				Group="Overbygning/Sporveksler"
				AttAddX="
					{% if Variant == '1:7 R190 FX 54E3 (KO-800157)' %}13.503
					{% elsif Variant == '1:9 R190 FX 54E3 (KO-701334)' %}10.523
					
					{% elsif Variant == '1:9 R300 FX 54E3 (KO-701287)' %}16.616
					{% elsif Variant == '1:12 R500 FX 54E3 (KO-701306)' %}20.797
					{% elsif Variant == '1:14 R760 FX 54E3 (KO-701319)' %}27.108
					
					{% elsif Variant == '1:9 R300 FX 60E1 (KO-701409)' %}16.615
					{% elsif Variant == '1:11.66 R500 FX 60E1 (KO-800068)' %}21.393
					{% elsif Variant == '1:12 R500 FX 60E1 (KO-800068)' %}20.797
					{% elsif Variant == '1:14 R760 FX 60E1 (KO-701372)' %}27.108
					{% elsif Variant == '1:15 R760 FX 60E1 (KO-701382)' %}25.305
					
					{% elsif Variant == '1:9 R300 BX 60E1 (KO-800099)' %}16.615
					{% elsif Variant == '1:8.21 R300 BX 60E1 (KO-065306)' %}18.188
					{% elsif Variant == '1:12 R500 BX 60E1 (KO-800090)' %}20.797
					{% elsif Variant == '1:14 R760 BX 60E1 (KO-800108)' %}27.108
					{% elsif Variant == '1:15 R760 BX 60E1 (KO-800164)' %}25.305
					{% elsif Variant == '1:18.4 R1200 BX 60E1 (KO-800081)' %}32.829
					{% elsif Variant == '1:26.1 R2500 BX 60E1 (KO-701399)' %}48.109
					{% endif %}"
				AttMirrorX="{% if quadrant == '2' or quadrant == '3' %}true{% else %}false{% endif %}"
				AttMirrorY="{% if quadrant == '1' or quadrant == '2' %}true{% else %}false{% endif %}"
				>

		<!-- TODO Note: ObjectTypeAttribute declares a local variable which can be used in Dot Liquid but is not available in Lua (?) - must be documented! -->
		<!-- NB: The 'KmStigerMotVenstre' attribute corresponds to your screen view, provided that UCS Y azis points mainly upwards (use acad PLAN or EXPLAN command). -->
		<!-- Note: DotLiquid parsing does not strip whitespace, so to test on quadrant == '3' etc, you must write your DotLiquid this way:  '...%}3{%...' when you return the '3'. -->
		<!-- Expressions such as AttAddX="{{quadrant}}" will work even if 'quadrant' contains whitespace, because the subsequent use of AttAddX in C# core code will strip off whitespace when extracting the numerical value. -->
		<ObjectTypeAttribute 
			Key="quadrant" 
			Value="{% if dir == 'up' and SwitchGeometry == 'left' %}1{% elsif dir == 'down' and SwitchGeometry == 'right' %}2{% elsif dir == 'down' and SwitchGeometry == 'left' %}3{% elsif dir == 'up' and SwitchGeometry == 'right' %}4{% endif %}"
		 />

		<!--Object type setters, RailCOMPLETE built-in properties -->
		<SetValue Key="ConnectionCourse" Value="{% if insertionDirection == 'up' %}{{insertionSide}}{% else %}{% if insertionSide == 'right' %}left{% else %}right{% endif %}{% endif %}" />
		<SetValue Key="SwitchGeometry" Value="{{ConnectionCourse}}" />
		<SetValue Key="dir" Value="{{insertionDirection}}" />

		<RelationSpace>sporveksel</RelationSpace>
		
		<!--TODO finne konstruksjonstegninger for de vi mangler, samt Tp-forbudtområdet for 1:14 sporveksler med mer-->

		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___MILEAGE_INCREASES_TOWARDS_LEFT" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_CLOSE___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___TRK" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___TRACKBOUND_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />

		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<LuaExpression Name="IsyPostnotat" ><Formula>Variant</Formula></LuaExpression> 
		
		<!-- NB! Placement of BETEGNELSE must match macro for placing of standard text attributes, check macro for standard text attributes declarations. -->
		<TextAttribute Annotative="true" 
			BindingProperty="Variant" 
			CadAttributeTag="BETEGNELSE"
            X="0" Y="6.5" 
			Layer="JBTKO@SPV_TYPE"
			Color="ByBlock" Justify="MiddleCenter" Height="0.9" Rotation="0"
		 />

		<!--TODO For å kunne sette korrekt trackContinueRadius så må RC analysere avvikssporets fortsettelse, som er enten 0 (rettlinje) eller samme 
        kurvatur som i vx. Se TRV, Overbygning, sporveksler. D-partiet er et rett parti etter avvikssporets krumning. Dersom D <> 0 så finnes det
        kun ett svillesett. Dersom D = "-" så strekker avvikssporets kurvatur seg gjennomg hele sporvekselen og kan dermed fortsette inn i samme
        kurvatur uten å få redusert komfort. Sporveksler som ender med klotoide (1:18,4 og 1:26,5) kan bare fortsette som klotoide (den avsluttes 
        etter bakkant sporveksel). Se tabeller i TRV.
        -->
		<!--TODO DotLiquid-metode "cosisnegative" som er "True" for kvadrant I og IV, ellers "False". Note: cosisnegative (RC built-in filter for DotLiquid) returns 'True' with an uppercase T -->
		<!--Innsettingsforløpet for sporveksler - vi definerer symbol og verdier alle fire kvadranter. I=out/left, II=in/right, III=in/left, IV=out/right-->
		
		<!--Unspecified:-->
		<!-- tSwitch:type: ordinarySwitch, insideCurvedSwitch, outsideCurvedSwitch, threeWaySwitch, other:anything -->
		
		<Variants DefaultValue="Generell sporveksel" >
			<Variant Name="Generell sporveksel" 
				Description="A two-way switch which does not match any of the predefined geometries stored in the administration's switch definition file." >
				<SetValue Key="type" Value="other:unspecified" />
				<SetValue Key="trackContinueRadius" Value="0" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-UNSPECIFIED" />
			</Variant>
			<Variant Name="1:7 R190 FX 54E3 (KO-800157)" 
				Description="1:7(R190) two-way switch, fixed nose crossing, 54-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="190" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-54E3-1-7-R190-H-FX" />
			</Variant>
			<Variant Name="1:9 R190 FX 54E3 (KO-701334)" 
				Description="1:9(R190) two-way switch, fixed nose crossing, 54-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="190" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-54E3-1-9-R190-H-FX" />
			</Variant>
			<Variant Name="1:9 R300 FX 54E3 (KO-701287)" 
				Description="1:9(R300) two-way switch, fixed nose crossing, 54-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="300" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-54E3-1-9-R300-H-FX" />
			</Variant>
			<Variant Name="1:9 R300 FX 60E1 (KO-701409)" 
				Description="1:9(R300) two-way switch, fixed nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="300" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-9-R300-H-FX" />
			</Variant>
			<Variant Name="1:9 R300 BX 60E1 (KO-800099)" 
				Description="1:9(R300) two-way switch, movable nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="300" />
				<SetValue Key="SwitchNoseType" Value="Movable" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-9-R300-H-BX" />
			</Variant>
			<Variant Name="1:8.21 R300 BX 60E1 (KO-065306)" 
				Description="1:8.21(R300) two-way switch, movable nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="300" />
				<SetValue Key="SwitchNoseType" Value="Movable" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-8.21-R300-H-BX" />
			</Variant>
			<Variant Name="1:11.66 R500 FX 60E1 (KO-800068)" 
				Description="1:11.66(R500) two-way switch, fixed nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="500" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-11.66-R500-H-FX" />
			</Variant>
			<Variant Name="1:12 R500 FX 54E3 (KO-701306)" 
				Description="1:12(R500) two-way switch, fixed nose crossing, 54-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="500" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-54E3-1-12-R500-H-FX" />
			</Variant>
			<Variant Name="1:12 R500 FX 60E1 (KO-800068)" 
				Description="1:12(R500) two-way switch, fixed nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="500" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-12-R500-H-FX" />
			</Variant>
			<Variant Name="1:12 R500 BX 60E1 (KO-800090)" 
				Description="1:12(R500) two-way switch, movabnle nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="500" />
				<SetValue Key="SwitchNoseType" Value="Movable" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-12-R500-H-BX" />
			</Variant>
			<Variant Name="1:14 R760 FX 54E3 (KO-701319)" 
				Description="1:14(R760) two-way switch, fixed nose crossing, 54-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="760" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-54E3-1-14-R760-H-FX" />
			</Variant>
			<Variant Name="1:14 R760 FX 60E1 (KO-701372)" 
				Description="1:14(R760) two-way switch, fixed nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="760" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-14-R760-H-FX" />
			</Variant>
			<Variant Name="1:14 R760 BX 60E1 (KO-800108)" 
				Description="1:14(R760) two-way switch, movable nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="760" />
				<SetValue Key="SwitchNoseType" Value="Movable" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-14-R760-H-BX" />
			</Variant>	
			<Variant Name="1:15 R760 FX 60E1 (KO-701382)" 
				Description="1:15(R760) two-way switch, fixed nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="760" />
				<SetValue Key="SwitchNoseType" Value="Fixed" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-15-R760-H-FX" />
			</Variant>
			<Variant Name="1:15 R760 BX 60E1 (KO-800164)" 
				Description="1:15(R760) two-way switch, movable nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="760" />
				<SetValue Key="SwitchNoseType" Value="Movable" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-15-R760-H-BX" />
			</Variant>
			<Variant Name="1:18.4 R1200 BX 60E1 (KO-800081)" 
				Description="1:18.4(R1200) two-way switch, movable nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="1200" />
				<SetValue Key="SwitchNoseType" Value="Movable" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-18.4-R1200-H-BX" />
			</Variant>
			<Variant Name="1:26.1 R2500 BX 60E1 (KO-701399)" 
				Description="1:26.1(R760) two-way switch, movable nose crossing, 60-kg rails." >
				<SetValue Key="type" Value="ordinarySwitch" />
				<SetValue Key="trackContinueRadius" Value="2500" />
				<SetValue Key="SwitchNoseType" Value="Movable" />
				<SetValue Key="Thumbnail3DModel" Value="NO-BN-3D-KO-SPV-60E1-1-26.1-R2500-H-BX" />
			</Variant>
		</Variants>
					
			<!-- 2021-03-21 CLFEY Deprecated Description="The 'SwitchControlAndLocking' custom property [RM | RL | Rr | Rb | Pl | Pr | Pb | Pn | Hl | Hr | Hb | Hn] defines the switch control and locking type. The abbreviations mean: R='Remote controlled'. P='Pushbutton, electrically operated'. H='Hand operated (hand thrown)'. m='Machine locked (using a point machine or clamping device, with end position detection)'. l='Keylocked for left switch leg train movements'. r='Keylocked for right switch leg train movements'. b='Keylocked for both right and left switch leg train movements (one at a time)'. n='Not interlocked'." -->
		<CustomAttribute DataType="Enumeration" Name="SwitchControlAndLocking" DisplayName="Omlegging / Låsing" DefaultValue="RM" Category="Connections"
			Description="The 'SwitchControlAndLocking' custom property [RM | PL | PR | PB | PN | HL | HR | HB | HN ] defines the switch control and locking type. The abbreviations mean: R='Remote controlled'. P='Pushbutton, electrically operated'. H='Hand operated (hand thrown)'. M='Machine locked (using a point machine or clamping device, with end position detection)'. L='Keylocked for left switch leg train movements'. R='Keylocked for right switch leg train movements'. B='Keylocked for both right and left switch leg train movements (one at a time)'. N='Not interlocked'."
			>
			<Values>
				<Value DisplayName="Sentralstilt, maskinlåst" Description="Remote controlled, machine locked" >RM</Value>
				<Value DisplayName="Kastelodd, kontrollåst V" Description="Hand thrown, keylocked for left switch leg train movements" >HL</Value>
				<Value DisplayName="Kastelodd, kontrollåst H" Description="Hand thrown, keylocked for right switch leg train movements" >HR</Value>
				<Value DisplayName="Kastelodd, kontrollåst HV" Description="Hand thrown, keylocked for both right and left switch leg train movements (one at a time)" >HB</Value>
				<Value DisplayName="Kastelodd, uforriglet" Description="Hand thrown, not interlocked" >HN</Value>
				<Value DisplayName="Trykknapp, kontrollåst V" Description="Pushbutton controlled, keylocked for left switch leg train movements (one at a time)" >PL</Value>
				<Value DisplayName="Trykknapp, kontrollåst H" Description="Pushbutton controlled, keylocked for right switch leg train movements" >PR</Value>
				<Value DisplayName="Trykknapp, kontrollåst HV" Description="Pushbutton controlled, keylocked for both right and left switch leg train movements" >PB</Value>
				<Value DisplayName="Trykknapp, uforriglet" Description="Pushbutton controlled, not interlocked" >PN</Value>
			</Values> 
		</CustomAttribute>
		
		<CustomAttribute DataType="Enumeration" Name="SwitchElectrification" DisplayName="Ledningsføring" DefaultValue="Both" Category="Connections"
			Description="The 'SwitchElectrification' custom property [Both | Left | Right | Unknown] defines the switch electrification (both/left/right driving directions are electrified)."
			>
			<Values>
				<Value DisplayName="Begge spor" Description="Both switch legs are electrified" >Both</Value>
				<Value DisplayName="Enkelt spor venstre" Description="Only left switch leg is electrified" >Left</Value>
				<Value DisplayName="Enkelt spor høyre" Description="Only right switch leg is electrified" >Right</Value>
				<Value DisplayName="Udefinert" Description="Switch leg electrification is unknown" >Unknown</Value>
			</Values>
		</CustomAttribute>

	<!--railML modell av sporveksel:
    ================================
    trackContinueCourse finnes i tSwitch. course finnes i tSwitchConnectionData. Disse to har samme type 
	{'left', 'straight', 'right', 'unknown', 'none'}.
	
	normalPosition {'straight', 'left', 'right', 'unknown', 'none'} er implementert 
	i RC. Vi tolker dette som rettfram/venstre/høyre/ikkeTildeltEnnå, eller ikke-i-kontroll, som normalstillinger i sikringsanlegget.
    normalPosition er {'straight', 'left', 'right', 'other'} i følge Spy-XML wiki sider hos railML-org. Merk at det jo tungene som skal 
	ha normalstilling, ikke sporvekselen. Modelleringsfeil i railML. 
	
	Dir {'up','down'} er en railML-attributt i objektet for kjørbar sporforbindelse (klassen tSwitchConnectionData). 
	Outgoing betyr at et tog som kjører i økende mileage-retning treffer på tungepartiet før bakkantpartiet i sporvekselen.
    -->


		<!--fast/bevegelig kryss var ikke modellert i railML i det hele tatt: -->
		<CustomAttribute DataType="Enumeration" Name="SwitchNoseType" DisplayName="Fast eller bevegelig kryss" DefaultValue="Fixed" Category="Connections"
			Description="The 'SwitchNoseType' custom property [Fixed | Movable] defines the type of switch nose (point frog), fixed or movable."
			>
			<!--tSwitchConnectionData-->
			<Values>
				<Value DisplayName="Fast" >Fixed</Value>
				<Value DisplayName="Bevegelig" >Movable</Value>
			</Values>
		</CustomAttribute>
		
		<!-- Model checks for Switch -->
		<xpp:expand select="NOBN_trk_CHK_CONNECTION___SWITCH" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_SPV" />

		<LuaExpression Name="DistanceToAlignment" ><Formula>RightSided and 4e-4 or -4e-4</Formula></LuaExpression> 
		
		<LuaExpression Name="code" ><Formula>_JBTKO_SPV_switchCode()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SPV_switchCode()" ReturnType="String"
			Description="Returns a formated string containing the code properties '[Code1] -X- [Code2]' for the two tracks that meet in a track crossing." >
			<Constructor>String _JBTKO_SPV_switchCode()</Constructor>
			<Formula>
				function _JBTKO_SPV_switchCode()
					local first,second
					if RcType ~= "JBTKO_SPV Sporveksel" then
						return "Bad object type ["..RcType.."], 'JBTKO_SPV Sporveksel' was expected"
					else
						first = Alignment
						if first == nil then
							return "Bad or missing alignment reference",_warning
						end
						second = TargetAlignment
						if second == nil then
							return "Bad or missing branching alignment reference",_warning
						end
						if first.id == second.id then
							return "Alignment and branching alignment cannot be the same ["..first.Code.."]"
						end
						return "["..Alignment.code.."] -&gt; ["..TargetAlignment.code.."]"
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="name" ><Formula>code</Formula></LuaExpression>

		<LuaExpression Name="Model3DName" ><Formula>_JBTKO_SPV_switchModel3DName()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SPV_switchModel3DName()" ReturnType="String"
				Description="Returns Model3DName according to switch variant." >
			<Constructor>String _JBTKO_SPV_switchModel3DName(tSwitch v)</Constructor>
			<Formula>
				function _JBTKO_SPV_switchModel3DName(v)
					if v == nil then v = this end
					if v.RcType ~= "JBTKO_SPV Sporveksel" then
						return "Bad object type ["..RcType.."], 'JBTKO_SPV Sporveksel' was expected"
					end
					local sideOfTrack = SwitchGeometry == "right" and "H" or "V"
					local suffix = SwitchNoseType == "Fixed" and "-FX" or "-BX"
					if Variant == "1:7 R190 FX 54E3 (KO-800157)" then
						return "NO-BN-3D-KO-SPV-54E3-1-7-R190-"..sideOfTrack..suffix
					elseif Variant == "1:9 R190 FX 54E3 (KO-701334)" then
						return "NO-BN-3D-KO-SPV-54E3-1-9-R190-"..sideOfTrack..suffix					
					elseif Variant == "1:9 R300 FX 54E3 (KO-701287)" then
						return "NO-BN-3D-KO-SPV-54E3-1-9-R300-"..sideOfTrack..suffix
					elseif Variant == "1:9 R300 FX 60E1 (KO-701409)" then
						return "NO-BN-3D-KO-SPV-60E1-1-9-R300-"..sideOfTrack..suffix
					elseif Variant == "1:9 R300 BX 60E1 (KO-800099)" then
						return "NO-BN-3D-KO-SPV-60E1-1-9-R300-"..sideOfTrack..suffix
					elseif Variant == "1:11.66 R500 FX 60E1 (KO-800068)" then
						return "NO-BN-3D-KO-SPV-60E1-1-11.66-R500-"..sideOfTrack..suffix
					elseif Variant == "1:12 R500 FX 54E3 (KO-701306)" then
						return "NO-BN-3D-KO-SPV-54E3-1-12-R500-"..sideOfTrack..suffix
					elseif Variant == "1:12 R500 FX 60E1 (KO-800068)" then
						return "NO-BN-3D-KO-SPV-60E1-1-12-R500-"..sideOfTrack..suffix
					elseif Variant == "1:12 R500 BX 60E1 (KO-800090)" then
						return "NO-BN-3D-KO-SPV-60E1-1-12-R500-"..sideOfTrack..suffix
					elseif Variant == "1:14 R760 FX 54E3 (KO-701319)" then
						return "NO-BN-3D-KO-SPV-54E3-1-14-R760-"..sideOfTrack..suffix
					elseif Variant == "1:14 R760 FX 60E1 (KO-701372)" then
						return "NO-BN-3D-KO-SPV-60E1-1-14-R760-"..sideOfTrack..suffix
					elseif Variant == "1:14 R760 BX 60E1 (KO-800108)" then
						return "NO-BN-3D-KO-SPV-60E1-1-14-R760-"..sideOfTrack..suffix
					elseif Variant == "1:15 R760 FX 60E1 (KO-701382)" then
						return "NO-BN-3D-KO-SPV-60E1-1-15-R760-"..sideOfTrack..suffix
					elseif Variant == "1:15 R760 BX 60E1 (KO-800164)" then
						return "NO-BN-3D-KO-SPV-60E1-1-15-R760-"..sideOfTrack..suffix
					elseif Variant == "1:18.4 R1200 BX 60E1 (KO-800081)" then
						return "NO-BN-3D-KO-SPV-60E1-1-18.4-R1200-"..sideOfTrack..suffix
					elseif Variant == "1:26.1 R2500 BX 60E1 (KO-701399)" then
						return "NO-BN-3D-KO-SPV-60E1-1-26.1-R2500-"..sideOfTrack..suffix
					else 
						return "NO-BN-3D-UNSPECIFIED"
					end
				end
			</Formula>
		</LuaFunction>

		<LuaExpression Name="model" ><Formula>Variant</Formula></LuaExpression>
		
		<!-- railML property trackContinueCourse: -->
		<LuaExpression Name="trackContinueCourse" ><Formula>_JBTKO_SPV_trackContinueCourse()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_SPV_trackContinueCourse()" ReturnType="String"
			Description="Returns a string holding either 'left' or 'right'. At present, 3-way switches (allowed in railML) are not modeled in RailCOMPLETE, i.e. ConnectionCourse being 'straight' leads to an error message." >
			<Constructor>String _JBTKO_SPV_trackContinueCourse()</Constructor>
			<Formula>
				function _JBTKO_SPV_trackContinueCourse()
					if (ConnectionCourse == "right") then 
						return "left"
					elseif (ConnectionCourse == "left") then
						return "right"
					elseif (ConnectionCourse == 'straight') then
						return "Cannot use 'straight' connection course in 2-way switch, use 'left' or 'right'",_warning
					else
						return "Bad connection course ["..ConnectionCourse.."]",_error
					end
				end
			</Formula>
		</LuaFunction>
		
		<InsertPointObject VariantName="Generell sporveksel" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>


		<!--54E3 FX uten persontrafikk-->
		<InsertPointObject VariantName="1:7 R190 FX 54E3 (KO-800157)"
			DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-07-R190-54E3-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:9 R190 FX 54E3 (KO-701334)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-09-R190-54E3-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>

		<!--54E3 FX-->
		<InsertPointObject VariantName="1:9 R300 FX 54E3 (KO-701287)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-09-R300-54E3-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:12 R500 FX 54E3 (KO-701306)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-12-R500-54E3-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:14 R760 FX 54E3 (KO-701319)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-14-R760-54E3-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<!--60E1 FX-->
		<InsertPointObject VariantName="1:9 R300 FX 60E1 (KO-701409)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-09-R300-60E1-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:11.66 R500 FX 60E1 (KO-800068)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-11.66-R500-60E1-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:12 R500 FX 60E1 (KO-800068)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-12-R500-60E1-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:14 R760 FX 60E1 (KO-701372)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-14-R760-60E1-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:15 R760 FX 60E1 (KO-701382)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-15-R760-60E1-FX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>		
		
		<!--60E1 BX-->
		<InsertPointObject VariantName="1:9 R300 BX 60E1 (KO-800099)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-09-R300-60E1-BX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>
		
		<InsertPointObject VariantName="1:8.21 R300 BX 60E1 (KO-065306)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-08.21-R300-60E1-BX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>

		<InsertPointObject VariantName="1:12 R500 BX 60E1 (KO-800090)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-12-R500-60E1-BX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>

		<InsertPointObject VariantName="1:14 R760 BX 60E1 (KO-800108)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-14-R760-60E1-BX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>

		<InsertPointObject VariantName="1:15 R760 BX 60E1 (KO-800164)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-15-R760-60E1-BX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>

		<InsertPointObject VariantName="1:18.4 R1200 BX 60E1 (KO-800081)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-18.4-R1200-60E1-BX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>

		<InsertPointObject VariantName="1:26.1 R2500 BX 60E1 (KO-701399)" DisplayBlockName="{% if SymbolMode == 'Geographic' %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-26.1-R2500-60E1-BX-1-Metric{% else %}NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-1-Schematic{% endif %}"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfRightSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
		</InsertPointObject>

		<!-- Track and embankment viewpoint's symbol -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="false" Layer="JBTKO$SPV"
			Color="ByBlock" LineType="ByBlock" LineWeight="ByBlock" Transparency="ByBlock"
		>
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="0" />
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL
				{% if SymbolMode == 'Geographic' %}
					{%    if Variant == '1:7 R190 FX 54E3 (KO-800157)'     %}07-R190-54E3-FX
					{% elsif Variant == '1:9 R190 FX 54E3 (KO-701334)'     %}09-R190-54E3-FX
					
					{% elsif Variant == '1:9 R300 FX 54E3 (KO-701287)'     %}09-R300-54E3-FX
					{% elsif Variant == '1:12 R500 FX 54E3 (KO-701306)'    %}12-R500-54E3-FX
					{% elsif Variant == '1:14 R760 FX 54E3 (KO-701319)'    %}14-R760-54E3-FX
					
					{% elsif Variant == '1:9 R300 FX 60E1 (KO-701409)'     %}09-R300-60E1-FX
					{% elsif Variant == '1:11.66 R500 FX 60E1 (KO-800068)' %}11.66-R500-60E1-FX
					{% elsif Variant == '1:12 R500 FX 60E1 (KO-800068)'    %}12-R500-60E1-FX
					{% elsif Variant == '1:14 R760 FX 60E1 (KO-701372)'    %}14-R760-60E1-FX
					{% elsif Variant == '1:15 R760 FX 60E1 (KO-701382)'    %}15-R760-60E1-FX
					  
					{% elsif Variant == '1:9 R300 BX 60E1 (KO-800099)'     %}09-R300-60E1-BX
					{% elsif Variant == '1:8.21 R300 BX 60E1 (KO-065306)'  %}08.21-R300-60E1-BX
					{% elsif Variant == '1:12 R500 BX 60E1 (KO-800090)'    %}12-R500-60E1-BX
					{% elsif Variant == '1:14 R760 BX 60E1 (KO-800108)'    %}14-R760-60E1-BX
					{% elsif Variant == '1:15 R760 BX 60E1 (KO-800164)'    %}15-R760-60E1-BX
					{% elsif Variant == '1:18.4 R1200 BX 60E1 (KO-800081)' %}18.4-R1200-60E1-BX
					{% elsif Variant == '1:26.1 R2500 BX 60E1 (KO-701399)' %}26.1-R2500-60E1-BX
					{% else %}GENERELL
					{% endif %}					
					{{quadrant}}-Metric
				{% else %}GENERELL-{{quadrant}}-Schematic
				{% endif %}
			</BlockNameFormat>
		</SymbolDefinition>
		
		<!-- Overhead Catenary System viewpoint's symbol (*nothing* shown in Schematic mode, nothing is shown if SwitchElectrification is 'Udefinert') -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="false" Layer="JBTEH$SPV" 
			Color="ByBlock" LineType="ByBlock" LineWeight="ByBlock" Transparency="ByBlock"
		>
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="0" />
			<BlockNameFormat JoinBy="-" >
				{% if SymbolMode == 'Geographic' and Variant != 'Generell sporveksel' %}
					NO-BN-2D-JBTEH_SPV-FORBINDELSE-SPORVEKSEL
					{%    if Variant == '1:7 R190 FX 54E3 (KO-800157)'     %}07-R190-54E3-FX
					{% elsif Variant == '1:9 R190 FX 54E3 (KO-701334)'     %}09-R190-54E3-FX
					
					{% elsif Variant == '1:9 R300 FX 54E3 (KO-701287)'     %}09-R300-54E3-FX
					{% elsif Variant == '1:12 R500 FX 54E3 (KO-701306)'    %}12-R500-54E3-FX
					{% elsif Variant == '1:14 R760 FX 54E3 (KO-701319)'    %}14-R760-54E3-FX
					
					{% elsif Variant == '1:9 R300 FX 60E1 (KO-701409)'     %}09-R300-60E1-FX
					{% elsif Variant == '1:11.66 R500 FX 60E1 (KO-800068)' %}11.66-R500-60E1-FX
					{% elsif Variant == '1:12 R500 FX 60E1 (KO-800068)'    %}12-R500-60E1-FX
					{% elsif Variant == '1:14 R760 FX 60E1 (KO-701372)'    %}14-R760-60E1-FX
					{% elsif Variant == '1:15 R760 FX 60E1 (KO-701382)'    %}15-R760-60E1-FX
					
					{% elsif Variant == '1:9 R300 BX 60E1 (KO-800099)'     %}09-R300-60E1-BX
					{% elsif Variant == '1:8.21 R300 BX 60E1 (KO-065306)'  %}08.21-R300-60E1-BX
					{% elsif Variant == '1:12 R500 BX 60E1 (KO-800090)'    %}12-R500-60E1-BX
					{% elsif Variant == '1:14 R760 BX 60E1 (KO-800108)'    %}14-R760-60E1-BX
					{% elsif Variant == '1:15 R760 BX 60E1 (KO-800164)'    %}15-R760-60E1-BX
					{% elsif Variant == '1:18.4 R1200 BX 60E1 (KO-800081)' %}18.4-R1200-60E1-BX
					{% elsif Variant == '1:26.1 R2500 BX 60E1 (KO-701399)' %}26.1-R2500-60E1-BX
					{% else %}BAD_Variant_{{Variant}}
					{% endif %}
					{% if SwitchElectrification == 'Both' %}BOTH_LEGS_ELECTRIFIED
					{% elsif SwitchElectrification == 'Left' or SwitchElectrification == 'Right' %}ONE_LEG_ELECTRIFIED
					{% elsif SwitchElectrification == 'Unknown' %}UNKNOWN_ELECTRIFICATION
					{% else %}BAD_SwitchElectrification
					{% endif %}
					{{quadrant}}-Metric
				{% elsif SymbolMode == 'Geographic' and Variant == 'Generell sporveksel' %}
					NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-{{quadrant}}-Metric
				{% else %}
					NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-{{quadrant}}-Schematic
				{% endif %}
			</BlockNameFormat>
		</SymbolDefinition>

		<!-- Signaling viewpoint's symbol -->
		<!-- SwitchControlAndLocking enum names: <control><locking> where (see also the DNA declaration of enum elsewhere): -->
		<!-- 		control = [ R = remote controlled | P = push-button operated | H = hand-thrown ]  -->
		<!-- 		locking = [ R = right | L = left | B = both | N = none ] -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="false" Layer="JBTSA$SPV" 
			Color="ByBlock" LineType="ByBlock" LineWeight="ByBlock" Transparency="ByBlock"
		>
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="0" />
			<BlockNameFormat JoinBy="-" >
				{% if SymbolMode == 'Geographic' and Variant != 'Generell sporveksel' %}
					NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL
					{%    if Variant == '1:7 R190 FX 54E3 (KO-800157)'     %}07-R190-54E3-FX
					{% elsif Variant == '1:9 R190 FX 54E3 (KO-701334)'     %}09-R190-54E3-FX
				
					{% elsif Variant == '1:9 R300 FX 54E3 (KO-701287)'     %}09-R300-54E3-FX
					{% elsif Variant == '1:12 R500 FX 54E3 (KO-701306)'    %}12-R500-54E3-FX
					{% elsif Variant == '1:14 R760 FX 54E3 (KO-701319)'    %}14-R760-54E3-FX
				
					{% elsif Variant == '1:9 R300 FX 60E1 (KO-701409)'     %}09-R300-60E1-FX
					{% elsif Variant == '1:11.66 R500 FX 60E1 (KO-800068)' %}11.66-R500-60E1-FX
					{% elsif Variant == '1:12 R500 FX 60E1 (KO-800068)'    %}12-R500-60E1-FX
					{% elsif Variant == '1:14 R760 FX 60E1 (KO-701372)'    %}14-R760-60E1-FX
					{% elsif Variant == '1:15 R760 FX 60E1 (KO-701382)'    %}15-R760-60E1-FX
				
					{% elsif Variant == '1:9 R300 BX 60E1 (KO-800099)'     %}09-R300-60E1-BX
					{% elsif Variant == '1:8.21 R300 BX 60E1 (KO-065306)'  %}08.21-R300-60E1-BX
					{% elsif Variant == '1:12 R500 BX 60E1 (KO-800090)'    %}12-R500-60E1-BX
					{% elsif Variant == '1:14 R760 BX 60E1 (KO-800108)'    %}14-R760-60E1-BX
					{% elsif Variant == '1:15 R760 BX 60E1 (KO-800164)'    %}15-R760-60E1-BX
					{% elsif Variant == '1:18.4 R1200 BX 60E1 (KO-800081)' %}18.4-R1200-60E1-BX
					{% elsif Variant == '1:26.1 R2500 BX 60E1 (KO-701399)' %}26.1-R2500-60E1-BX
					{% else %}BAD_Variant_{{Variant}}
					{% endif %}
					{%    if SwitchControlAndLocking == 'RM' %}REMOTE_CONTROLLED
					{% elsif SwitchControlAndLocking == 'PL' or SwitchControlAndLocking == 'PR' or SwitchControlAndLocking == 'PB' %}KEYLOCKED
					{% elsif SwitchControlAndLocking == 'HL' or SwitchControlAndLocking == 'HR' or SwitchControlAndLocking == 'HB' %}KEYLOCKED
					{% elsif SwitchControlAndLocking == 'PN' or SwitchControlAndLocking == 'HN' %}NOT_INTERLOCKED
					{% else %}BAD_SwitchControlAndLocking
					{% endif %}
					{{quadrant}}-Metric
				{% elsif SymbolMode == 'Geographic' and Variant == 'Generell sporveksel' %}
					NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-{{quadrant}}-Metric
				{% else %}
					NO-BN-2D-JBTKO_SPV-FORBINDELSE-SPORVEKSEL-GENERELL-{{quadrant}}-Schematic
				{% endif %}
			</BlockNameFormat>
		</SymbolDefinition>

		<!-- Signaling: Wipeout and circle at the theoretical crossing (both for geo and for schematic symbols) -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="false" DrawOrder="top" Layer="JBTSA$SPV" 
			Color="ByBlock" LineType="ByBlock" LineWeight="ByBlock" Transparency="ByBlock" >
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="{% if Dir == 'down' %}180{% else %}0{% endif %}" />
			<BlockNameFormat JoinBy="-" >
				{% if SymbolMode == 'Geographic' and Variant != 'Generell sporveksel' %}
					{% if SwitchControlAndLocking == 'PR' or SwitchControlAndLocking == 'PL' or SwitchControlAndLocking == 'PB' or SwitchControlAndLocking == 'PN' %}NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL-CIRCLE-AT-TANGENT-INTERSECTION
						{%    if Variant == '1:7 R190 FX 54E3 (KO-800157)' %}13.503
						{% elsif Variant == '1:9 R190 FX 54E3 (KO-701334)' %}10.523
						
						{% elsif Variant == '1:9 R300 FX 54E3 (KO-701287)' %}16.616
						{% elsif Variant == '1:12 R500 FX 54E3 (KO-701306)' %}20.797
						{% elsif Variant == '1:14 R760 FX 54E3 (KO-701319)' %}27.108
							
						{% elsif Variant == '1:9 R300 FX 60E1 (KO-701409)' %}16.615
						{% elsif Variant == '1:11.66 R500 FX 60E1 (KO-800068)' %}21.393
						{% elsif Variant == '1:12 R500 FX 60E1 (KO-800068)' %}20.797
						{% elsif Variant == '1:14 R760 FX 60E1 (KO-701372)' %}27.108
						{% elsif Variant == '1:15 R760 FX 60E1 (KO-701382)' %}25.305
							
						{% elsif Variant == '1:9 R300 BX 60E1 (KO-800099)' %}16.615
						{% elsif Variant == '1:8.21 R300 BX 60E1 (KO-065306)' %}18.188
						{% elsif Variant == '1:12 R500 BX 60E1 (KO-800090)' %}20.797
						{% elsif Variant == '1:14 R760 BX 60E1 (KO-800108)' %}27.108
						{% elsif Variant == '1:15 R760 BX 60E1 (KO-800164)' %}25.305
						{% elsif Variant == '1:18.4 R1200 BX 60E1 (KO-800081)' %}32.829
						{% elsif Variant == '1:26.1 R2500 BX 60E1 (KO-701399)' %}48.109
						{% endif %}
						Metric
					{% endif %}
				{% endif %}
			</BlockNameFormat>
		</SymbolDefinition>

		<!-- Signaling symbols for switching and position detection of turnouts and associated equipment: -->
		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="false" Layer="JBTSA$SPV"
			Color="ByBlock" LineType="ByBlock" LineWeight="ByBlock" Transparency="ByBlock"
		>
			<Rotation Add180DegreesIfDirIsDown="true" AddAngle="{% if Dir == 'down' %}180{% else %}0{% endif %}" />
			<BlockNameFormat JoinBy="-" >
				{% if SymbolMode == 'Geographic' %}
					{%    if SwitchControlAndLocking == 'RL' or SwitchControlAndLocking == 'PL' or SwitchControlAndLocking == 'HL' %}NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL-KEYLOCKED-LEFT-Metric
					{% elsif SwitchControlAndLocking == 'RR' or SwitchControlAndLocking == 'PR' or SwitchControlAndLocking == 'HR' %}NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL-KEYLOCKED-RIGHT-Metric
					{% elsif SwitchControlAndLocking == 'RB' or SwitchControlAndLocking == 'PB' or SwitchControlAndLocking == 'HB' %}NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL-KEYLOCKED-BOTH-Metric
					{% endif %}
				{% else %}
					{%    if SwitchControlAndLocking == 'RL' or SwitchControlAndLocking == 'PL' or SwitchControlAndLocking == 'HL' %}NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL-KEYLOCKED-LEFT-Schematic
					{% elsif SwitchControlAndLocking == 'RR' or SwitchControlAndLocking == 'PR' or SwitchControlAndLocking == 'HR' %}NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL-KEYLOCKED-RIGHT-Schematic
					{% elsif SwitchControlAndLocking == 'RB' or SwitchControlAndLocking == 'PB' or SwitchControlAndLocking == 'HB' %}NO-BN-2D-JBTSA_SPV-FORBINDELSE-SPORVEKSEL-KEYLOCKED-BOTH-Schematic
					{% endif %}
				{% endif %}
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

		<DockPointDefinitions>
			<!-- Dock points common for all variants -->
			<SnapPoints MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Lokalstiller. NB Pen display-posisjon håndteres i lokalstillerobjektet (etter docking). -->
				<SnapPoint X="0" Y="2.5" TargetSpace="lokalstiller" />
				<SnapPoint X="0" Y="-2.5" TargetSpace="lokalstiller" />
				<!-- Tunge -->
				<SnapPoint X="0" Y="0" TargetSpace="sporvekseltunge" />
			</SnapPoints>
			<SnapPoints Variant="1:7 R190 FX 54E3 (KO-800157)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- TODO - mangler sporvekseldrivmaskiner og isolasjoner -->
				<!-- Sporsperre -->
				<SnapPoint X="18.6474" Y="1.672" TargetSpace="sporsperre" />
				<SnapPoint X="18.7666" Y="-0.751" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:9 R190 FX 54E3 (KO-701334)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}"
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<SnapPoint X="0.84186177" Y="1.75188526" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="0.85" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 2 -->
				<SnapPoint X="3.89367110" Y="1.75002238" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="3.93" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Fabrikkslevert isolert skjøt -->
				<SnapPoint X="16.8592" Y="0.7495" TargetSpace="skinneskjøt" />
				<SnapPoint X="16.8907" Y="0" TargetSpace="skinneskjøt" />
				<!-- Sporsperre -->
				<SnapPoint X="18.0416" Y="1.613" TargetSpace="sporsperre" />
				<SnapPoint X="18.1541" Y="-0.751" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:9 R300 FX 54E3 (KO-701287)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- TODO - mangler sporvekseldrivmaskiner og isolasjoner -->
				<!-- Sporsperre -->
				<SnapPoint X="22.3197" Y="1.5846" TargetSpace="sporsperre" />
				<SnapPoint X="22.4967" Y="-0.751" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:12 R500 FX 54E3 (KO-701306)"
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- TODO - mangler sporvekseldrivmaskiner og isolasjoner -->
				<!-- Sporsperre -->
				<SnapPoint X="30.1318" Y="1.6611" TargetSpace="sporsperre" />
				<SnapPoint X="30.2045" Y="-0.751" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:14 R760 FX 54E3 (KO-701319)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- TODO - mangler sporvekseldrivmaskiner og isolasjoner -->
				<!-- Sporsperre -->
				<SnapPoint X="37.3852" Y="1.672" TargetSpace="sporsperre" />
				<SnapPoint X="37.4448" Y="-0.751" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:9 R300 FX 60E1 (KO-701409)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<SnapPoint X="1.00109109" Y="1.75225524" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="1.008" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 2 -->
				<SnapPoint X="5.20487399" Y="1.79794469" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="5.237" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Fabrikkslevert isolert skjøt-->
				<SnapPoint X="15.7829" Y="0.4187" TargetSpace="skinneskjøt" />
				<SnapPoint X="15.79" Y="0" TargetSpace="skinneskjøt" />
				<!-- Sporsperre -->
				<SnapPoint X="21.1317" Y="1.5006" TargetSpace="sporsperre" />
				<SnapPoint X="21.2113" Y="-0.7535" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:11.66 R500 FX 60E1 (KO-800068)" 
				MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}"
				MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<!-- <SnapPoint X="0.98448908" Y="1.75094744" TargetSpace="sporvekseldrivmaskin" /> -->
				<!-- <SnapPoint X="0.988" Y="-1.75" TargetSpace="sporvekseldrivmaskin" /> -->
				<!-- Drivmaskin 2 -->
				<!-- <SnapPoint X="4.03771321" Y="1.76617386" TargetSpace="sporvekseldrivmaskin" /> -->
				<!-- <SnapPoint X="4.052" Y="-1.75" TargetSpace="sporvekseldrivmaskin" /> -->
				<!-- Drivmaskin 3 -->
				<!-- <SnapPoint X="7.66716867" Y="1.80887624" TargetSpace="sporvekseldrivmaskin" /> -->
				<!-- <SnapPoint X="7.695" Y="-1.75" TargetSpace="sporvekseldrivmaskin" /> -->
				<!-- Fabrikkslevert isolert skjøt-->
				<!-- <SnapPoint X="19.4052" Y="0.3768" TargetSpace="skinneskjøt" /> -->
				<!-- <SnapPoint X="19.41" Y="0" TargetSpace="skinneskjøt" /> -->
				<!-- Sporsperre -->
				<!-- <SnapPoint X="27.3045" Y="1.4990" TargetSpace="sporsperre" /> -->
				<!-- <SnapPoint X="27.3639" Y="-0.7552" TargetSpace="sporsperre" /> -->
			</SnapPoints>
			<SnapPoints Variant="1:12 R500 FX 60E1 (KO-800068)"
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}"
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<SnapPoint X="0.98448908" Y="1.75094744" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="0.988" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 2 -->
				<SnapPoint X="4.03771321" Y="1.76617386" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="4.052" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 3 -->
				<SnapPoint X="7.66716867" Y="1.80887624" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="7.695" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Fabrikkslevert isolert skjøt-->
				<SnapPoint X="19.4052" Y="0.3768" TargetSpace="skinneskjøt" />
				<SnapPoint X="19.41" Y="0" TargetSpace="skinneskjøt" />
				<!-- Sporsperre -->
				<SnapPoint X="27.3045" Y="1.4990" TargetSpace="sporsperre" />
				<SnapPoint X="27.3639" Y="-0.7552" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:14 R760 FX 60E1 (KO-701372)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Sporsperre -->
				<SnapPoint X="37.3153" Y="1.671" TargetSpace="sporsperre" />
				<SnapPoint X="37.3749" Y="-0.7535" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:15 R760 FX 60E1 (KO-701382)" >
				<!-- Sporsperre -->
				<SnapPoint X="37.3151" Y="1.6786" TargetSpace="sporsperre" />
				<SnapPoint X="37.3751" Y="-0.761" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:9 R300 BX 60E1 (KO-800099)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<SnapPoint X="1.00031" Y="2.51464" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="0.99801" Y="-2.49891" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 2 -->
				<SnapPoint X="5.21105" Y="2.5611" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="5.25295" Y="-2.49892" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 3 -->
				<SnapPoint X="28.02852" Y="3.83954" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="28.32818" Y="-2.50416" TargetSpace="sporvekseldrivmaskin" />
				<!-- Sporsperre -->
				<SnapPoint X="23.4996" Y="1.6885" TargetSpace="sporsperre" />
				<SnapPoint X="23.5911" Y="-0.7542" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:8.21 R300 BX 60E1 (KO-065306)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<SnapPoint X="1.00031" Y="2.51464" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="0.99801" Y="-2.49891" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 2 -->
				<SnapPoint X="5.21105" Y="2.5611" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="5.25295" Y="-2.49892" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 3 -->
				<SnapPoint X="28.02852" Y="3.83954" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="28.32818" Y="-2.50416" TargetSpace="sporvekseldrivmaskin" />
				<!-- Sporsperre -->
				<SnapPoint X="23.4996" Y="1.6885" TargetSpace="sporsperre" />
				<SnapPoint X="23.5911" Y="-0.7542" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:12 R500 BX 60E1 (KO-800090)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
			</SnapPoints>
			<SnapPoints Variant="1:14 R760 BX 60E1 (KO-800108)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" 
						MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<SnapPoint X="0.99406" Y="2.51234" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="1.00151" Y="-2.4974" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 2 -->
				<SnapPoint X="3.9443" Y="2.52334" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="3.9612" Y="-2.4974" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 3 -->
				<SnapPoint X="8.16892" Y="2.555" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="8.19147" Y="-2.4974" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 4 -->
				<SnapPoint X="45.06364" Y="3.8519" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="45.26258" Y="-2.4974" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 5 -->
				<SnapPoint X="47.32825" Y="3.99248" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="47.56431" Y="-2.4974" TargetSpace="sporvekseldrivmaskin" />
				<!-- Sporsperre -->
				<SnapPoint X="37.264" Y="1.68161" TargetSpace="sporsperre" />
				<SnapPoint X="37.32603" Y="-0.75487" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:15 R760 BX 60E1 (KO-800164)" 
						MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}"
							MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
			</SnapPoints>
			<SnapPoints Variant="1:18.4 R1200 BX 60E1 (KO-800081)" MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Drivmaskin 1 -->
				<SnapPoint X="1.03614926" Y="1.75065431" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="1.038" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 2 -->
				<SnapPoint X="5.73931411" Y="1.76471472" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="5.748" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 3 -->
				<SnapPoint X="11.15110340" Y="1.80338543" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="11.168" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 4 -->
				<SnapPoint X="56.74078823" Y="3.08518750" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="56.8541" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Drivmaskin 5 -->
				<SnapPoint X="59.21244152" Y="3.20359522" TargetSpace="sporvekseldrivmaskin" />
				<SnapPoint X="59.3335" Y="-1.75" TargetSpace="sporvekseldrivmaskin" />
				<!-- Fabrikkslevert isolert skjøt -->
				<SnapPoint X="37.3372" Y="0.8103" TargetSpace="skinneskjøt" />
				<SnapPoint X="37.3152" Y="-0.3382" TargetSpace="skinneskjøt" />

				<!-- Sporsperre -->
				<SnapPoint X="50.6568" Y="1.8293" TargetSpace="sporsperre" />
				<SnapPoint X="50.7118" Y="-0.7616" TargetSpace="sporsperre" />
			</SnapPoints>
			<SnapPoints Variant="1:26.1 R2500 BX 60E1 (KO-701399)" MirrorAboutAlignmentTangent="{% if SwitchGeometry == 'left' and dir == 'down' %}true{% elsif SwitchGeometry == 'right' and dir == 'up' %}true{% else %}false{% endif %}" MirrorAboutAlignmentNormal="{% if dir == 'down' %}true{% else %}false{% endif %}" >
				<!-- Sporsperre -->
				<SnapPoint X="67.5777" Y="1.6748" TargetSpace="sporsperre" />
				<SnapPoint X="67.6106" Y="-0.761" TargetSpace="sporsperre" />
			</SnapPoints>
		</DockPointDefinitions>
	</ObjectType>



<!--=====================================u===================================================================
	OVERBYGNING
	SPORVEKSELTUNGER
	JBTKO_TNG Sporvekseltunge
=========================================================================================================-->
	<ObjectType DataType="tOrientedElement" Class="RailwayPlacedObject" Name="JBTKO_TNG Sporvekseltunge"
				Layer="JBTKO_TNG" Color="ByLayer"
				Group="Overbygning/Tunger"
				AttMirrorY="{% if RightSided %}true{% else %}false{% endif %}"
				>

		<RelationSpace>sporvekseltunge</RelationSpace>
		
		<xpp:expand select="NOBN_com_SYMBOLFRAME" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___ANGULAROFFSET_VAR" />
		<xpp:expand select="NOBN_com_STD_CUSTOMATTRIBUTES___MILEAGE_INCREASES_TOWARDS_LEFT" />
		<xpp:expand select="NOBN_com_STD_TEXTATTRIBUTES___HORIZONTAL_AND_VERY_CLOSE___TRK" />
		<xpp:expand select="NOBN_com_DISCIPLINE___TRK" />
		<xpp:expand select="RC_com_SET_OCP_STATION_REFERENCE" />
		<xpp:expand select="NOBN_com_CHK_NUMBER_OF_OCP_AREAS" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___TRACKBOUND_OBJECT" />
		<xpp:expand select="NOBN_com_STD_LUAEXPRESSIONS___EARTHED_TO_NONE" />
		<xpp:expand select="NOBN_com_PSET_BANE_NOR" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA" />
		<xpp:expand select="NOBN_com_PSET_ISY_STK" />
		<xpp:expand select="NOBN_com_PSET_TITTELFELT" />
		<xpp:expand select="NOBN_com_PSET_FDV_BANEDATA_KO_TNG" />
				
		<LuaExpression Name="DistanceToAlignment" >
			<Formula>RightSided and 4e-4 or -4e-4</Formula>
		</LuaExpression> 
		
		<Variants DefaultValue="1:9 R190" >
			<Variant Name="1:9 R190" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-09-R190" />
			</Variant>
			<Variant Name="1:9 R300" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-09-R300" />
			</Variant>
			<Variant Name="1:11.66 R500" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-11.66-R500" />
			</Variant>
			<Variant Name="1:12 R500" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-12-R500" />
			</Variant>
			<Variant Name="1:14 R760" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-14-R760" />
			</Variant>
			<Variant Name="1:15 R760" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-15-R760" />
			</Variant>
			<Variant Name="1:18.4 R1200" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-18.4-R1200" />
			</Variant>
			<Variant Name="1:26.1 R2500" >
				<SetValue Key="Model3DName" Value="NO-BN-3D-KO_TNG-TUNGE-26.1-R2500" />
			</Variant>
		</Variants>

		<LuaExpression Name="Alignment" ><Formula>_JBTKO_TNG_alignment()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_TNG_alignment()" ReturnType="ObjRef"
				Description="Obtains the alignment [ObjRef] from its switch, related with 'Er tunge for sporveksel'." >
			<Constructor>ObjRef _JBTKO_TNG_alignment()</Constructor>
			<Formula>
				function _JBTKO_TNG_alignment()
					s = "Er tunge for sporveksel"
					r,n = getCollectionOfRelatedObjects(s)
					if n == 0 then
						return getPropertyValue("Alignment"), _info("UNFINISHED - Relate with '"..s.."' to a switch (turnout).")
					else
						return r[0].Alignment, _info("Alignment inherited with relation '"..s.."' from switch '"..RC__identify(r[0]).."' ")
					end
				end
			</Formula>
		</LuaFunction>
		
		<LuaExpression Name="Mileage" ><Formula>_JBTKO_TNG_mileage()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_TNG_mileage()" ReturnType="Double"
				Description="Obtains the mileage from its switch, related with 'Er tunge for sporveksel'." >
			<Constructor>Double _JBTKO_TNG_mileage()</Constructor>
			<Formula>
				function _JBTKO_TNG_mileage()
					s = "Er tunge for sporveksel"
					r,n = getCollectionOfRelatedObjects(s)
					if n == 0 then
						return getPropertyValue("mileage"), _info("UNFINISHED - Relate with '"..s.."' to a switch (turnout).")
					else
						return r[0].Mileage, _info("Mileage inherited with relation '"..s.."' from switch '"..RC__identify(r[0]).."' ")
					end
				end
			</Formula>
		</LuaFunction>
		
		<LuaExpression Name="code" ><Formula>_JBTKO_TNG_code()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_TNG_code()" ReturnType="String"
				Description="Obtains the code from its switch, related with 'Er tunge for sporveksel'." >
			<Constructor>Double _JBTKO_TNG_code()</Constructor>
			<Formula>
				function _JBTKO_TNG_code()
					s = "Er tunge for sporveksel"
					r,n = getCollectionOfRelatedObjects(s)
					if n == 0 then
						return _info("UNFINISHED - Relate with '"..s.."' to a switch (turnout).")
					else
						return r[0].code, _info("Code inherited with relation '"..s.."' from switch "..RC__identify(r[0])..".")
					end
				end
			</Formula>
		</LuaFunction>
		
		<LuaExpression Name="name" ><Formula>"Tng."..code</Formula></LuaExpression>
		
		<LuaExpression Name="dir" ><Formula>_JBTKO_TNG_dir()</Formula></LuaExpression>
		<LuaFunction Name="_JBTKO_TNG_dir()" ReturnType="Enum"
				Description="Obtains the direction (dir) [up | down] enum from its switch, related with 'Er tunge for sporveksel'." >
			<Constructor>Double _JBTKO_TNG_dir()</Constructor>
			<Formula>
				function _JBTKO_TNG_dir()
					s = "Er tunge for sporveksel"
					r,n = getCollectionOfRelatedObjects(s)
					if n == 0 then
						return _info("UNFINISHED - Relate with '"..s.."' to a switch (turnout).")
					else
						return r[0].dir, _info("EnableDirectionSetting (dir) inherited with relation '"..s.."' from switch '"..RC__identify(r[0]).."' ")
					end
				end
			</Formula>
		</LuaFunction>

		<!--<TextAttribute Annotative="true" CadAttributeTag="Normalstilling" Height="1" Justify="MiddleCenter" Constant="true" -->
		<!-- InsertTag="   UFERDIG - PÅ IDESTADIET FORTSATT- TUNGER ARVER STILLING FRA SPV sin normalPosition -->
			<!-- {% if relateditem("sporveksel").normalPosition == 'straight' %}NORMAL_RETTSPOR -->
			<!-- {% elsif ConnectionCourse == 'left' %} --> 
				 <!-- {% if normalPosition == 'left' %}NORMAL_AVVIK --> 
				 <!-- {% elsif normalPosition == 'right' %}NORMAL_RETTSPOR --> 
				 <!-- {% endif %} --> 
			<!-- {% elsif ConnectionCourse == 'right' %} --> 
				 <!-- {% if normalPosition == 'right' %}NORMAL_AVVIK --> 
				 <!-- {% elsif normalPosition == 'left' %}NORMAL_RETTSPOR --> 
				 <!-- {% endif %} --> 
			 <!-- {% endif %}" --> 
		 <!-- DotLiquidExpression=" -->
			<!-- {% if normalPosition == 'left' %}V -->
			<!-- {% elsif normalPosition == 'right' %}H -->
			<!-- {% elsif normalPosition == 'straight' %} -->
				<!-- {% if ConnectionCourse == 'M' %}H{% else %}V{% endif %} -->
			<!-- {% endif %}" -->
		<!-- />-->

		<CustomAttribute DataType="Enumeration" Name="NormalPosition" DisplayName="Normalstilling" DefaultValue="Unknown"
			Description="Normalstilling viser tungestilling i samsvar med relé-normalstilling i sikringsanleggets relétegninger. 'Venstre' betyr at toget vil kjøre til venstre, 'Høyre' betyr kjøring til høyre." >
			<Values>
				<Value DisplayName="Ukjent" >Unknown</Value>
				<Value DisplayName="Venstre" >Left</Value>
				<Value DisplayName="Midtstilling" >Straight</Value>	<!--Midtstilling er kun meningsfylt for 3-vei sporveksler.-->
				<Value DisplayName="Høyre" >Right</Value>
			</Values>
		</CustomAttribute>

		<InsertPointObject DisplayName="Sporvekseltunge 1:9 R190" VariantName="1:9 R190" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-09-R190-V-Metric" 
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>

		<InsertPointObject DisplayName="Sporvekseltunge 1:9 R300" VariantName="1:9 R300" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-09-R300-V-Metric"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>

		<InsertPointObject DisplayName="Sporvekseltunge 1:11.66 R500" VariantName="1:11.66 R500" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-11.66-R500-V-Metric"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>

		<InsertPointObject DisplayName="Sporvekseltunge 1:12 R500" VariantName="1:12 R500" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-12-R500-V-Metric"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>

		<InsertPointObject DisplayName="Sporvekseltunge 1:14 R760" VariantName="1:14 R760" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-14-R760-V-Metric"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>
		
		<InsertPointObject DisplayName="Sporvekseltunge 1:15 R760" VariantName="1:15 R760" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-15-R760-V-Metric"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>

		<InsertPointObject DisplayName="Sporvekseltunge 1:18.4 R1200" VariantName="1:18.4 R1200" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-18.4-R1200-V-Metric"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>

		<InsertPointObject DisplayName="Sporvekseltunge 1:26.1 R2500" VariantName="1:26.1 R2500" DisplayBlockName="NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE-26.1-R2500-V-Metric"
                DefaultSnapMode="Alignment" SnapToAlignment="true" SnapDistance="4e-4" >
			<OwnAlignmentTargetSpace>spor</OwnAlignmentTargetSpace>
			<JigSymbolAppearance EnableDirectionSetting="true" MirrorAboutJigYAxisIfLeftSideOfAlignment="true" />
			<SetValue Key="KmStigerMotVenstre" Value="{{alignmentRotation | minus:ucsRotation | cosisnegative}}" />
			<SetValue Key="NormalPosition" Value="{% if RightSided %}{% if dir == 'up' %}Left{% else %}Right{% endif %}{% else %}{% if dir == 'up' %}Right{% else %}Left{% endif %}{% endif %}" />
		</InsertPointObject>

		<SymbolDefinition DefaultBlockName="" AllowSymbolMove="false" >
			<Rotation Add180DegreesIfDirIsDown="true" />
			<BlockNameFormat JoinBy="-" >
				NO-BN-2D-JBTKO_TNG-SPORVEKSELTUNGE
				{% if Variant == '1:9 R190' %}09-R190
				{% elsif Variant == '1:9 R300' %}09-R300
				{% elsif Variant == '1:11.66 R500' %}11.66-R500
				{% elsif Variant == '1:12 R500' %}12-R500
				{% elsif Variant == '1:14 R760' %}14-R760
                {% elsif Variant == '1:15 R760' %}15-R760
				{% elsif Variant == '1:18.4 R1200' %}18.4-R1200
				{% elsif Variant == '1:26.1 R2500' %}26.1-R2500
				{% endif %}
				{% if NormalPosition == 'Right' %}H
				{% elsif NormalPosition == 'Left' %}V
				{% else %}H
				{% endif %}
				Metric
			</BlockNameFormat>
		</SymbolDefinition>

		<SymbolDefinition DefaultBlockName="NO-BN-2D-JBTRC_INNSETTINGSPUNKT-Schematic" />

	</ObjectType>



<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>

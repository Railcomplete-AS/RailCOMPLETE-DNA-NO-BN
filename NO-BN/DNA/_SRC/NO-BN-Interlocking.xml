<!--========================================================================================================

    NO-BN-Interlocking.xml
	
	Include in DNA file using XPPq XML preprocessor directive <xpp:expand href="fileName.xml"/>.

	(c) Railcomplete AS, Norway, 2015-2023. All rights reserved.
	
=========================================================================================================-->
<xpp:bloc>



<!--=======================================================================================================
	SIGNALLING
	INTERLOCKING SYNTHESIS
========================================================================================================-->
	<DefaultInterlockingExportOptions>
		<TrainRoutesStartPointFilter>
			if (RcType == rctype_Signal and Hovedsignal == 'Hs2' or Hovedsignal == 'Hs3') then
				return NOBN_sig_getSignalShortName()
			elseif RcType == rctype_EtcsEoA then
				return NOBN_sig_getSignalShortName()
			end
		</TrainRoutesStartPointFilter>
		<TrainRoutesEndPointFilter>
			if ((RcType == rctype_Signal and (Hovedsignal == 'Hs1'or Hovedsignal == 'Hs2' or Hovedsignal == 'Hs3'))
				or (RcType == rctype_FictitiousSignal and Variant == "Fiktivt sluttpunkt for togvei")
				or (RcType == "JBTSA_SIG Togvei slutt"))
			then
				return NOBN_sig_getSignalShortName()
			elseif RcType == rctype_EtcsEoA then
				return NOBN_sig_getSignalShortName()
			end
		</TrainRoutesEndPointFilter>
		<ShuntingRoutesStartPointFilter>
			if (RcType == rctype_Signal and Dvergsignal == "Ja") then
				return NOBN_sig_getSignalNumber()
			end
		</ShuntingRoutesStartPointFilter>
		<ShuntingRoutesEndPointFilter>
			if ((RcType == rctype_Signal or RcType == rctype_EtcsEoA) and Variant:lower():match("dvergsignal") then 
				return NOBN_sig_getSignalNumber()
			elseif ((RcType == rctype_FictitiousSignal and Variant == "Fiktivt sluttpunkt for togvei") or (RcType == "JBTSA_SIG Togvei slutt")) then
				return code
			end
		</ShuntingRoutesEndPointFilter>
		<ViaPointFilter>
			if (RcType == rctype_FictitiousSignal and Variant == "Viapunkt for betjeningsanlegg") then
				return "(v"..code..")"
			end
		</ViaPointFilter>
		<ExtendedTrainRoutesExcludedStartPointFilter>Function == "blocking"</ExtendedTrainRoutesExcludedStartPointFilter>
		<ExtendedRoutePartFormatScript>
			base = StartName .. "-" .. EndName
			if ViaPoints.Count > 0 then
				via = ViaPoints[0].Value
				for i=1, ViaPoints.Count-1 do
					via = via .. "-" .. ViaPoints[i].Value
				end
				return base .. " via " .. via
			else
				return base
			end
		</ExtendedRoutePartFormatScript>
		<SwitchNameScript>
			dir = (position == "left") and "V" or "H"
			return switchObj.code .. dir
		</SwitchNameScript>
	</DefaultInterlockingExportOptions>
	
	
	
<!--========================================================================================================
    End of file 
=========================================================================================================-->
</xpp:bloc>
